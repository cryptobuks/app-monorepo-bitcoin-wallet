(this.webpackJsonp=this.webpackJsonp||[]).push([[98],{3175:function(t,e,n){"use strict";n.d(e,"c",(function(){return v})),n.d(e,"b",(function(){return g})),n.d(e,"d",(function(){return _})),n.d(e,"a",(function(){return w}));var r=n(2),c=n.n(r),i=n(3),a=n.n(i),o=n(10),s=n.n(o),u=n(1),l=n(1156),f=n(184),d=n(163),b=n(76),p=n(11),j=n(43),O=n(39);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m=function(t){return[d.a,d.c,d.d,d.e].includes(t)},v=function(){var t=j.a.engine,e=Object(u.useState)([]),n=s()(e,2),r=n[0],c=n[1],i=Object(O.k)().wallets,o=Object(u.useCallback)(a()((function*(){var e=yield Promise.all(i.map(function(){var e=a()((function*(e){var n,r=yield t.getAccounts(e.accounts);return h(h({},e),{},{accounts:null!=(n=null==r?void 0:r.filter((function(t){if(!t)return!1;var e=t||{},n=e.address,r=e.coinType;return!m(n)&&!!Object(f.i)(r,p.I)})))?n:[]})}));return function(t){return e.apply(this,arguments)}}()));return c(e),e})),[t,i]);return Object(u.useEffect)((function(){o()}),[o]),{wallets:r,getWalletsAndAccounts:o}},g=function(){var t=Object(u.useState)(!1),e=s()(t,2),n=e[0],r=e[1],c=j.a.serviceNotification,i=v(),o=i.wallets,l=i.getWalletsAndAccounts,f=Object(u.useState)([]),d=s()(f,2),b=d[0],p=d[1],O=Object(u.useCallback)(a()((function*(){var t=yield c.queryAccountDynamic();p(t)})),[c]),y=Object(u.useCallback)(a()((function*(){r(!0);try{yield O(),yield l()}finally{r(!1)}})),[O,l]);return Object(u.useEffect)((function(){y()}),[y]),{loading:n,wallets:o,enabledAccounts:b,refresh:y}},_=function(){var t=j.a.serviceNotification,e=Object(u.useState)(!1),n=s()(e,2),r=n[0],c=n[1],i=Object(u.useState)([]),o=s()(i,2),l=o[0],f=o[1],d=Object(u.useCallback)(a()((function*(){c(!0);try{var e=yield t.queryPriceAlertList();f(e||[])}catch(n){}c(!1)})),[t]);return Object(u.useEffect)((function(){d()}),[d]),{alerts:l,loading:r,fetchPriceAlerts:d}},P=function(){var t=a()((function*(t,e){if(!t)return!1;var n=t||{},r=n.address,c=n.coinType;return!m(r)&&(!!Object(f.i)(c,p.I)&&!(yield Object(b.j)({asyncFunc:function(){var t=a()((function*(){return j.a.validator.isContractAddress(e,r)}));return function(){return t.apply(this,arguments)}}(),timeout:6e3,timeoutResult:!1})))}));return function(e,n){return t.apply(this,arguments)}}(),w=function(t,e){var n=Object(l.a)(a()((function*(){return P(t,e)})),[t]).result;return null!=n&&n}},3231:function(t,e,n){"use strict";n.r(e);var r=n(100),c=n(3751),i=n(3434);n.d(e,"PushNotificationRoutes",(function(){return i.a}));var a=n(456),o=n(0),s=Object(a.a)(),u=[{name:i.a.GuideToPushFirstTime,component:c.b}];e.default=function(){var t=Object(r.a)();return Object(o.jsx)(s.Navigator,{screenOptions:{headerShown:!1,animationEnabled:!!t},children:u.map((function(t){return Object(o.jsx)(s.Screen,{name:t.name,component:t.component},t.name)}))})}},3434:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t.GuideToPushFirstTime="GuideToPushFirstTime"}(r||(r={}))},3751:function(t,e,n){"use strict";n.d(e,"a",(function(){return D}));var r=n(252),c=n(427),i=n(32),a=n(72),o=n(115),s=n(41),u=n(2),l=n.n(u),f=n(3),d=n.n(f),b=n(1),p=n(57),j=n(429),O=n(253),y=n(20),h=n(14),m=n(43),v=n(172),g=n(31),_=n(80),P=n(141),w=n(47),x=n(3175),A=n(3434),E=n(0);function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function D(){var t=Object(v.a)(),e=m.a.serviceBootstrap,n=Object(b.useCallback)((function(){var n=!0;return function(){var r=d()((function*(){yield Object(w.g)(1e3);var r=yield e.checkShouldShowNotificationGuide();n&&r&&t.navigate(g.h.Modal,{screen:g.e.PushNotification,params:{screen:A.a.GuideToPushFirstTime}})}));return function(){return r.apply(this,arguments)}}()(),function(){n=!1}}),[t,e]);return Object(p.s)(n),null}e.b=function(){var t=Object(j.a)(),e=m.a.dispatch,n=m.a.serviceNotification,u=Object(x.c)().wallets;Object(b.useEffect)((function(){e(Object(P.f)(!0))}),[e]);var l=Object(b.useCallback)(d()((function*(){var t=u.map((function(t){return t.accounts.map((function(e){return k(k({},e),{},{passphrase:Object(O.g)(t)})}))})).flat().slice(0,50),e=yield n.filterContractAddresses(t.map((function(t){return t.address})));yield n.addAccountDynamicBatch({data:t.filter((function(t){return e.some((function(e){return e===t.address}))})).map((function(t){return{passphrase:t.passphrase,accountId:t.id,address:t.address,name:t.name}}))})})),[u,n]),f=Object(b.useCallback)(function(){var t=d()((function*(t){var r=t.close;null==r||r(),e(Object(_.E)({pushEnable:!0,priceAlertEnable:!0,btcAndEthPriceAlertEnable:!0,favoriteTokensPriceAlertEnable:!0,accountActivityPushEnable:!0}));try{yield n.syncPushNotificationConfig(),yield l()}catch(c){y.a.notification.error("close notification addAccountDynamics error",c)}}));return function(e){return t.apply(this,arguments)}}(),[e,l,n]),p=Object(b.useMemo)((function(){return[{icon:"\ud83d\udea8",title:t.formatMessage({id:"form__price_volatility"}),desc:t.formatMessage({id:"form__price_volatility_desc"})},{icon:"\ud83d\udcc8",title:t.formatMessage({id:"form__price_alert"}),desc:t.formatMessage({id:"title__no_alert_desc"},{0:"tokens"})},{icon:"\ud83d\udc64",title:t.formatMessage({id:"form__account_activity"}),desc:t.formatMessage({id:"account_activity_desc"})}]}),[t]);return Object(E.jsx)(r.b,{height:"560px",hideSecondaryAction:!0,onPrimaryActionPress:f,primaryActionProps:{type:"primary"},primaryActionTranslationId:"action__allow",children:Object(E.jsxs)(c.a,{position:"relative",height:"full",children:[Object(E.jsx)(o.a,{position:"absolute",bottom:"-12px",width:"full",children:Object(E.jsx)(s.h.Body2,{children:t.formatMessage({id:"content__you_can_change_this_option_later_in_the_settings"})})}),Object(E.jsxs)(o.a,{children:[Object(E.jsx)(a.a,{fontSize:56,children:"\ud83d\udd14"}),Object(E.jsx)(s.h.DisplayLarge,{children:t.formatMessage({id:"title__notifications"})})]}),p.map((function(t,e){return Object(E.jsxs)(i.a,{px:"4",flexDirection:"row",mt:0===e?"64px":4,children:[Object(E.jsx)(s.h.DisplayLarge,{mr:"4",children:t.icon}),Object(E.jsxs)(i.a,{flex:1,children:[Object(E.jsx)(s.h.Body1Strong,{mb:"1",children:t.title}),Object(E.jsx)(s.h.Body2,{flex:h.a.isNative?void 0:1,numberOfLines:2,color:"text-subdued",children:t.desc})]})]},t.icon)}))]})})}}}]);