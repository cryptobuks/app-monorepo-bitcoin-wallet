(this.webpackJsonp=this.webpackJsonp||[]).push([[110,845],{3027:function(e,n,t){"use strict";t.r(n),t.d(n,"ModalNavigatorRoutes",(function(){return f}));var r=t(2),o=t.n(r),i=t(100),a=t(1),c=t(292),u=t(463),l=t(145),s=t(760),b=t(456),d=t(0);function m(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}var f,p=Object(u.a)((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(5),t.e(8),t.e(3),t.e(6),t.e(4),t.e(7),t.e(9)]).then(t.bind(null,3162))})),j=Object(u.a)((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(5),t.e(8),t.e(3),t.e(6),t.e(4),t.e(7),t.e(9)]).then(t.bind(null,3125))})),h=Object(u.a)((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(5),t.e(8),t.e(3),t.e(6),t.e(4),t.e(7),t.e(9)]).then(t.bind(null,3136))})),O=Object(u.a)((function(){return t.e(107).then(t.bind(null,3229))})),g=Object(u.a)((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(5),t.e(8),t.e(3),t.e(6),t.e(4),t.e(7),t.e(9)]).then(t.bind(null,3194))})),v=Object(u.a)((function(){return t.e(93).then(t.bind(null,3177))})),y=Object(u.a)((function(){return Promise.all([t.e(43),t.e(55)]).then(t.bind(null,3244))})),x=Object(u.a)((function(){return t.e(104).then(t.bind(null,3197))})),k=Object(u.a)((function(){return t.e(65).then(t.bind(null,3115))})),P=Object(u.a)((function(){return Promise.all([t.e(2),t.e(4),t.e(96)]).then(t.bind(null,3216))})),w=Object(u.a)((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(5),t.e(8),t.e(3),t.e(6),t.e(4),t.e(7),t.e(9)]).then(t.bind(null,3196))})),S=Object(u.a)((function(){return t.e(6).then(t.bind(null,3199))})),I=Object(u.a)((function(){return Promise.resolve().then(t.bind(null,1158))})),M=Object(u.a)((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(5),t.e(8),t.e(3),t.e(6),t.e(4),t.e(7),t.e(75)]).then(t.bind(null,3241))})),A=Object(u.a)((function(){return t.e(843).then(t.bind(null,3137))})),T=Object(u.a)((function(){return t.e(105).then(t.bind(null,3245))})),D=Object(u.a)((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(5),t.e(8),t.e(3),t.e(6),t.e(4),t.e(7),t.e(9)]).then(t.bind(null,3193))})),H=Object(u.a)((function(){return Promise.all([t.e(1),t.e(37)]).then(t.bind(null,3178))})),R=Object(u.a)((function(){return Promise.all([t.e(1),t.e(86)]).then(t.bind(null,3127))})),C=Object(u.a)((function(){return Promise.all([t.e(3),t.e(94)]).then(t.bind(null,3195))})),_=Object(u.a)((function(){return Promise.all([t.e(0),t.e(39),t.e(47)]).then(t.bind(null,3240))})),L=Object(u.a)((function(){return t.e(844).then(t.bind(null,3198))})),F=Object(u.a)((function(){return t.e(98).then(t.bind(null,3231))})),N=Object(u.a)((function(){return t.e(41).then(t.bind(null,3128))})),E=Object(u.a)((function(){return t.e(101).then(t.bind(null,3247))})),z=Object(u.a)((function(){return t.e(103).then(t.bind(null,3250))})),W=Object(u.a)((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(5),t.e(8),t.e(3),t.e(6),t.e(4),t.e(7),t.e(71)]).then(t.bind(null,3238))})),q=Object(u.a)((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(5),t.e(8),t.e(3),t.e(6),t.e(4),t.e(7),t.e(9)]).then(t.bind(null,3192))})),B=Object(u.a)((function(){return t.e(76).then(t.bind(null,3246))})),V=Object(u.a)((function(){return Promise.resolve().then(t.bind(null,955))})),J=Object(u.a)((function(){return Promise.all([t.e(5),t.e(15),t.e(48)]).then(t.bind(null,3237))})),U=Object(u.a)((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(5),t.e(8),t.e(3),t.e(6),t.e(4),t.e(7),t.e(9)]).then(t.bind(null,3129))})),G=Object(u.a)((function(){return Promise.resolve().then(t.bind(null,1159))})),Q=Object(u.a)((function(){return t.e(102).then(t.bind(null,3234))})),Y=Object(u.a)((function(){return t.e(88).then(t.bind(null,3243))})),K=Object(u.a)((function(){return Promise.all([t.e(0),t.e(64)]).then(t.bind(null,3251))})),X=Object(u.a)((function(){return t.e(42).then(t.bind(null,3242))})),Z=Object(u.a)((function(){return t.e(81).then(t.bind(null,3248))}));!function(e){e.ReceiveTokenNavigator="ReceiveTokenNavigator",e.SendNavigator="SendNavigator"}(f||(f={}));var $=[{name:l.b.CreateAccount,component:h},{name:l.b.RecoverAccount,component:O},{name:l.b.Receive,component:N},{name:l.b.Send,component:q},{name:l.b.ScanQrcode,component:W},{name:l.b.BackupWallet,component:p},{name:l.b.TransactionDetail,component:U},{name:l.b.ManageToken,component:C},{name:l.b.SubmitRequest,component:V},{name:l.b.HistoryRequest,component:M},{name:l.b.Password,component:L},{name:l.b.OnekeyLiteReset,component:S},{name:l.b.OnekeyLiteChangePinInputPin,component:w},{name:l.b.DappConnectionModal,component:v},{name:l.b.Collectibles,component:j},{name:l.b.CreateWallet,component:g},{name:l.b.ManagerWallet,component:R},{name:l.b.ManagerAccount,component:H},{name:l.b.EnableLocalAuthentication,component:x},{name:l.b.ManageNetwork,component:D},{name:l.b.OnekeyHardware,component:P},{name:l.b.HardwareUpdate,component:I},{name:l.b.Discover,component:y},{name:l.b.Swap,component:J},{name:l.b.UpdateFeature,component:G},{name:l.b.FiatPay,component:k},{name:l.b.AddressBook,component:Y},{name:l.b.ImportBackupPassword,component:A},{name:l.b.Staking,component:B},{name:l.b.ManageConnectedSites,component:T},{name:l.b.PushNotification,component:F},{name:l.b.Webview,component:Q},{name:l.b.Revoke,component:E},{name:l.b.NFTMarket,component:_},{name:l.b.Overview,component:K},{name:l.b.CurrencySelect,component:Z},{name:l.b.BulkSender,component:z},{name:l.b.Market,component:X}],ee=Object(b.a)();n.default=Object(a.memo)((function(){var e=Object(i.a)(),n=Object(a.useMemo)((function(){return function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?m(Object(t),!0).forEach((function(n){o()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({headerShown:!1,presentation:"modal"},Object(s.a)({isVerticalLayout:e}))}),[e]);return Object(d.jsx)(c.a,{children:Object(d.jsx)(ee.Navigator,{screenOptions:n,children:$.map((function(e){return Object(d.jsx)(ee.Screen,{name:e.name,component:e.component},e.name)}))})})}))},5686:function(e,n,t){"use strict";t.r(n);var r=t(1),o=t(57),i=t(429),a=t(39),c=t(1153),u=t(115),l=t(289),s=t(755),b=t(199),d=t(130),m=t(3),f=t.n(m),p=t(756),j=t(460),h=t(10),O=t.n(h),g=t(1146),v=t(41),y=t(32),x=t(457),k=t(3141),P=t(123),w=t(43),S=t(3124),I=t(3129),M=t(145),A=t(14),T=t(16),D=t.n(T),H=t(3081),R=function(e){var n=e.account,t=e.network,o=e.tokenId,a=e.historyFilter,c=Object(i.a)(),u=Object(H.a)(),l=Object(r.useState)(),s=O()(l,2),b=s[0],d=s[1],m=!n||!t,p=Object(r.useCallback)(f()((function*(){var e,r,i={accountId:null!=(e=null==n?void 0:n.id)?e:"",networkId:null!=(r=null==t?void 0:t.id)?r:"",tokenId:o,historyFilter:a,pageNumber:0,pageSize:50},c=function(e){var n=e.filter((function(e){return e.txStatus===P.b.Pending&&!!e.nonce})).reduce((function(e,n){var t=n.nonce;if("undefined"===typeof t)return e;var r=e.get(t);return r?e.set(t,[].concat(D()(r),[n])):e.set(t,[n]),e}),new Map),t=[];return n.forEach((function(e){var n=e.sort((function(e,n){return e.blockSignedAt-n.blockSignedAt}));n.pop(),t.push.apply(t,D()(n.map((function(e){return e.txHash}))))})),e.filter((function(e){return!t.includes(e.txHash)}))}(yield w.a.engine.getTxHistories(i.networkId,i.accountId,{contract:i.tokenId,isHidePending:!!i.tokenId})),u=i.historyFilter;return u&&(c=c.filter((function(e){return u(e)}))),c})),[null==n?void 0:n.id,null==t?void 0:t.id,o,a]);return{isLoading:void 0===b,transactionRecords:b||[],refresh:Object(r.useCallback)(f()((function*(){if(!m){var e=yield p(),n=function(e,n,t){return n?n.sort((function(e,n){return n.blockSignedAt-e.blockSignedAt})).reduce((function(n,r){var o=e;r.txStatus!==P.b.Pending&&(o=t(r.blockSignedAt));var i=n.find((function(e){return e.title===o}));return i||(i={title:o,data:[]},n.push(i)),i.data.push(r),n}),[]).sort((function(n){return n.title===e?-1:1})):[]}(c.formatMessage({id:"history__queue"}),e,(function(e){return u.formatMonth(new Date(e),{hideTheYear:!0})}));d(n)}})),[u,m,c,p])}},C=t(0),_=function(){return Object(C.jsx)(x.a,{},"separator")},L=function(){return Object(C.jsx)(y.a,{h:"20px"},"footer")},F=function(e){var n=e.section,t=n.title,r=n.data;return Object(C.jsx)(y.a,{pb:2,flexDirection:"row",children:Object(C.jsxs)(y.a,{flexDirection:"row",alignItems:"center",children:[Object(C.jsx)(v.h.Subheading,{color:"text-subdued",children:t}),null!=r[0]&&r[0].successful===P.b.Pending&&Object(C.jsx)(y.a,{ml:3,children:Object(C.jsx)(g.a,{title:r.length.toString(),type:"default",size:"sm"})})]})},"section-header")},N=function(e){var n=e.accountId,t=e.networkId,a=e.tokenId,m=e.historyFilter,h=e.headerView,g=e.hiddenHeader,x=e.isTab,P=Object(i.a)(),T=Object(o.u)(),D=Object(r.useState)(),H=O()(D,2),N=H[0],E=H[1],z=Object(r.useState)(),W=O()(z,2),q=W[0],B=W[1],V=Object(S.c)(q),J=V.openAddressDetails,U=V.hasAvailable,G=R({account:N,network:q,tokenId:a,historyFilter:m}),Q=G.transactionRecords,Y=G.isLoading,K=G.refresh,X=Object(j.a)().size,Z=["NORMAL","LARGE"].includes(X)?32:16,$=Object(p.a)().themeVariant;Object(r.useEffect)((function(){function e(){return(e=f()((function*(){if(n){var e=yield w.a.engine.getAccounts([n]);e&&e.length>0&&E(e[0])}}))).apply(this,arguments)}function r(){return(r=f()((function*(){if(t){var e=yield w.a.engine.getNetwork(t);e&&B(e)}}))).apply(this,arguments)}!function(){r.apply(this,arguments)}(),function(){e.apply(this,arguments)}()}),[n,t]),Object(r.useEffect)((function(){K()}),[K]);var ee=Object(C.jsxs)(y.a,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",pb:3,children:[Object(C.jsx)(v.h.Heading,{children:P.formatMessage({id:"transaction__history"})}),Object(C.jsxs)(y.a,{flexDirection:"row",children:[Object(C.jsx)(b.a,{onPress:function(){K()},isLoading:Y,p:2,size:"sm",name:"ArrowPathMini",type:"plain",circle:!0}),U&&Object(C.jsx)(b.a,{onPress:function(){J(null==N?void 0:N.address)},ml:3,p:2,size:"sm",name:"ArrowTopRightOnSquareMini",type:"plain",circle:!0})]})]}),ne=g?null:Object(C.jsxs)(C.Fragment,{children:[h,ee]}),te=x?k.Tabs.SectionList:c.a;return Object(C.jsx)(te,{bg:"background-default",contentContainerStyle:{paddingHorizontal:Z,marginTop:24},sections:Q,renderItem:function(e){var n=e.item,t=e.index,r=e.section;return Object(C.jsx)(d.a.Item,{borderTopRadius:0===t?"12px":"0px",borderRadius:t===r.data.length-1?"12px":"0px",borderWidth:1,borderColor:"light"===$?"border-subdued":"transparent",borderTopWidth:0===t?1:0,borderBottomWidth:t===r.data.length-1?1:0,mb:t===r.data.length-1?6:void 0,onPress:function(){T.navigate(M.c.Modal,{screen:M.b.TransactionDetail,params:{screen:I.TransactionDetailModalRoutes.HistoryDetailModal,params:{decodedItem:n}}})},children:Object(C.jsx)(y.a,{})},n.txHash+"-"+t)},renderSectionHeader:F,ListHeaderComponent:ne,ListEmptyComponent:Y?function(){return Object(C.jsx)(u.a,{pb:8,pt:8,children:Object(C.jsx)(l.b,{size:"lg"})})}:function(){return Object(C.jsxs)(y.a,{py:4,flexDirection:"column",alignItems:"center",children:[Object(C.jsx)(s.a,{emoji:"\ud83d\udd50",title:P.formatMessage({id:"transaction__history_empty_title"}),subTitle:P.formatMessage({id:"transaction__history_empty_desc"}),actionTitle:P.formatMessage({id:"action__refresh"}),handleAction:K}),!!A.a.isDev&&Object(C.jsx)(b.a,{onPress:function(){J(null==N?void 0:N.address)},p:2,size:"sm",name:"ArrowTopRightOnSquareMini",type:"plain",circle:!0})]})},ListFooterComponent:L,ItemSeparatorComponent:_,keyExtractor:function(e){return e.txHash},showsVerticalScrollIndicator:!1,stickySectionHeadersEnabled:!1})};N.defaultProps={tokenId:null,historyFilter:void 0,headerView:null,hiddenHeader:!1,isTab:!1};var E=N;n.default=function(){var e=Object(o.u)(),n=Object(o.x)(),t=Object(i.a)(),c=n.params,u=c.tokenId,l=c.historyFilter,s=Object(a.d)(),b=s.accountId,d=s.networkId;return Object(r.useLayoutEffect)((function(){e.setOptions({title:t.formatMessage({id:"transaction__history"})})}),[t,e]),Object(C.jsx)(E,{accountId:b,networkId:d,tokenId:u,historyFilter:l,hiddenHeader:!0})}}}]);