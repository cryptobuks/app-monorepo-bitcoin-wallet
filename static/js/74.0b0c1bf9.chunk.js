(this.webpackJsonp=this.webpackJsonp||[]).push([[74],{3071:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(3),i=n.n(r),o=n(6),a=n.n(o),c=n(9),u=n.n(c),s=n(12),d=n.n(s),l=n(5),f=n.n(l);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var y=function(e){u()(n,e);var t=p(n);function n(e){var n;return(n=t.call(this,e.options)).vault=e,n}return n.prototype.addressFromBase=function(){var e=i()((function*(e){return this.vault.addressFromBase(e)}));return function(t){return e.apply(this,arguments)}}(),a()(n)}(n(1147).a);!function(e){u()(n,e);var t=p(n);function n(){return t.apply(this,arguments)}a()(n)}(y)},3077:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var r=n(10),i=n.n(r),o=n(2),a=n.n(o),c=n(3),u=n.n(c),s=n(6),d=n.n(s),l=n(9),f=n.n(l),p=n(12),y=n.n(p),h=n(5),v=n.n(h),g=n(20),w=n(19);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var T=function(e){f()(n,e);var t=O(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=u()((function*(e,t){var n=t.password;if("undefined"===typeof n)throw new w.q("Software signing requires a password.");var r=yield this.getSigners(n,e.inputs.map((function(e){return e.address})));return g.a.engine.info("signTransaction",this.networkId,e),m(m({},yield this.engine.providerManager.signTransaction(this.networkId,e,r)),{},{encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=u()((function*(e,t){var n=this,r=t.password;if("undefined"===typeof r)throw new w.q("Software signing requires a password.");var o=yield this.getDbAccount(),a=Object.values(yield this.getSigners(r,[o.address])),c=i()(a,1)[0];return g.a.engine.info("signMessage",this.networkId,e),Promise.all(e.map((function(e){return n.engine.providerManager.signMessage(n.networkId,e,c)})))}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},d()(n)}(n(3071).a)},3093:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return S}));var r=n(2),i=n.n(r),o=n(146),a=n.n(o),c=n(3),u=n.n(c),s=n(6),d=n.n(s),l=n(9),f=n.n(l),p=n(12),y=n.n(p),h=n(5),v=n.n(h),g=n(26),w=n.n(g),b=n(11),m=n(20),O=n(14),T=n(53),x=n(19),j=n(184),I=n(658),E=n(56),A=n(1147);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function k(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}if(O.a.isExtensionUi)throw new Error("engine/VaultBase is not allowed imported from ui");var S=function(t){f()(r,t);var n=k(r);function r(){return n.apply(this,arguments)}var i=r.prototype;return i.init=function(){var e=u()((function*(e){yield this.initProvider(),yield this.initKeyring(e)}));return function(t){return e.apply(this,arguments)}}(),i.initKeyring=function(){var e=u()((function*(e){this.keyring=yield e.keyringCreator(this)}));return function(t){return e.apply(this,arguments)}}(),i.signTransaction=function(){var e=u()((function*(e,t){return this.keyring.signTransaction(e,t)}));return function(t,n){return e.apply(this,arguments)}}(),i.signAndSendTransaction=function(){var e=u()((function*(e,t,n){var r=yield this.signTransaction(e,t);return n?C(C({},r),{},{encodedTx:e.encodedTx}):this.broadcastTransaction(C(C({},r),{},{encodedTx:e.encodedTx}))}));return function(t,n,r){return e.apply(this,arguments)}}(),i.broadcastTransaction=function(){var e=u()((function*(e,t){m.a.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var n=yield this.engine.providerManager.broadcastTransaction(this.networkId,e.rawTx,t);return m.a.engine.info("broadcastTransaction END:",{txid:n,rawTx:e.rawTx}),C(C({},e),{},{txid:n,encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),i.buildEncodedTxFromBatchTransfer=function(){var e=u()((function*(e,t,n){throw new x.l}));return function(t,n,r){return e.apply(this,arguments)}}(),i.buildEncodedTxsFromSetApproveForAll=function(){var e=u()((function*(e,t){throw new x.l}));return function(t,n){return e.apply(this,arguments)}}(),i.activateAccount=function(){var e=u()((function*(){throw new x.l}));return function(){return e.apply(this,arguments)}}(),i.activateToken=function(){var e=u()((function*(e,t){throw new x.l}));return function(t,n){return e.apply(this,arguments)}}(),i.getTokenAllowance=function(){var e=u()((function*(e,t){throw new x.l}));return function(t,n){return e.apply(this,arguments)}}(),i.batchTokensAllowance=function(){var e=u()((function*(e,t){throw new x.l}));return function(t,n){return e.apply(this,arguments)}}(),i.getOutputAccount=function(){var e=u()((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address}}));return function(){return e.apply(this,arguments)}}(),i.getAccountBalance=function(){var e=u()((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=yield this.getDbAccount(),i=r.address;return this.getBalances((t?[{address:i}]:[]).concat(e.map((function(e){return{address:i,tokenAddress:e}}))),n)}));return function(t){return e.apply(this,arguments)}}(),i.updatePendingTxs=function(){var e=u()((function*(e){throw new x.l}));return function(t){return e.apply(this,arguments)}}(),i.getAccountNonce=function(){var e=u()((function*(){return Promise.resolve(null)}));return function(){return e.apply(this,arguments)}}(),i.fixActionDirection=function(){var e=u()((function*(e){var t,n,r,i,o=e.action,a=e.accountAddress;(o.direction=E.b.OTHER,o.type===E.a.NATIVE_TRANSFER)&&(o.direction=yield this.buildTxActionDirection({from:(null==(t=o.nativeTransfer)?void 0:t.from)||"",to:(null==(n=o.nativeTransfer)?void 0:n.to)||"",address:a}));o.type===E.a.TOKEN_TRANSFER&&(o.direction=yield this.buildTxActionDirection({from:(null==(r=o.tokenTransfer)?void 0:r.from)||"",to:(null==(i=o.tokenTransfer)?void 0:i.to)||"",address:a}));return o}));return function(t){return e.apply(this,arguments)}}(),i.fixDecodedTx=function(){var e=u()((function*(e){var t,n;e.createdAt=null!=(t=e.createdAt)?t:Date.now();var r=null==(n=e.encodedTx)?void 0:n.nonce;e.nonce=a()(r)?e.nonce:new w.a(r).toNumber();for(var i=e.owner,o=0;o<e.actions.length;o+=1){var c=e.actions[o];yield this.fixActionDirection({action:c,accountAddress:i})}if(e.outputActions)for(var u=0;u<e.outputActions.length;u+=1){var s=e.outputActions[u];yield this.fixActionDirection({action:s,accountAddress:i})}return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),i.fixHistoryTx=function(){var e=u()((function*(e){return e.decodedTx=yield this.fixDecodedTx(e.decodedTx),O.a.isDev&&O.a.isDesktop&&Object.assign(e,{_tmpCreatedAtText:new Date(e.decodedTx.createdAt||0).toLocaleString(),_tmpUpdatedAtText:new Date(e.decodedTx.updatedAt||0).toLocaleString(),_tmpStatus:e.decodedTx.status,_tmpIsFinal:e.decodedTx.isFinal}),Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),i.buildHistoryTx=function(){var e=u()((function*(e){var t=e.historyTxToMerge,n=(e.encodedTx,e.decodedTx),r=e.signedTx,i=e.isSigner,o=e.isLocalCreated,a=(null==r?void 0:r.txid)||(null==n?void 0:n.txid)||"";if(!a)throw new Error("buildHistoryTx txid not found");var c=yield this.getAccountAddress();n.txid=a||n.txid,n.owner=c,i&&(n.signer=c),null!=r&&r.txKey&&(n.extraInfo?n.extraInfo.txKey=r.txKey:n.extraInfo={txKey:r.txKey});var u=C(C({id:this.networkId+"_"+a+"_"+this.accountId,isLocalCreated:Boolean(o)},t),{},{decodedTx:n});return u=yield this.fixHistoryTx(u),Promise.resolve(u)}));return function(t){return e.apply(this,arguments)}}(),i.checkIsScamHistoryTx=function(){var e=u()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),i.fetchOnChainHistory=function(){var e=u()((function*(e){throw new x.l}));return function(t){return e.apply(this,arguments)}}(),i.fixAddressCase=function(e){return Promise.resolve(e)},i.buildTxActionDirection=function(){var e=u()((function*(e){var t=e.from,n=e.to,r=e.address;return t=yield this.fixAddressCase(t||""),n=yield this.fixAddressCase(n),r=yield this.fixAddressCase(r),t===n&&t===r?E.b.SELF:t&&t===r?E.b.OUT:n&&n===r?E.b.IN:E.b.OTHER}));return function(t){return e.apply(this,arguments)}}(),i.getNextNonce=function(){var e=u()((function*(e,t){var n,r,i=null!=(n=null==(r=(yield this.engine.providerManager.getAddresses(e,[t.address]))[0])?void 0:r.nonce)?n:0,o=(yield this.engine.getHistory(e,t.id,void 0,!1),yield T.a.history.getMaxPendingNonce({accountId:this.accountId,networkId:e})),c=yield T.a.history.getPendingNonceList({accountId:this.accountId,networkId:e}),u=Math.max(a()(o)?0:o+1,i);if(Number.isNaN(u)&&(u=i),u>i)for(var s=i;s<u;s+=1)if(!c.includes(s)){u=s;break}if(u<i&&(u=i),u-i>=b.y.PENDING_QUEUE_MAX_LENGTH)throw new x.v(b.y.PENDING_QUEUE_MAX_LENGTH);return u}));return function(t,n){return e.apply(this,arguments)}}(),i.validateSendAmount=function(e,t,n){return Promise.resolve(!0)},i.notifyChainChanged=function(e,t){},i.getFetchBalanceAddress=function(e){return Promise.resolve(e.address)},i.getPrivateKeyByCredential=function(t){return Promise.resolve(e.from(t.startsWith("0x")?t.slice(2):t,"hex"))},i.getMinDepositAmount=function(){var e=u()((function*(){return"0"}));return function(){return e.apply(this,arguments)}}(),i.specialCheckEncodedTx=function(){var e=u()((function*(e){return{success:!0}}));return function(t){return e.apply(this,arguments)}}(),d()(r)}(function(e){f()(n,e);var t=k(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.initProvider=function(){var e=u()((function*(){var e=(yield this.getNetwork()).impl;a()(I.a[e])||(this.engineProvider=yield this.engine.providerManager.getProvider(this.networkId))}));return function(){return e.apply(this,arguments)}}(),r.proxyJsonRPCCall=function(){var e=u()((function*(e){throw new x.l}));return function(t){return e.apply(this,arguments)}}(),r.createClientFromURL=function(e){throw new x.l},r.getEthersProvider=function(){var e=u()((function*(){throw new x.l}));return function(){return e.apply(this,arguments)}}(),r.getClientEndpointStatus=function(){var e=u()((function*(e){var t=this.createClientFromURL(e),n=performance.now(),r=(yield t.getInfo()).bestBlockNumber;return{responseTime:Math.floor(performance.now()-n),latestBlock:r}}));return function(t){return e.apply(this,arguments)}}(),r.validateAddress=function(){var e=u()((function*(e){var t=yield this.engineProvider.verifyAddress(e),n=t.normalizedAddress;if(!t.isValid||"undefined"===typeof n)throw new x.f;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.validateImportedCredential=function(e){return Promise.resolve(this.settings.importedAccountEnabled&&/^(0x)?[0-9a-zA-Z]{64}$/.test(e))},r.validateWatchingCredential=function(){var e=u()((function*(e){return Promise.resolve(this.settings.watchingAccountEnabled&&(yield this.engineProvider.verifyAddress(e)).isValid)}));return function(t){return e.apply(this,arguments)}}(),r.validateTokenAddress=function(){var e=u()((function*(e){var t=yield this.engineProvider.verifyTokenAddress(e),n=t.normalizedAddress;if(!t.isValid||"undefined"===typeof n)throw new x.i;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.validateCanCreateNextAccount=function(){var e=u()((function*(e,t){return Promise.resolve(!0)}));return function(t,n){return e.apply(this,arguments)}}(),r.checkAccountExistence=function(){var e=u()((function*(e){return Promise.resolve(!0)}));return function(t){return e.apply(this,arguments)}}(),r.getBalances=function(){var e=u()((function*(e,t){return(yield this.engine.providerManager.getClient(this.networkId)).getBalances(e.map((function(e){var t=e.address,n=e.tokenAddress;return{address:t,coin:C({},"string"===typeof n?{tokenAddress:n}:{})}})))}));return function(t,n){return e.apply(this,arguments)}}(),r.getFrozenBalance=function(){var e=u()((function*(e){return 0}));return function(t){return e.apply(this,arguments)}}(),r.getTransactionStatuses=function(e){return this.engine.providerManager.getTransactionStatuses(this.networkId,e)},r.getTransactionFeeInNative=function(e){return Promise.resolve("")},r.isContractAddress=function(){var e=u()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),r.getAccountNameInfoMap=function(){var e=u()((function*(){var e=yield this.getNetwork();return Object(j.a)(e.impl)}));return function(){return e.apply(this,arguments)}}(),r.canAutoCreateNextAccount=function(){var e=u()((function*(e){return Promise.resolve(!1)}));return function(t){return e.apply(this,arguments)}}(),r.filterAccounts=function(){var e=u()((function*(e){var t=e.accounts;e.networkId;return Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),r.shouldChangeAccountWhenNetworkChanged=function(){var e=u()((function*(e){e.previousNetwork,e.newNetwork,e.activeAccountId;return Promise.resolve({shouldReloadAccountList:!1,shouldChangeActiveAccount:!1})}));return function(t){return e.apply(this,arguments)}}(),r.getAccountNameInfosByImportedOrWatchingCredential=function(){var e=u()((function*(e){return Promise.resolve([])}));return function(t){return e.apply(this,arguments)}}(),d()(n)}(A.a))}).call(this,n(22).Buffer)},3094:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return v}));var r=n(3),i=n.n(r),o=n(6),a=n.n(o),c=n(9),u=n.n(c),s=n(12),d=n.n(s),l=n(5),f=n.n(l),p=n(309),y=n(253);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var v=function(t){u()(r,t);var n=h(r);function r(){return n.apply(this,arguments)}var o=r.prototype;return o.getHardwareInfo=function(){var e=i()((function*(){var e,t,n,r=yield this.engine.getHWDeviceByWalletId(this.vault.walletId);return{connectId:null!=(e=null==r?void 0:r.mac)?e:"",deviceId:null!=(t=null==r?void 0:r.deviceId)?t:"",deviceType:null!=(n=null==r?void 0:r.deviceType)?n:""}}));return function(){return e.apply(this,arguments)}}(),o.getWalletPassphraseState=function(){var e=i()((function*(){var e=yield this.engine.getWallet(this.vault.walletId);return{passphraseState:null==e?void 0:e.passphraseState,useEmptyPassphrase:!Object(y.g)(e)}}));return function(){return e.apply(this,arguments)}}(),o.getHardwareSDKInstance=function(){var t=i()((function*(){var t,n,r,i,o;return null!=(o=yield null==(t=e)||null==(n=t.$backgroundApiProxy)||null==(r=n.backgroundApi)||null==(i=r.serviceHardware)||null==i.getSDKInstance?void 0:i.getSDKInstance())?o:p.b}));return function(){return t.apply(this,arguments)}}(),a()(r)}(n(3071).a)}).call(this,n(40))},3095:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(2),i=n.n(r),o=n(3),a=n.n(o),c=n(6),u=n.n(c),s=n(9),d=n.n(s),l=n(12),f=n.n(l),p=n(5),y=n.n(p),h=n(428),v=n(19);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var m=function(e){d()(n,e);var t=b(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getPrivateKeys=function(){var e=a()((function*(e,t){var n=(yield this.getDbAccount()).path.split("/"),r=t||[n.pop()],i=n.join("/"),o=(yield this.engine.dbApi.getCredential(this.walletId,e)).seed;if("undefined"===typeof o)throw new v.q("Unable to get credential.");var a=(yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId)).curve;return Object(h.c)(a,o,e,i,r).reduce((function(e,t){var n;return w(w({},e),{},((n={})[t.path]=t.extendedKey.key,n))}),{})}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},u()(n)}(n(3077).a)},3096:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(3),i=n.n(r),o=n(6),a=n.n(o),c=n(9),u=n.n(c),s=n(12),d=n.n(s),l=n(5),f=n.n(l),p=n(19);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var h=function(e){u()(n,e);var t=y(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getPrivateKeys=function(){var e=i()((function*(e,t){if("undefined"!==typeof t)throw new p.l("Getting private keys from extended private key");var n=(yield this.engine.dbApi.getCredential(this.accountId,e)).privateKey;if("undefined"===typeof n)throw new p.q("Unable to get credential.");return{"":n}}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},a()(n)}(n(3077).a)},3097:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(3),i=n.n(r),o=n(6),a=n.n(o),c=n(9),u=n.n(c),s=n(12),d=n.n(s),l=n(5),f=n.n(l),p=n(19);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var h=function(e){u()(n,e);var t=y(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=i()((function*(e,t){throw new p.q("signTransaction is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=i()((function*(e,t){throw new p.q("signMessage is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},a()(n)}(n(3071).a)},3098:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(42),i=n(70),o=n(20),a=n(14);function c(e,t){return"string"!==typeof t?null:e===r.HardwareErrorCode.DeviceInitializeFailed&&t.includes("ECONNABORTED")?new i.h({message:t}):t.includes("Bridge network error")?new i.e({message:t}):null}function u(e){var t,n=e||{},u=n.code,s=n.error,d=n.message,l=null!=(t=null!=s?s:d)?t:"Unknown error";if(c(u,l))return c(u,l);switch(o.a.hardwareSDK.info("Device Utils Convert Device Error:",u,l),u){case r.HardwareErrorCode.UnknownError:return new i.H(e);case r.HardwareErrorCode.DeviceFwException:return new i.t(e);case r.HardwareErrorCode.DeviceUnexpectedMode:return"string"===typeof l&&-1!==l.indexOf("ui-device_bootloader_mode")?new i.E(e):new i.H(e);case r.HardwareErrorCode.DeviceCheckDeviceIdError:return new i.m(e);case r.HardwareErrorCode.DeviceNotFound:return new i.k(e);case r.HardwareErrorCode.DeviceUnexpectedBootloaderMode:return new i.E(e);case r.HardwareErrorCode.DeviceInterruptedFromOutside:case r.HardwareErrorCode.DeviceInterruptedFromUser:return new i.K(e);case r.HardwareErrorCode.DeviceNotSupportPassphrase:return new i.F(e);case r.HardwareErrorCode.IFrameLoadFail:return new i.v(e);case r.HardwareErrorCode.IframeTimeout:return new i.w(e);case r.HardwareErrorCode.FirmwareUpdateDownloadFailed:return new i.p(e);case r.HardwareErrorCode.FirmwareUpdateManuallyEnterBoot:return new i.s(e);case r.HardwareErrorCode.FirmwareUpdateAutoEnterBootFailure:return new i.q(e);case r.HardwareErrorCode.FirmwareUpdateLimitOneDevice:return new i.r(e);case r.HardwareErrorCode.CallMethodNeedUpgradeFirmware:return new i.t(e);case r.HardwareErrorCode.NewFirmwareUnRelease:return new i.D(e);case r.HardwareErrorCode.NetworkError:return new i.C(e);case r.HardwareErrorCode.BlePermissionError:return new i.A(e);case r.HardwareErrorCode.BleLocationError:return new i.z({message:l});case r.HardwareErrorCode.BleLocationServicesDisabled:return new i.b({message:l});case r.HardwareErrorCode.BleDeviceNotBonded:return new i.j(e);case r.HardwareErrorCode.BleWriteCharacteristicError:return new i.d(e);case r.HardwareErrorCode.BleScanError:return new i.c({message:l});case r.HardwareErrorCode.BleAlreadyConnected:return new i.a(e);case r.HardwareErrorCode.RuntimeError:return-1!==l.indexOf("EIP712 blind sign is disabled")?new i.G(e):-1!==l.indexOf("Unknown message")||-1!==l.indexOf("Failure_UnexpectedMessage")?new i.I(e):new i.H(e);case r.HardwareErrorCode.PinInvalid:return new i.x(e);case r.HardwareErrorCode.DeviceCheckPassphraseStateError:return new i.y(e);case r.HardwareErrorCode.DeviceOpenedPassphrase:return new i.n(e);case r.HardwareErrorCode.DeviceNotOpenedPassphrase:return new i.l(e);case r.HardwareErrorCode.PinCancelled:case r.HardwareErrorCode.ActionCancelled:return new i.J(e);case r.HardwareErrorCode.BridgeNotInstalled:case i.i.NeedOneKeyBridge:return new i.B(e);case r.HardwareErrorCode.BridgeNetworkError:return new i.e(e);case r.HardwareErrorCode.BridgeTimeoutError:return a.a.isDesktop&&(o.a.hardwareSDK.debug("desktop bridge timeout, restart desktop bridge."),window.desktopApi.reloadBridgeProcess()),new i.f(e);case r.HardwareErrorCode.PollingTimeout:return new i.h(e);case r.HardwareErrorCode.PollingStop:return new i.g(e);case r.HardwareErrorCode.BlindSignDisabled:return new i.G(e);default:return new i.H(e)}}},4473:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return C}));var r=n(2),i=n.n(r),o=n(3),a=n.n(o),c=n(6),u=n.n(c),s=n(9),d=n.n(s),l=n(12),f=n.n(l),p=n(5),y=n.n(p),h=n(191),v=n(59),g=n(3098),w=n(11),b=n(20),m=n(19),O=n(89),T=n(3094),x=n(293),j=n(1199);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var P="m/44'/"+w.t+"'",C=function(t){d()(r,t);var n=A(r);function r(){return n.apply(this,arguments)}var i=r.prototype;return i.getPublicKey=function(){var e=a()((function*(e,t,n){var r,i=yield this.getHardwareSDKInstance(),o=yield this.getWalletPassphraseState();try{r=yield i.suiGetPublicKey(e,t,E({bundle:n.map((function(e){return{path:e}}))},o))}catch(a){throw b.a.common.error(a),new m.p(a)}if(!r.success)throw b.a.common.error(r.payload),Object(g.a)(r.payload);return r.payload.map((function(e){return e.publicKey})).filter((function(e){return!!e}))}));return function(t,n,r){return e.apply(this,arguments)}}(),i.prepareAccounts=function(){var e=a()((function*(e){var t,n=e.type,r=e.indexes,i=e.names,o=r.map((function(e){return P+"/"+e+"'/0'/0'"})),a="SEARCH_ACCOUNTS"===n,c=yield this.getHardwareSDKInstance(),u=yield this.getHardwareInfo(),s=u.connectId,d=u.deviceId,l=yield this.getWalletPassphraseState();try{t=yield c.suiGetAddress(s,d,E({bundle:o.map((function(e){return{path:e,showOnOneKey:!1}}))},l))}catch(k){throw b.a.common.error(k),new m.p(k)}if(!t.success)throw b.a.common.error(t.payload),Object(g.a)(t.payload);var f,p,y=[];a||(!(null==(f=t.payload)||null==(p=f[0])||!p.publicKey)||(y=yield this.getPublicKey(s,d,o)));var h=[],v=0;for(var T of t.payload){var j=T.address,I=T.path,A=T.publicKey;if(j){var C=(i||[])[v]||"SUI #"+(r[v]+1);h.push({id:this.walletId+"--"+I,name:C,type:O.b.SIMPLE,path:I,coinType:w.t,pub:null!=A?A:y[v]||"",address:Object(x.a)(j)}),v+=1}}return h}));return function(t){return e.apply(this,arguments)}}(),i.getAddress=function(){var e=a()((function*(e){var t,n=yield this.getHardwareSDKInstance(),r=yield this.getHardwareInfo(),i=r.connectId,o=r.deviceId,a=yield this.getWalletPassphraseState(),c=yield n.suiGetAddress(i,o,E({path:e.path,showOnOneKey:e.showOnOneKey},a));if(c.success&&null!=(t=c.payload)&&t.address)return c.payload.address.toLowerCase();throw Object(g.a)(c.payload)}));return function(t){return e.apply(this,arguments)}}(),i.signTransaction=function(){var t=a()((function*(t,n){var r,i;b.a.common.info("signTransaction",t);var o=yield this.getDbAccount(),a=(yield this.engine.getNetwork(this.networkId)).rpcURL,c=new h.JsonRpcProvider(new h.Connection({fullnode:a})),u=o.address,s=null==(r=t.inputs)||null==(i=r[0])?void 0:i.publicKey;if(!s)throw new m.q("Unable to get sender public key.");var d=t.payload.encodedTx,l=yield Object(j.m)(c,u,d),f=Object(j.k)(c,l),p=yield this.getHardwareInfo(),y=p.connectId,w=p.deviceId,O=yield this.getWalletPassphraseState(),T=yield this.getHardwareSDKInstance(),I=yield T.suiSignTransaction(y,w,E({path:o.path,rawTx:Object(x.b)(e.from(f))},O));if(I.success){var A=I.payload.signature,P=Object(h.toSerializedSignature)({signatureScheme:"ED25519",signature:Object(v.hexToBytes)(A),pubKey:new h.Ed25519PublicKey(Object(v.hexToBytes)(s))});return{txid:"",rawTx:Object(h.toB64)(l),signatureScheme:"ed25519",signature:P,publicKey:Object(x.a)(s)}}throw Object(g.a)(I.payload)}));return function(e,n){return t.apply(this,arguments)}}(),i.signMessage=function(){var e=a()((function*(e,t){return b.a.common.info("signMessage",e),Promise.reject(new Error("Not implemented"))}));return function(t,n){return e.apply(this,arguments)}}(),u()(r)}(T.a)}).call(this,n(22).Buffer)},4474:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return P}));var r=n(10),i=n.n(r),o=n(3),a=n.n(o),c=n(6),u=n.n(c),s=n(9),d=n.n(s),l=n(12),f=n.n(l),p=n(5),y=n.n(p),h=n(191),v=n(59),g=n(428),w=n(11),b=n(20),m=n(19),O=n(950),T=n(89),x=n(3095),j=n(293),I=n(1199);function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var A="m/44'/"+w.t+"'",P=function(t){d()(r,t);var n=E(r);function r(){return n.apply(this,arguments)}var o=r.prototype;return o.getSigners=function(){var e=a()((function*(e,t){var n,r=yield this.getDbAccount();if(1!==t.length)throw new m.q("Sui signers number should be 1.");if(t[0]!==r.address)throw new m.q("Wrong address required for signing.");var i=(yield this.getPrivateKeys(e))[r.path];if("undefined"===typeof i)throw new m.q("Unable to get signer.");return(n={})[r.address]=new O.b(i,e,"ed25519"),n}));return function(t,n){return e.apply(this,arguments)}}(),o.prepareAccounts=function(){var e=a()((function*(e){var t=e.password,n=e.indexes,r=e.names,i=(yield this.engine.dbApi.getCredential(this.walletId,t)).seed,o=Object(g.d)("ed25519",i,t,A,n.map((function(e){return e.toString()+"'/0'/0'"})));if(o.length!==n.length)throw new m.q("Unable to get publick key.");var a=[],c=0;for(var u of o){var s=u.path,d=u.extendedKey.key,l=d.toString("hex"),f=new h.Ed25519PublicKey(d),p=Object(j.a)(f.toSuiAddress()),y=(r||[])[c]||"SUI #"+(n[c]+1);a.push({id:this.walletId+"--"+s,name:y,type:T.b.SIMPLE,path:s,coinType:w.t,pub:l,address:p}),c+=1}return a}));return function(t){return e.apply(this,arguments)}}(),o.signTransaction=function(){var t=a()((function*(t,n){var r,o;b.a.common.info("signTransaction result",t);var a=yield this.getDbAccount(),c=(yield this.engine.getNetwork(this.networkId)).rpcURL,u=new h.JsonRpcProvider(new h.Connection({fullnode:c})),s=a.address,d=(yield this.getSigners(n.password||"",[s]))[s],l=null==(r=t.inputs)||null==(o=r[0])?void 0:o.publicKey;if(!l)throw new m.q("Unable to get sender public key.");var f=t.payload.encodedTx,p=yield Object(I.m)(u,s,f),y=Object(I.k)(u,p),g=yield d.sign(e.from(y)),w=i()(g,1)[0],O=Object(h.toSerializedSignature)({signatureScheme:"ED25519",signature:w,pubKey:new h.Ed25519PublicKey(Object(v.hexToBytes)(l))});return{txid:"",rawTx:Object(h.toB64)(p),signatureScheme:"ed25519",signature:O,publicKey:Object(j.a)(l)}}));return function(e,n){return t.apply(this,arguments)}}(),o.signMessage=function(){var e=a()((function*(e,t){return Promise.reject(new Error("Not implemented"))}));return function(t,n){return e.apply(this,arguments)}}(),u()(r)}(x.a)}).call(this,n(22).Buffer)},4475:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return E}));var r=n(10),i=n.n(r),o=n(3),a=n.n(o),c=n(6),u=n.n(c),s=n(9),d=n.n(s),l=n(12),f=n.n(l),p=n(5),y=n.n(p),h=n(191),v=n(59),g=n(514),w=n(11),b=n(19),m=n(950),O=n(89),T=n(3096),x=n(293),j=n(1199);function I(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var E=function(t){d()(r,t);var n=I(r);function r(){return n.apply(this,arguments)}var o=r.prototype;return o.getSigners=function(){var e=a()((function*(e,t){var n,r=yield this.getDbAccount();if(1!==t.length)throw new b.q("Starcoin signers number should be 1.");if(t[0]!==r.address)throw new b.q("Wrong address required for signing.");var i=(yield this.getPrivateKeys(e))[r.path];if("undefined"===typeof i)throw new b.q("Unable to get signer.");return(n={})[r.address]=new m.b(i,e,"ed25519"),n}));return function(t,n){return e.apply(this,arguments)}}(),o.prepareAccounts=function(){var e=a()((function*(e){var t=e.privateKey,n=e.name;if(32!==t.length)throw new b.q("Invalid private key.");var r=g.a.publicFromPrivate(t),i=r.toString("hex"),o=new h.Ed25519PublicKey(r),a=Object(x.a)(o.toSuiAddress());return Promise.resolve([{id:"imported--"+w.t+"--"+i,name:n||"",type:O.b.SIMPLE,path:"",coinType:w.t,pub:i,address:a}])}));return function(t){return e.apply(this,arguments)}}(),o.signTransaction=function(){var t=a()((function*(t,n){var r,o,a=yield this.getDbAccount(),c=(yield this.engine.getNetwork(this.networkId)).rpcURL,u=new h.JsonRpcProvider(new h.Connection({fullnode:c})),s=a.address,d=(yield this.getSigners(n.password||"",[a.address]))[s],l=null==(r=t.inputs)||null==(o=r[0])?void 0:o.publicKey;if(!l)throw new b.q("Unable to get sender public key.");var f=t.payload.encodedTx,p=yield Object(j.m)(u,s,f),y=Object(j.k)(u,p),g=yield d.sign(e.from(y)),w=i()(g,1)[0],m=Object(h.toSerializedSignature)({signatureScheme:"ED25519",signature:w,pubKey:new h.Ed25519PublicKey(Object(v.hexToBytes)(l))});return{txid:"",rawTx:Object(h.toB64)(p),signatureScheme:"ed25519",signature:m,publicKey:Object(x.a)(l)}}));return function(e,n){return t.apply(this,arguments)}}(),o.signMessage=function(){var e=a()((function*(e,t){return Promise.reject(new Error("Not implemented"))}));return function(t,n){return e.apply(this,arguments)}}(),u()(r)}(T.a)}).call(this,n(22).Buffer)},5685:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return ee}));var r=n(2),i=n.n(r),o=n(430),a=n.n(o),c=n(173),u=n.n(c),s=n(10),d=n.n(s),l=n(789),f=n.n(l),p=n(3),y=n.n(p),h=n(6),v=n.n(h),g=n(9),w=n.n(g),b=n(12),m=n.n(b),O=n(5),T=n.n(O),x=n(191),j=n(26),I=n.n(j),E=n(126),A=n.n(E),P=n(117),C=n(136),k=n(47),S=n(20),B=n(19),R=n(56),D=n(465),N=n(293),F=n(3093),H=n(4473),K=n(4474),U=n(4475),M=n(11),_=n(89);function q(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var L=function(e){w()(n,e);var t=q(n);function n(){return t.apply(this,arguments)}return n.prototype.prepareAccounts=function(){var e=y()((function*(e){var t=e.name,n=e.target,r=e.accountIdPrefix,i=yield this.vault.validateAddress(n);if("undefined"===typeof i)throw new B.f;return Promise.resolve([{id:r+"--"+M.t+"--"+n,name:t||"",type:_.b.SIMPLE,path:"",coinType:M.t,pub:"",address:i}])}));return function(t){return e.apply(this,arguments)}}(),v()(n)}(n(3097).a),W=n(158),V=n.n(W),G=function(){function e(){}return e.isNft=function(e){return!!(e.fields.name&&e.fields.description&&e.fields.url)||!!e.fields.metadata},e.getNftObject=function(e,t){return{objectId:V()(e,"fields.id.id",""),name:e.fields.name,description:e.fields.description,url:e.fields.url,previousTransaction:t,objectType:e.type,fields:e.fields,hasPublicTransfer:!!e.has_public_transfer&&e.has_public_transfer}},v()(e)}();function z(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var J=function(e){w()(n,e);var t=z(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.tryGetPastObject=function(){var e=y()((function*(e,t){try{return yield this.client.requestWithType("sui_tryGetPastObject",[e,t],x.GetObjectDataResponse,this.options.skipDataValidation)}catch(n){throw new Error("Error fetching object info: "+n+" for id "+e)}}));return function(t,n){return e.apply(this,arguments)}}(),r.tryGetPastObjectBatch=function(){var e=y()((function*(e){var t=e.map((function(e){return{method:"sui_tryGetPastObject",args:[e.objectId,e.version]}}));try{return yield this.client.batchRequestWithType(t,x.GetObjectDataResponse,!0)}catch(n){throw new Error("Error fetching object info: "+n+" for id "+e)}}));return function(t){return e.apply(this,arguments)}}(),r.getOwnedObjects=function(){var e=y()((function*(e){var t=(yield this.getObjectsOwnedByAddress(e)).map((function(e){return e.objectId}));return(yield this.getObjectBatch(t)).filter((function(e){return"Exists"===e.status})).map((function(e){return Object(x.getObjectExistsResponse)(e)}))}));return function(t){return e.apply(this,arguments)}}(),r.getOwnedCoins=function(){var e=y()((function*(e){return(yield this.getOwnedObjects(e)).map((function(e){return{id:e.reference.objectId,object:Object(x.getMoveObject)(e)}})).filter((function(e){return e.object&&x.Coin.isCoin(e.object)})).map((function(e){return function(e){var t=x.Coin.getCoinTypeArg(e);return{objectId:V()(e,"fields.id.id",""),symbol:t?x.Coin.getCoinSymbol(t):"",balance:BigInt(e.fields.balance),object:e}}(e.object)}))}));return function(t){return e.apply(this,arguments)}}(),r.getGasObject=function(){var e=y()((function*(e,t){return(yield this.getOwnedCoins(e)).filter((function(e){return"SUI"===e.symbol})).find((function(e){return e.balance>=t}))}));return function(t,n){return e.apply(this,arguments)}}(),r.getOwnedNfts=function(){var e=y()((function*(e){return(yield this.getOwnedObjects(e)).map((function(e){return{id:e.reference.objectId,object:Object(x.getMoveObject)(e),previousTransaction:e.previousTransaction}})).filter((function(e){return e.object&&G.isNft(e.object)})).map((function(e){var t=e.object;return G.getNftObject(t,e.previousTransaction)}))}));return function(t){return e.apply(this,arguments)}}(),v()(n)}(x.JsonRpcProvider),Q=n(2109),X=n(1199);function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T()(e);if(t){var i=T()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var ee=function(e){w()(n,e);var t=Y(n);function n(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).keyringMap={hd:K.a,hw:H.a,imported:U.a,watching:L,external:L},e.settings=Q.default,e.getClientCache=A()(function(){var t=y()((function*(t){return e.getSuiClient(t)}));return function(e){return t.apply(this,arguments)}}(),{promise:!0,max:1,maxAge:Object(k.b)({minute:3})}),e}var r=n.prototype;return r.getClient=function(){var e=y()((function*(){var e=(yield this.engine.getNetwork(this.networkId)).rpcURL;return this.getClientCache(e)}));return function(){return e.apply(this,arguments)}}(),r.getSuiClient=function(e){return new J(new x.Connection({fullnode:e,faucet:"https://faucet.testnet.sui.io/gas"}))},r.getClientEndpointStatus=function(){var e=y()((function*(e){var t=yield this.getClientCache(e),n=performance.now(),r=yield t.getTotalTransactionNumber();return{responseTime:Math.floor(performance.now()-n),latestBlock:r}}));return function(t){return e.apply(this,arguments)}}(),r._getPublicKey=function(){var e=y()((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.prefix,n=void 0===t||t,r=yield this.getDbAccount(),i=r.pub;return n&&(i=Object(N.a)(i)),Promise.resolve(i)}));return function(){return e.apply(this,arguments)}}(),r.validateAddress=function(){var e=y()((function*(e){return Object(x.isValidSuiAddress)(e)?Promise.resolve(e):Promise.reject(new B.f)}));return function(t){return e.apply(this,arguments)}}(),r.validateWatchingCredential=function(e){var t=this;return this.validateAddress(e).then((function(e){return t.settings.watchingAccountEnabled&&!!e})).catch((function(){return!1}))},r.checkAccountExistence=function(){var e=y()((function*(e){var t=yield this.getClient();return"Exists"===(yield t.getObject(Object(N.d)(e))).status}));return function(t){return e.apply(this,arguments)}}(),r.getObjectsOwnedByAddress=function(){var e=y()((function*(e,t){var n=yield this.getClient(),r=yield n.getCoinBalancesOwnedByAddress(e,t),i=[];for(var o of r){var a=Object(x.getObjectExistsResponse)(o);a&&i.push(a)}return i.map((function(e){return e.data})).reduce((function(e,t){var n,r=x.Coin.getCoinTypeArg(t);r&&("undefined"===typeof e[r]&&(e[r]=BigInt(0)),e[r]+=null!=(n=x.Coin.getBalance(t))?n:BigInt(0));return e}),{})}));return function(t,n){return e.apply(this,arguments)}}(),r.getBalances=function(){var e=y()((function*(e){var t=this,n=f()(e,(function(e){return e.address})),r=new Map;return yield Promise.all(Object.entries(n).map(function(){var e=y()((function*(e){var n=d()(e,2),i=n[0],o=n[1];try{var a=yield t.getObjectsOwnedByAddress(i);o.forEach((function(e){var t,n,o=e.tokenAddress,c=null!=o?o:X.b,u=null!=(t=null==(n=a[c])?void 0:n.toString())?t:"0",s=i+"-"+c;try{r.set(s,new I.a(u))}catch(d){}}))}catch(c){}}));return function(t){return e.apply(this,arguments)}}())),e.map((function(e){var t,n=e.address,i=e.tokenAddress,o=n+"-"+(null!=i?i:X.b);return null!=(t=r.get(o))?t:new I.a(0)}))}));return function(t){return e.apply(this,arguments)}}(),r.activateAccount=function(){var e=y()((function*(){var e=yield this.getClient();yield e.requestSuiFromFaucet(yield this.getAccountAddress())}));return function(){return e.apply(this,arguments)}}(),r.fetchTokenInfos=function(){var e=y()((function*(e){var t=yield this.getClient();return Promise.all(e.map(function(){var e=y()((function*(e){try{var n=yield t.getCoinMetadata(e);return yield Promise.resolve({name:n.name,symbol:n.symbol,decimals:n.decimals})}catch(r){}}));return function(t){return e.apply(this,arguments)}}()))}));return function(t){return e.apply(this,arguments)}}(),r.validateTokenAddress=function(){var e=y()((function*(e){var t=e.split("::"),n=d()(t,3),r=n[0],i=n[1],o=n[2];if(i&&o)try{return(yield this.validateAddress(r)).toLowerCase()+"::"+i+"::"+o}catch(a){}throw new B.i}));return function(t){return e.apply(this,arguments)}}(),r.attachFeeInfoToEncodedTx=function(){var e=y()((function*(e){var t=e.feeInfoValue,n=t.price,r=t.limit;if("undefined"!==typeof n&&"string"!==typeof n)throw new B.q("Invalid gas price.");if("string"!==typeof r)throw new B.q("Invalid fee limit");var i=e.encodedTx.data;return i&&"gasBudget"in i&&(i.gasBudget=parseInt(r)),Promise.resolve(e.encodedTx)}));return function(t){return e.apply(this,arguments)}}(),r.decodedTxToLegacy=function(e){return Promise.resolve({})},r.decodeTx=function(){var e=y()((function*(e,t){var n,r,i,o,a,c,s,l=yield this.engine.getNetwork(this.networkId),f=yield this.getDbAccount(),p=yield this.engine.getNativeTokenInfo(this.networkId),y=yield this.getClient(),h=yield this.getAccountAddress();if("bytes"===e.kind)try{var v=new x.LocalTxnDataSerializer(yield this.getClient()),g=yield v.deserializeTransactionBytesToSignableTransaction(Object(X.h)(e.data));if(u()(g))s=d()(g,1)[0];else s=g}catch(V){throw new B.n("Invalid transaction data.")}else s=e;if(!s)throw new B.n("Invalid transaction data.");var w,b=[],m=s,O=m.kind,T=m.data,j=0;T&&"gasBudget"in T&&(j=null!=(w=T.gasBudget)?w:0);switch(O){case"pay":var E=yield Object(X.g)(y,T);if(E){var A,P,C,k,S="nativeTransfer";if(!E.isNative){if(S="tokenTransfer",!E.coinType)throw new B.q("Invalid coin type");if(!(p=yield this.engine.ensureTokenInDB(this.networkId,E.coinType)))throw new B.q("Invalid coin type")}b.push(((k={type:E.type})[S]={tokenInfo:p,from:h,to:E.recipient,amount:new I.a(null!=(A=E.amount.toString())?A:"0").shiftedBy(-p.decimals).toFixed(),amountValue:null!=(P=null==(C=E.amount)?void 0:C.toString())?P:"0",extraInfo:null},k))}break;case"transferSui":b.push({type:R.a.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:p,from:h,to:T.recipient,amount:new I.a(null!=(n=T.amount)?n:"0").shiftedBy(-p.decimals).toFixed(),amountValue:null!=(r=null==(i=T.amount)?void 0:i.toString())?r:"0",extraInfo:null}});break;case"paySui":for(var N=new Map,F=0;F<T.recipients.length;F+=1){var H,K=T.recipients[F],U=T.amounts[F];N.set(K,(null!=(H=N.get(K))?H:new I.a(0)).plus(new I.a(U)))}for(var M of N.entries()){var _=d()(M,2),q=_[0],L=_[1];b.push({type:R.a.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:p,from:h,to:q,amount:L.shiftedBy(-p.decimals).toFixed(),amountValue:L.toString(),extraInfo:null}})}break;case"payAllSui":b.push({type:R.a.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:p,from:h,to:T.recipient,amount:"All",amountValue:"All",extraInfo:null}});break;case"moveCall":b.push({type:R.a.FUNCTION_CALL,functionCall:{target:Object(X.l)(T.function),functionName:null!=(o=T.packageObjectId)?o:"",args:null!=(a=T.arguments)?a:[],extraInfo:null}});break;default:b.push({type:R.a.UNKNOWN,direction:R.b.OTHER,unknownAction:{extraInfo:{}}})}var W={txid:"",owner:f.address,signer:f.address,nonce:0,actions:b,status:R.c.Pending,networkId:this.networkId,accountId:this.accountId,feeInfo:{price:Object(D.d)({value:"1",network:l}),limit:null==(c=j)?void 0:c.toString()},extraInfo:null,encodedTx:e};return Promise.resolve(W)}));return function(t,n){return e.apply(this,arguments)}}(),r.buildEncodedTxFromTransfer=function(){var e=y()((function*(e){var t,n=e.to,r=e.amount,i=e.token,o=(yield this.getDbAccount()).address,c=Object(N.a)(n),u=Object(N.a)(o),s=null==i||a()(i);if(s){var d=yield this.getNetwork();t=new I.a(r).shiftedBy(d.decimals).toFixed()}else{var l=yield this.engine.ensureTokenInDB(this.networkId,i);if("undefined"===typeof l)throw new B.q("Failed to get token info.");t=new I.a(r).shiftedBy(l.decimals).toFixed()}var f=yield this.getClient(),p=s?X.b:i,y=yield f.getCoinBalancesOwnedByAddress(u,p),h=x.Coin.totalBalance(y),v=Object(X.d)(y,t),g=s?BigInt(t)+BigInt(v):BigInt(t);g>h&&(g=h);var w=x.Coin.selectCoinSetWithCombinedBalanceGreaterThanOrEqual(y,g);if(0===w.length)throw new B.d;var b,m={inputCoins:w.map((function(e){return Object(x.getObjectId)(e)})),recipients:[c],amounts:[parseInt(t)],gasBudget:v};if(s)b={kind:"paySui",data:Z({},m)};else{var O=yield f.selectCoinsWithBalanceGreaterThanOrEqual(u,BigInt(v),X.a),T=x.Coin.selectCoinWithBalanceGreaterThanOrEqual(O,BigInt(v));if(!T)throw new B.q("Failed to get gas coin.");b={kind:"pay",data:Z(Z({},m),{},{gasPayment:Object(x.getObjectId)(T)})}}return b}));return function(t){return e.apply(this,arguments)}}(),r.buildEncodedTxFromApprove=function(e){throw new B.l},r.updateEncodedTxTokenApprove=function(e,t){throw new B.l},r.updateEncodedTx=function(){var e=y()((function*(e,t,n){if("transfer"===n.type&&"paySui"===e.kind){var r=e.data;if(1===r.recipients.length)return Promise.resolve({kind:"payAllSui",data:{inputCoins:r.inputCoins.reverse(),recipient:r.recipients[0],gasBudget:r.gasBudget}})}return Promise.resolve(e)}));return function(t,n,r){return e.apply(this,arguments)}}(),r.buildUnsignedTxFromEncodedTx=function(){var e=y()((function*(e){var t=e,n=yield this.getDbAccount();return Promise.resolve({inputs:[{address:Object(N.d)(n.address),value:new I.a(0),publicKey:Object(N.d)(n.pub)}],outputs:[],payload:{encodedTx:t},encodedTx:t})}));return function(t){return e.apply(this,arguments)}}(),r.fetchFeeInfo=function(){var e=y()((function*(e){var t,n=yield this.getClient(),r=yield Promise.all([this.getNetwork(),this.buildUnsignedTxFromEncodedTx(e)]),i=d()(r,2),o=i[0],a=i[1],c=Object(D.d)({value:"1",network:o});if("bytes"===e.kind)try{var s,l,f=new x.LocalTxnDataSerializer(yield this.getClient()),p=yield f.deserializeTransactionBytesToSignableTransaction(Object(X.h)(e.data));if("gasBudget"in(s=u()(p)?p[0].data:p.data))return{disableEditFee:!0,nativeSymbol:o.symbol,nativeDecimals:o.decimals,feeSymbol:o.feeSymbol,feeDecimals:o.feeDecimals,limit:null==(l=s.gasBudget)?void 0:l.toString(),prices:[c],defaultPresetIndex:"0"}}catch(A){}var y=yield Object(X.m)(n,yield this.getAccountAddress(),a.encodedTx),h=a.encodedTx;try{var v=yield n.dryRunTransaction(y);if(!v)throw new B.n;var g,w,b,m=(null==v||null==(g=v.gasUsed)?void 0:g.computationCost)||0,O=(null==(w=v.gasUsed)?void 0:w.storageCost)||0,T=(null==(b=v.gasUsed)?void 0:b.storageRebate)||0,j=new I.a(m+O-T);if(j.isEqualTo(0))throw new B.n;t=j.multipliedBy(2).toFixed()}catch(P){if("paySui"!==h.kind)throw new B.n;var E=h.data;t=Object(X.c)(E.inputCoins.length).toString()}return{nativeSymbol:o.symbol,nativeDecimals:o.decimals,feeSymbol:o.feeSymbol,feeDecimals:o.feeDecimals,limit:t,prices:[c],defaultPresetIndex:"0"}}));return function(t){return e.apply(this,arguments)}}(),r.broadcastTransaction=function(){var e=y()((function*(e){var t=yield this.getClient();S.a.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});try{var n=e.signature,r=e.signatureScheme,i=e.publicKey;switch(r){case"ed25519":"ED25519";break;case"secp256k1":"Secp256k1";break;default:throw new B.q("Unsupported signature scheme")}if(!n)throw new Error("signature is empty");if(!i)throw new Error("publicKey is empty");var o=yield t.executeTransaction(Object(x.fromB64)(e.rawTx),n),a=Object(x.getTransactionDigest)(o);return S.a.engine.info("broadcastTransaction Done:",{txid:a,rawTx:e.rawTx,transactionResponse:o}),Z(Z({},e),{},{txid:a})}catch(l){var c=l||{},u=c.errorCode,s=c.message,d=(null!=u?u:"")+" "+s;throw-1!==s.indexOf("Insufficient gas:")?new B.q(d,"msg__broadcast_tx_Insufficient_fee"):new B.q(d)}}));return function(t){return e.apply(this,arguments)}}(),r.getExportedCredential=function(){var e=y()((function*(e){var t=yield this.getDbAccount();if(t.id.startsWith("hd-")||t.id.startsWith("imported")){var n=this.keyring,r=Object.values(yield n.getPrivateKeys(e)),i=d()(r,1)[0];return"0x"+Object(P.a)(e,i).toString("hex")}throw new B.q("Only credential of HD or imported accounts can be exported")}));return function(t){return e.apply(this,arguments)}}(),r.fetchOnChainHistory=function(){var e=y()((function*(e){var t=this,n=e.localHistory,r=void 0===n?[]:n;if(e.tokenIdOnNetwork)return Promise.resolve([]);var i=yield this.getClient(),o=yield this.getDbAccount(),a=(yield this.engine.getNativeTokenInfo(this.networkId)).decimals,c=yield i.getTransactionsForAddress(o.address);if(!c||!c.length)return[];var u=(yield i.getTransactionWithEffectsBatch(Object(X.i)(c))).map(function(){var e=y()((function*(e){var n=r.find((function(t){return t.decodedTx.txid===Object(x.getTransactionDigest)(e)}));if(n&&n.decodedTx.isFinal)return Promise.resolve(null);try{var c,u,s=yield t.engine.getNativeTokenInfo(t.networkId),d=Object(x.getExecutionStatus)(e),l="success"===(null==d?void 0:d.status),f="failure"===(null==d?void 0:d.status),p=Object(x.getCertifiedTransaction)(e);if(!p)throw new Error("current transaction is empty, continue");var h=Object(x.getTimestampFromTransactionResponse)(e),v=Object(x.getTransactionData)(p),g=v.transactions,w=v.sender,b=[],m="";yield Promise.all(g.map(function(){var e=y()((function*(e){var n=Object(X.j)(e),r="bigint"===typeof n?n:Object.values(n||{})[0],o=(Object(x.getTransferObjectTransaction)(e),Object(x.getPublishTransaction)(e),Object(x.getMoveCallTransaction)(e));if(o){var a,c,u,d="";if(o.package&&"object"===typeof o.package)d=null!=(c=null==(u=o.package)?void 0:u.objectId)?c:"";else d=o.package;return b.push({type:R.a.FUNCTION_CALL,functionCall:{target:Object(X.l)(o.function),functionName:d,args:null!=(a=o.arguments)?a:[],extraInfo:null}}),!0}var l=Object(x.getTransferSuiTransaction)(e);if(l)return m=l.recipient,b.push({type:R.a.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:s,from:w,to:m,amount:new I.a(r.toString()).shiftedBy(-s.decimals).toFixed(),amountValue:r.toString(),extraInfo:null}}),!0;var f=Object(x.getPayTransaction)(e),p=yield Object(X.f)(i,f);if(f&&p){if(p){var y,h,v,g;m=p.recipient;var O="nativeTransfer",T=s;if(!p.isNative){if(O="tokenTransfer",!p.coinType)throw new B.q("Invalid coin type");if(!(T=yield t.engine.ensureTokenInDB(t.networkId,p.coinType)))throw new B.q("Invalid coin type")}b.push(((g={type:p.type})[O]={tokenInfo:T,from:w,to:m,amount:new I.a(null!=(y=p.amount)?y:"0").shiftedBy(-T.decimals).toFixed(),amountValue:null!=(h=null==(v=p.amount)?void 0:v.toString())?h:"0",extraInfo:null},g))}return!0}var j=Object(x.getPaySuiTransaction)(e);if(j){var E;if(m=null!=(E=j.recipients[0])?E:"","bigint"===typeof n)b.push({type:R.a.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:s,from:w,to:m,amount:new I.a(r.toString()).shiftedBy(-s.decimals).toFixed(),amountValue:r.toString(),extraInfo:null}});else Object.keys(n||{}).forEach((function(e){var t=n[e];if(!t)return!0;b.push({type:R.a.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:s,from:w,to:m,amount:new I.a(t.toString()).shiftedBy(-s.decimals).toFixed(),amountValue:t.toString(),extraInfo:null}})}));return!0}var A=Object(x.getPayAllSuiTransaction)(e),P=yield Object(X.e)(i,A);if(A&&P)return m=A.recipient,b.push({type:R.a.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:s,from:w,to:m,amount:new I.a(P.amount.toString()).shiftedBy(-s.decimals).toFixed(),amountValue:P.amount.toString(),extraInfo:null}}),!0;b.push({type:R.a.UNKNOWN,direction:R.b.OTHER,unknownAction:{extraInfo:{}}})}));return function(t){return e.apply(this,arguments)}}()));var O={from:w,to:m,value:""},T=null!=(c=Object(x.getTotalGasUsed)(e))?c:"0",j=R.c.Pending;f?j=R.c.Failed:l&&(j=R.c.Confirmed);var E={txid:Object(x.getTransactionDigest)(e),owner:o.address,signer:w,nonce:0,actions:b,status:j,networkId:t.networkId,accountId:t.accountId,encodedTx:O,extraInfo:null,totalFeeInNative:new I.a(T).shiftedBy(-a).toFixed()};return E.updatedAt=h,E.createdAt=null!=(u=null==n?void 0:n.decodedTx.createdAt)?u:E.updatedAt,E.isFinal=E.status===R.c.Confirmed,yield t.buildHistoryTx({decodedTx:E,historyTxToMerge:n})}catch(A){S.a.common.error(A)}return Promise.resolve(null)}));return function(t){return e.apply(this,arguments)}}());return(yield Promise.all(u)).filter(Boolean)}));return function(t){return e.apply(this,arguments)}}(),r.getTransactionStatuses=function(){var e=y()((function*(e){var t=yield this.getClient(),n=yield t.getTransactionWithEffectsBatch(e),r=new Map;return n.forEach(function(){var e=y()((function*(e){var t=Object(x.getTransactionDigest)(e);try{var n=Object(x.getExecutionStatus)(e),i="success"===(null==n?void 0:n.status),o="failure"===(null==n?void 0:n.status),a=C.a.PENDING;o?a=C.a.CONFIRM_BUT_FAILED:i&&(a=C.a.CONFIRM_AND_SUCCESS),r.set(t,a)}catch(c){-1!==c.message.indexOf("Could not find the referenced transaction")&&r.set(t,C.a.NOT_FOUND)}}));return function(t){return e.apply(this,arguments)}}()),e.map((function(e){return r.get(e)}))}));return function(t){return e.apply(this,arguments)}}(),r.getTransactionByTxId=function(){var e=y()((function*(e){var t=yield this.getClient();return yield t.getTransactionWithEffects(e)}));return function(t){return e.apply(this,arguments)}}(),v()(n)}(F.a)}}]);