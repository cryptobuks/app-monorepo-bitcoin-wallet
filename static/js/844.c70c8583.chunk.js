(this.webpackJsonp=this.webpackJsonp||[]).push([[844],{3198:function(e,t,s){"use strict";s.r(t),s.d(t,"PasswordRoutes",(function(){return a}));var a,n=s(100),r=s(252),o=s(115),i=s(179),d=s(10),c=s.n(d),u=s(757),l=s(32),m=s(103),f=s(162),_=s(41),j=s(3),b=s.n(j),g=s(652),w=s(1),h=s(57),p=s(429),O=s(14),x=s(43),M=s(1166),v=s(178),y=s(39),P=s(80),C=s(332),S=s(0),k=function(e){var t=e.onNext,s=Object(p.a)(),a=Object(g.a)({defaultValues:{password:""},mode:"onChange"}),n=a.control,r=a.handleSubmit,o=a.setError,i=a.formState.isValid,d=Object(w.useCallback)(function(){var e=b()((function*(e){(yield x.a.engine.verifyMasterPassword(e.password))?null==t||t(e.password):o("password",{message:s.formatMessage({id:"msg__wrong_password",defaultMessage:"Wrong password."})})}));return function(t){return e.apply(this,arguments)}}(),[t,s,o]);return Object(S.jsxs)(u.a,{px:{base:4,md:0},children:[Object(S.jsx)(_.h.DisplayLarge,{textAlign:"center",mb:2,children:s.formatMessage({id:"title__enter_password",defaultMessage:"Enter Password"})}),Object(S.jsx)(_.h.Body1,{textAlign:"center",color:"text-subdued",children:s.formatMessage({id:"content__enter_current_password_before_resetting_it",defaultMessage:"Enter the old password before resetting it"})}),Object(S.jsxs)(f.a,{mt:"8",children:[Object(S.jsx)(f.a.Item,{name:"password",control:n,rules:{required:s.formatMessage({id:"form__field_is_required"})},children:Object(S.jsx)(f.a.PasswordInput,{autoFocus:!0,onSubmitEditing:r(d)})}),Object(S.jsx)(m.a,{size:"xl",type:"primary",isDisabled:!i,onPress:r(d),children:s.formatMessage({id:"action__continue",defaultMessage:"Continue"})}),O.a.isNative?Object(S.jsx)(l.a,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(S.jsx)(M.a,{onOk:t})}):null]})]})},A=function(e){var t=e.oldPassword,s=Object(p.a)(),a=Object(w.useState)(!1),n=c()(a,2),r=n[0],d=n[1],l=Object(h.u)(),j=x.a.dispatch,O=Object(w.useRef)({unmount:!1}),M=Object(y.e)((function(e){return e.status.authenticationType})),k=Object(y.e)((function(e){return e.settings.enableLocalAuthentication})),A=Object(v.l)().isOk,E=Object(g.a)({defaultValues:{password:"",confirmPassword:""},mode:"onChange"}),I=E.control,L=E.handleSubmit,V=E.getValues,q=E.setValue,B=E.watch,R=E.formState.isValid,D=Object(w.useCallback)((function(){setTimeout((function(){O.current.unmount||d(!0)}),2e3)}),[]),N=Object(w.useCallback)(function(){var e=b()((function*(e){try{D(),yield x.a.serviceApp.updatePassword(t,e.password)}catch(n){var a=n.key;return void i.a.show({title:s.formatMessage({id:a})})}e.withEnableAuthentication&&(j(Object(P.p)(!0)),Object(C.d)(e.password)),k&&Object(C.d)(e.password),t?i.a.show({title:s.formatMessage({id:"msg__password_changed"})}):i.a.show({title:s.formatMessage({id:"msg__password_has_been_set"})}),l.goBack()}));return function(t){return e.apply(this,arguments)}}(),[l,s,t,j,k,D]),F=B(["password","confirmPassword"]);Object(w.useEffect)((function(){var e=F.map((function(e){return e.split("").filter((function(e){return e.charCodeAt(0)>=32&&e.charCodeAt(0)<=126})).join("")})),t=c()(e,2),s=t[0],a=t[1];s!==F[0]&&q("password",s),a!==F[1]&&q("confirmPassword",a)}),[F,q]),Object(w.useEffect)((function(){return function(){O.current.unmount=!0}}),[]);var z="FACIAL"===M?s.formatMessage({id:"content__face_id"}):s.formatMessage({id:"content__touch_id"});return Object(S.jsxs)(u.a,{px:{base:4,md:0},children:[Object(S.jsx)(_.h.DisplayLarge,{textAlign:"center",mb:2,children:s.formatMessage({id:"title__set_password",defaultMessage:"Set Password"})}),Object(S.jsx)(_.h.Body1,{textAlign:"center",color:"text-subdued",children:s.formatMessage({id:"Only_you_can_unlock_your_wallet",defaultMessage:"Only you can unlock your wallet"})}),Object(S.jsxs)(f.a,{mt:"8",children:[Object(S.jsx)(f.a.Item,{name:"password",label:s.formatMessage({id:"form__password",defaultMessage:"Password"}),control:I,rules:{required:s.formatMessage({id:"form__field_is_required"}),minLength:{value:8,message:s.formatMessage({id:"msg__password_validation"})},maxLength:{value:128,message:s.formatMessage({id:"msg__password_validation"})},validate:function(e){var t=V("confirmPassword");if(t)return t!==e?s.formatMessage({id:"msg__password_needs_to_be_the_same"}):void 0}},children:Object(S.jsx)(f.a.PasswordInput,{autoFocus:!0})}),Object(S.jsx)(f.a.Item,{name:"confirmPassword",label:s.formatMessage({id:"Confirm_password",defaultMessage:"Confirm Password"}),control:I,rules:{required:s.formatMessage({id:"form__field_is_required"}),minLength:{value:8,message:s.formatMessage({id:"msg__password_validation"})},maxLength:{value:128,message:s.formatMessage({id:"msg__password_validation"})},validate:function(e){var t=V("password");if(t)return t!==e?s.formatMessage({id:"msg__password_needs_to_be_the_same"}):void 0}},children:Object(S.jsx)(f.a.PasswordInput,{onSubmitEditing:L(N)})}),A&&!t?Object(S.jsx)(f.a.Item,{name:"withEnableAuthentication",defaultValue:A,control:I,children:Object(S.jsx)(f.a.CheckBox,{title:s.formatMessage({id:"content__authentication_with"},{0:z})})}):null,Object(S.jsx)(m.a,{size:"xl",type:"primary",isDisabled:!R,onPromise:L(N),children:s.formatMessage({id:"action__continue",defaultMessage:"Continue"})}),r?Object(S.jsx)(o.a,{children:Object(S.jsx)(_.h.Body2,{color:"text-subdued",children:s.formatMessage({id:"content__change_password_attention"})})}):null]})]})},E=function(){var e=Object(w.useState)(""),t=c()(e,2),s=t[0],a=t[1];return s?Object(S.jsx)(A,{oldPassword:s}):Object(S.jsx)(k,{onNext:a})},I=function(){var e=Object(y.g)().isPasswordSet,t=Object(w.useState)(e),s=c()(t,1)[0];return Object(S.jsx)(r.b,{footer:null,children:Object(S.jsx)(l.a,{children:s?Object(S.jsx)(E,{}):Object(S.jsx)(A,{oldPassword:""})})})};!function(e){e.PasswordRoutes="PasswordRoutes"}(a||(a={}));var L=s(456),V=Object(L.a)(),q=[{name:a.PasswordRoutes,component:I}];t.default=function(){var e=Object(n.a)();return Object(S.jsx)(V.Navigator,{screenOptions:{headerShown:!1,animationEnabled:!!e},children:q.map((function(e){return Object(S.jsx)(V.Screen,{name:e.name,component:e.component},e.name)}))})}}}]);