(this.webpackJsonp=this.webpackJsonp||[]).push([[11],{3071:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(3),i=n.n(r),o=n(6),a=n.n(o),u=n(9),c=n.n(u),s=n(12),d=n.n(s),f=n(5),l=n.n(f);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l()(e);if(t){var i=l()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var h=function(e){c()(n,e);var t=p(n);function n(e){var n;return(n=t.call(this,e.options)).vault=e,n}return n.prototype.addressFromBase=function(){var e=i()((function*(e){return this.vault.addressFromBase(e)}));return function(t){return e.apply(this,arguments)}}(),a()(n)}(n(1147).a);!function(e){c()(n,e);var t=p(n);function n(){return t.apply(this,arguments)}a()(n)}(h)},3077:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var r=n(10),i=n.n(r),o=n(2),a=n.n(o),u=n(3),c=n.n(u),s=n(6),d=n.n(s),f=n(9),l=n.n(f),p=n(12),h=n.n(p),v=n(5),y=n.n(v),g=n(20),w=n(19);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var x=function(e){l()(n,e);var t=P(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=c()((function*(e,t){var n=t.password;if("undefined"===typeof n)throw new w.q("Software signing requires a password.");var r=yield this.getSigners(n,e.inputs.map((function(e){return e.address})));return g.a.engine.info("signTransaction",this.networkId,e),m(m({},yield this.engine.providerManager.signTransaction(this.networkId,e,r)),{},{encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=c()((function*(e,t){var n=this,r=t.password;if("undefined"===typeof r)throw new w.q("Software signing requires a password.");var o=yield this.getDbAccount(),a=Object.values(yield this.getSigners(r,[o.address])),u=i()(a,1)[0];return g.a.engine.info("signMessage",this.networkId,e),Promise.all(e.map((function(e){return n.engine.providerManager.signMessage(n.networkId,e,u)})))}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},d()(n)}(n(3071).a)},3093:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return B}));var r=n(2),i=n.n(r),o=n(146),a=n.n(o),u=n(3),c=n.n(u),s=n(6),d=n.n(s),f=n(9),l=n.n(f),p=n(12),h=n.n(p),v=n(5),y=n.n(v),g=n(26),w=n.n(g),b=n(11),m=n(20),P=n(14),x=n(53),T=n(19),O=n(184),k=n(658),A=n(56),E=n(1147);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}if(P.a.isExtensionUi)throw new Error("engine/VaultBase is not allowed imported from ui");var B=function(t){l()(r,t);var n=S(r);function r(){return n.apply(this,arguments)}var i=r.prototype;return i.init=function(){var e=c()((function*(e){yield this.initProvider(),yield this.initKeyring(e)}));return function(t){return e.apply(this,arguments)}}(),i.initKeyring=function(){var e=c()((function*(e){this.keyring=yield e.keyringCreator(this)}));return function(t){return e.apply(this,arguments)}}(),i.signTransaction=function(){var e=c()((function*(e,t){return this.keyring.signTransaction(e,t)}));return function(t,n){return e.apply(this,arguments)}}(),i.signAndSendTransaction=function(){var e=c()((function*(e,t,n){var r=yield this.signTransaction(e,t);return n?H(H({},r),{},{encodedTx:e.encodedTx}):this.broadcastTransaction(H(H({},r),{},{encodedTx:e.encodedTx}))}));return function(t,n,r){return e.apply(this,arguments)}}(),i.broadcastTransaction=function(){var e=c()((function*(e,t){m.a.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var n=yield this.engine.providerManager.broadcastTransaction(this.networkId,e.rawTx,t);return m.a.engine.info("broadcastTransaction END:",{txid:n,rawTx:e.rawTx}),H(H({},e),{},{txid:n,encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),i.buildEncodedTxFromBatchTransfer=function(){var e=c()((function*(e,t,n){throw new T.l}));return function(t,n,r){return e.apply(this,arguments)}}(),i.buildEncodedTxsFromSetApproveForAll=function(){var e=c()((function*(e,t){throw new T.l}));return function(t,n){return e.apply(this,arguments)}}(),i.activateAccount=function(){var e=c()((function*(){throw new T.l}));return function(){return e.apply(this,arguments)}}(),i.activateToken=function(){var e=c()((function*(e,t){throw new T.l}));return function(t,n){return e.apply(this,arguments)}}(),i.getTokenAllowance=function(){var e=c()((function*(e,t){throw new T.l}));return function(t,n){return e.apply(this,arguments)}}(),i.batchTokensAllowance=function(){var e=c()((function*(e,t){throw new T.l}));return function(t,n){return e.apply(this,arguments)}}(),i.getOutputAccount=function(){var e=c()((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address}}));return function(){return e.apply(this,arguments)}}(),i.getAccountBalance=function(){var e=c()((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=yield this.getDbAccount(),i=r.address;return this.getBalances((t?[{address:i}]:[]).concat(e.map((function(e){return{address:i,tokenAddress:e}}))),n)}));return function(t){return e.apply(this,arguments)}}(),i.updatePendingTxs=function(){var e=c()((function*(e){throw new T.l}));return function(t){return e.apply(this,arguments)}}(),i.getAccountNonce=function(){var e=c()((function*(){return Promise.resolve(null)}));return function(){return e.apply(this,arguments)}}(),i.fixActionDirection=function(){var e=c()((function*(e){var t,n,r,i,o=e.action,a=e.accountAddress;(o.direction=A.b.OTHER,o.type===A.a.NATIVE_TRANSFER)&&(o.direction=yield this.buildTxActionDirection({from:(null==(t=o.nativeTransfer)?void 0:t.from)||"",to:(null==(n=o.nativeTransfer)?void 0:n.to)||"",address:a}));o.type===A.a.TOKEN_TRANSFER&&(o.direction=yield this.buildTxActionDirection({from:(null==(r=o.tokenTransfer)?void 0:r.from)||"",to:(null==(i=o.tokenTransfer)?void 0:i.to)||"",address:a}));return o}));return function(t){return e.apply(this,arguments)}}(),i.fixDecodedTx=function(){var e=c()((function*(e){var t,n;e.createdAt=null!=(t=e.createdAt)?t:Date.now();var r=null==(n=e.encodedTx)?void 0:n.nonce;e.nonce=a()(r)?e.nonce:new w.a(r).toNumber();for(var i=e.owner,o=0;o<e.actions.length;o+=1){var u=e.actions[o];yield this.fixActionDirection({action:u,accountAddress:i})}if(e.outputActions)for(var c=0;c<e.outputActions.length;c+=1){var s=e.outputActions[c];yield this.fixActionDirection({action:s,accountAddress:i})}return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),i.fixHistoryTx=function(){var e=c()((function*(e){return e.decodedTx=yield this.fixDecodedTx(e.decodedTx),P.a.isDev&&P.a.isDesktop&&Object.assign(e,{_tmpCreatedAtText:new Date(e.decodedTx.createdAt||0).toLocaleString(),_tmpUpdatedAtText:new Date(e.decodedTx.updatedAt||0).toLocaleString(),_tmpStatus:e.decodedTx.status,_tmpIsFinal:e.decodedTx.isFinal}),Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),i.buildHistoryTx=function(){var e=c()((function*(e){var t=e.historyTxToMerge,n=(e.encodedTx,e.decodedTx),r=e.signedTx,i=e.isSigner,o=e.isLocalCreated,a=(null==r?void 0:r.txid)||(null==n?void 0:n.txid)||"";if(!a)throw new Error("buildHistoryTx txid not found");var u=yield this.getAccountAddress();n.txid=a||n.txid,n.owner=u,i&&(n.signer=u),null!=r&&r.txKey&&(n.extraInfo?n.extraInfo.txKey=r.txKey:n.extraInfo={txKey:r.txKey});var c=H(H({id:this.networkId+"_"+a+"_"+this.accountId,isLocalCreated:Boolean(o)},t),{},{decodedTx:n});return c=yield this.fixHistoryTx(c),Promise.resolve(c)}));return function(t){return e.apply(this,arguments)}}(),i.checkIsScamHistoryTx=function(){var e=c()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),i.fetchOnChainHistory=function(){var e=c()((function*(e){throw new T.l}));return function(t){return e.apply(this,arguments)}}(),i.fixAddressCase=function(e){return Promise.resolve(e)},i.buildTxActionDirection=function(){var e=c()((function*(e){var t=e.from,n=e.to,r=e.address;return t=yield this.fixAddressCase(t||""),n=yield this.fixAddressCase(n),r=yield this.fixAddressCase(r),t===n&&t===r?A.b.SELF:t&&t===r?A.b.OUT:n&&n===r?A.b.IN:A.b.OTHER}));return function(t){return e.apply(this,arguments)}}(),i.getNextNonce=function(){var e=c()((function*(e,t){var n,r,i=null!=(n=null==(r=(yield this.engine.providerManager.getAddresses(e,[t.address]))[0])?void 0:r.nonce)?n:0,o=(yield this.engine.getHistory(e,t.id,void 0,!1),yield x.a.history.getMaxPendingNonce({accountId:this.accountId,networkId:e})),u=yield x.a.history.getPendingNonceList({accountId:this.accountId,networkId:e}),c=Math.max(a()(o)?0:o+1,i);if(Number.isNaN(c)&&(c=i),c>i)for(var s=i;s<c;s+=1)if(!u.includes(s)){c=s;break}if(c<i&&(c=i),c-i>=b.y.PENDING_QUEUE_MAX_LENGTH)throw new T.v(b.y.PENDING_QUEUE_MAX_LENGTH);return c}));return function(t,n){return e.apply(this,arguments)}}(),i.validateSendAmount=function(e,t,n){return Promise.resolve(!0)},i.notifyChainChanged=function(e,t){},i.getFetchBalanceAddress=function(e){return Promise.resolve(e.address)},i.getPrivateKeyByCredential=function(t){return Promise.resolve(e.from(t.startsWith("0x")?t.slice(2):t,"hex"))},i.getMinDepositAmount=function(){var e=c()((function*(){return"0"}));return function(){return e.apply(this,arguments)}}(),i.specialCheckEncodedTx=function(){var e=c()((function*(e){return{success:!0}}));return function(t){return e.apply(this,arguments)}}(),d()(r)}(function(e){l()(n,e);var t=S(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.initProvider=function(){var e=c()((function*(){var e=(yield this.getNetwork()).impl;a()(k.a[e])||(this.engineProvider=yield this.engine.providerManager.getProvider(this.networkId))}));return function(){return e.apply(this,arguments)}}(),r.proxyJsonRPCCall=function(){var e=c()((function*(e){throw new T.l}));return function(t){return e.apply(this,arguments)}}(),r.createClientFromURL=function(e){throw new T.l},r.getEthersProvider=function(){var e=c()((function*(){throw new T.l}));return function(){return e.apply(this,arguments)}}(),r.getClientEndpointStatus=function(){var e=c()((function*(e){var t=this.createClientFromURL(e),n=performance.now(),r=(yield t.getInfo()).bestBlockNumber;return{responseTime:Math.floor(performance.now()-n),latestBlock:r}}));return function(t){return e.apply(this,arguments)}}(),r.validateAddress=function(){var e=c()((function*(e){var t=yield this.engineProvider.verifyAddress(e),n=t.normalizedAddress;if(!t.isValid||"undefined"===typeof n)throw new T.f;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.validateImportedCredential=function(e){return Promise.resolve(this.settings.importedAccountEnabled&&/^(0x)?[0-9a-zA-Z]{64}$/.test(e))},r.validateWatchingCredential=function(){var e=c()((function*(e){return Promise.resolve(this.settings.watchingAccountEnabled&&(yield this.engineProvider.verifyAddress(e)).isValid)}));return function(t){return e.apply(this,arguments)}}(),r.validateTokenAddress=function(){var e=c()((function*(e){var t=yield this.engineProvider.verifyTokenAddress(e),n=t.normalizedAddress;if(!t.isValid||"undefined"===typeof n)throw new T.i;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.validateCanCreateNextAccount=function(){var e=c()((function*(e,t){return Promise.resolve(!0)}));return function(t,n){return e.apply(this,arguments)}}(),r.checkAccountExistence=function(){var e=c()((function*(e){return Promise.resolve(!0)}));return function(t){return e.apply(this,arguments)}}(),r.getBalances=function(){var e=c()((function*(e,t){return(yield this.engine.providerManager.getClient(this.networkId)).getBalances(e.map((function(e){var t=e.address,n=e.tokenAddress;return{address:t,coin:H({},"string"===typeof n?{tokenAddress:n}:{})}})))}));return function(t,n){return e.apply(this,arguments)}}(),r.getFrozenBalance=function(){var e=c()((function*(e){return 0}));return function(t){return e.apply(this,arguments)}}(),r.getTransactionStatuses=function(e){return this.engine.providerManager.getTransactionStatuses(this.networkId,e)},r.getTransactionFeeInNative=function(e){return Promise.resolve("")},r.isContractAddress=function(){var e=c()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),r.getAccountNameInfoMap=function(){var e=c()((function*(){var e=yield this.getNetwork();return Object(O.a)(e.impl)}));return function(){return e.apply(this,arguments)}}(),r.canAutoCreateNextAccount=function(){var e=c()((function*(e){return Promise.resolve(!1)}));return function(t){return e.apply(this,arguments)}}(),r.filterAccounts=function(){var e=c()((function*(e){var t=e.accounts;e.networkId;return Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),r.shouldChangeAccountWhenNetworkChanged=function(){var e=c()((function*(e){e.previousNetwork,e.newNetwork,e.activeAccountId;return Promise.resolve({shouldReloadAccountList:!1,shouldChangeActiveAccount:!1})}));return function(t){return e.apply(this,arguments)}}(),r.getAccountNameInfosByImportedOrWatchingCredential=function(){var e=c()((function*(e){return Promise.resolve([])}));return function(t){return e.apply(this,arguments)}}(),d()(n)}(E.a))}).call(this,n(22).Buffer)},3094:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return y}));var r=n(3),i=n.n(r),o=n(6),a=n.n(o),u=n(9),c=n.n(u),s=n(12),d=n.n(s),f=n(5),l=n.n(f),p=n(309),h=n(253);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l()(e);if(t){var i=l()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var y=function(t){c()(r,t);var n=v(r);function r(){return n.apply(this,arguments)}var o=r.prototype;return o.getHardwareInfo=function(){var e=i()((function*(){var e,t,n,r=yield this.engine.getHWDeviceByWalletId(this.vault.walletId);return{connectId:null!=(e=null==r?void 0:r.mac)?e:"",deviceId:null!=(t=null==r?void 0:r.deviceId)?t:"",deviceType:null!=(n=null==r?void 0:r.deviceType)?n:""}}));return function(){return e.apply(this,arguments)}}(),o.getWalletPassphraseState=function(){var e=i()((function*(){var e=yield this.engine.getWallet(this.vault.walletId);return{passphraseState:null==e?void 0:e.passphraseState,useEmptyPassphrase:!Object(h.g)(e)}}));return function(){return e.apply(this,arguments)}}(),o.getHardwareSDKInstance=function(){var t=i()((function*(){var t,n,r,i,o;return null!=(o=yield null==(t=e)||null==(n=t.$backgroundApiProxy)||null==(r=n.backgroundApi)||null==(i=r.serviceHardware)||null==i.getSDKInstance?void 0:i.getSDKInstance())?o:p.b}));return function(){return t.apply(this,arguments)}}(),a()(r)}(n(3071).a)}).call(this,n(40))},3095:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(2),i=n.n(r),o=n(3),a=n.n(o),u=n(6),c=n.n(u),s=n(9),d=n.n(s),f=n(12),l=n.n(f),p=n(5),h=n.n(p),v=n(428),y=n(19);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l()(this,n)}}var m=function(e){d()(n,e);var t=b(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getPrivateKeys=function(){var e=a()((function*(e,t){var n=(yield this.getDbAccount()).path.split("/"),r=t||[n.pop()],i=n.join("/"),o=(yield this.engine.dbApi.getCredential(this.walletId,e)).seed;if("undefined"===typeof o)throw new y.q("Unable to get credential.");var a=(yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId)).curve;return Object(v.c)(a,o,e,i,r).reduce((function(e,t){var n;return w(w({},e),{},((n={})[t.path]=t.extendedKey.key,n))}),{})}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},c()(n)}(n(3077).a)},3096:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(3),i=n.n(r),o=n(6),a=n.n(o),u=n(9),c=n.n(u),s=n(12),d=n.n(s),f=n(5),l=n.n(f),p=n(19);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l()(e);if(t){var i=l()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var v=function(e){c()(n,e);var t=h(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getPrivateKeys=function(){var e=i()((function*(e,t){if("undefined"!==typeof t)throw new p.l("Getting private keys from extended private key");var n=(yield this.engine.dbApi.getCredential(this.accountId,e)).privateKey;if("undefined"===typeof n)throw new p.q("Unable to get credential.");return{"":n}}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},a()(n)}(n(3077).a)},3097:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(3),i=n.n(r),o=n(6),a=n.n(o),u=n(9),c=n.n(u),s=n(12),d=n.n(s),f=n(5),l=n.n(f),p=n(19);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l()(e);if(t){var i=l()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var v=function(e){c()(n,e);var t=h(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=i()((function*(e,t){throw new p.q("signTransaction is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=i()((function*(e,t){throw new p.q("signMessage is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},a()(n)}(n(3071).a)},3098:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(42),i=n(70),o=n(20),a=n(14);function u(e,t){return"string"!==typeof t?null:e===r.HardwareErrorCode.DeviceInitializeFailed&&t.includes("ECONNABORTED")?new i.h({message:t}):t.includes("Bridge network error")?new i.e({message:t}):null}function c(e){var t,n=e||{},c=n.code,s=n.error,d=n.message,f=null!=(t=null!=s?s:d)?t:"Unknown error";if(u(c,f))return u(c,f);switch(o.a.hardwareSDK.info("Device Utils Convert Device Error:",c,f),c){case r.HardwareErrorCode.UnknownError:return new i.H(e);case r.HardwareErrorCode.DeviceFwException:return new i.t(e);case r.HardwareErrorCode.DeviceUnexpectedMode:return"string"===typeof f&&-1!==f.indexOf("ui-device_bootloader_mode")?new i.E(e):new i.H(e);case r.HardwareErrorCode.DeviceCheckDeviceIdError:return new i.m(e);case r.HardwareErrorCode.DeviceNotFound:return new i.k(e);case r.HardwareErrorCode.DeviceUnexpectedBootloaderMode:return new i.E(e);case r.HardwareErrorCode.DeviceInterruptedFromOutside:case r.HardwareErrorCode.DeviceInterruptedFromUser:return new i.K(e);case r.HardwareErrorCode.DeviceNotSupportPassphrase:return new i.F(e);case r.HardwareErrorCode.IFrameLoadFail:return new i.v(e);case r.HardwareErrorCode.IframeTimeout:return new i.w(e);case r.HardwareErrorCode.FirmwareUpdateDownloadFailed:return new i.p(e);case r.HardwareErrorCode.FirmwareUpdateManuallyEnterBoot:return new i.s(e);case r.HardwareErrorCode.FirmwareUpdateAutoEnterBootFailure:return new i.q(e);case r.HardwareErrorCode.FirmwareUpdateLimitOneDevice:return new i.r(e);case r.HardwareErrorCode.CallMethodNeedUpgradeFirmware:return new i.t(e);case r.HardwareErrorCode.NewFirmwareUnRelease:return new i.D(e);case r.HardwareErrorCode.NetworkError:return new i.C(e);case r.HardwareErrorCode.BlePermissionError:return new i.A(e);case r.HardwareErrorCode.BleLocationError:return new i.z({message:f});case r.HardwareErrorCode.BleLocationServicesDisabled:return new i.b({message:f});case r.HardwareErrorCode.BleDeviceNotBonded:return new i.j(e);case r.HardwareErrorCode.BleWriteCharacteristicError:return new i.d(e);case r.HardwareErrorCode.BleScanError:return new i.c({message:f});case r.HardwareErrorCode.BleAlreadyConnected:return new i.a(e);case r.HardwareErrorCode.RuntimeError:return-1!==f.indexOf("EIP712 blind sign is disabled")?new i.G(e):-1!==f.indexOf("Unknown message")||-1!==f.indexOf("Failure_UnexpectedMessage")?new i.I(e):new i.H(e);case r.HardwareErrorCode.PinInvalid:return new i.x(e);case r.HardwareErrorCode.DeviceCheckPassphraseStateError:return new i.y(e);case r.HardwareErrorCode.DeviceOpenedPassphrase:return new i.n(e);case r.HardwareErrorCode.DeviceNotOpenedPassphrase:return new i.l(e);case r.HardwareErrorCode.PinCancelled:case r.HardwareErrorCode.ActionCancelled:return new i.J(e);case r.HardwareErrorCode.BridgeNotInstalled:case i.i.NeedOneKeyBridge:return new i.B(e);case r.HardwareErrorCode.BridgeNetworkError:return new i.e(e);case r.HardwareErrorCode.BridgeTimeoutError:return a.a.isDesktop&&(o.a.hardwareSDK.debug("desktop bridge timeout, restart desktop bridge."),window.desktopApi.reloadBridgeProcess()),new i.f(e);case r.HardwareErrorCode.PollingTimeout:return new i.h(e);case r.HardwareErrorCode.PollingStop:return new i.g(e);case r.HardwareErrorCode.BlindSignDisabled:return new i.G(e);default:return new i.H(e)}}},3350:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d}));var r=n(10),i=n.n(r),o=n(19),a=n(773);function u(e,t){var n=t?t.toUpperCase():"";switch(e){case 44:return{namePrefix:n+" Legacy",addressEncoding:a.a.P2PKH};case 49:return{namePrefix:n+" Nested SegWit",addressEncoding:a.a.P2SH_P2WPKH};case 84:return{namePrefix:n+" Native SegWit",addressEncoding:a.a.P2WPKH};case 86:return{namePrefix:n+" Taproot",addressEncoding:a.a.P2TR};default:throw new o.l("Unsupported purpose "+e+".")}}function c(e,t){var n="";for(var r of Object.entries(e.addresses)){var o=i()(r,2),a=o[0];if(o[1]===t){n=a;break}}return e.path+"/"+n}var s=function(e){return e.startsWith("m/86'/")};function d(e){var t=/tr\(\[(.*)\](.*)\/<0;1>\/\*\)/.exec(e);return!(!t||!t[2])}},3382:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return z}));var r=n(2),i=n.n(r),o=n(15),a=n.n(o),u=n(16),c=n.n(u),s=n(10),d=n.n(s),f=n(3),l=n.n(f),p=n(6),h=n.n(p),v=n(9),y=n.n(v),g=n(12),w=n.n(g),b=n(5),m=n.n(b),P=n(26),x=n.n(P),T=n(3101),O=n.n(T),k=n(4173),A=n.n(k),E=n(4176),I=n.n(E),H=n(126),S=n.n(H),B=n(117),C=n(11),j=n(20),D=n(19),R=n(310),N=n(184),K=n(77),F=n(56),U=n(3093),V=n(3454),_=n(693),M=n(3350),W=["txId","value"];function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function q(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return w()(this,n)}}var z=function(t){y()(r,t);var n=q(r);function r(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return(e=n.call.apply(n,[this].concat(r))).keyringMap={},e.settings={},e.providerClass=V.a,e.collectUTXOs=S()(l()((function*(){var t=yield e.getProvider(),n=yield e.getDbAccount();try{return yield t.getUTXOs(e.getAccountXpub(n))}catch(r){throw new D.q("Failed to get UTXOs of the account.")}})),{promise:!0,max:1,maxAge:3e4}),e.getFeeRate=S()(l()((function*(){var t=yield(yield e.getProvider()).blockbook,n=e.getDefaultBlockNums();try{return(yield Promise.all(n.map((function(e){return t.estimateFee(e).then((function(e){return new x.a(e).toFixed(0)}))})))).sort((function(e,t){var n=new x.a(e),r=new x.a(t);return n.gt(r)?1:n.lt(r)?-1:0}))}catch(r){throw new D.q("Failed to get fee rates.")}})),{promise:!0,max:1,maxAge:3e4}),e}var i=r.prototype;return i.getDefaultPurpose=function(){return Object(R.c)(C.D)},i.getCoinName=function(){return"BTC"},i.getCoinType=function(){return C.h},i.getXprvReg=function(){return/^[xyz]prv/},i.getXpubReg=function(){return/^[xyz]pub/},i.getDefaultBlockNums=function(){return[5,2,1]},i.getDefaultBlockTime=function(){return 600},i.getAccountXpub=function(e){return e.xpub},i.getProvider=function(){var e=l()((function*(){var e,t,n=yield this.getRpcUrl(),r="";null!=(e=this.provider)&&e.chainInfo&&(r=Object(_.c)(null==(t=this.provider)?void 0:t.chainInfo));if(!this.provider||r!==n){var i=yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId),o=this.providerClass;this.provider=new o(i)}return this.provider}));return function(){return e.apply(this,arguments)}}(),i.getOutputAccount=function(){var e=l()((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address,xpub:this.getAccountXpub(e)}}));return function(){return e.apply(this,arguments)}}(),i.getFetchBalanceAddress=function(e){return Promise.resolve(this.getAccountXpub(e))},i.validateAddress=function(){var e=l()((function*(e){var t=(yield this.getProvider()).verifyAddress(e),n=t.normalizedAddress;if(!t.isValid||"undefined"===typeof n)throw new D.f;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),i.validateImportedCredential=function(){var e=l()((function*(e){var t=this.getXprvReg(),n=!1;try{n=this.settings.importedAccountEnabled&&t.test(e)&&(yield this.getProvider()).isValidXprv(e)}catch(r){}return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),i.validateWatchingCredential=function(){var e=l()((function*(e){var t=this.getXpubReg(),n=!1;try{n=this.settings.watchingAccountEnabled&&t.test(e)&&(yield this.getProvider()).isValidXpub(e)}catch(r){}return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),i.validateCanCreateNextAccount=function(){var e=l()((function*(e,t){var n=yield Promise.all([this.engine.getWallet(e),this.engine.getNetwork(this.networkId)]),r=d()(n,2),i=r[0],o=r[1],a=Object(R.d)(i,o.impl,t);if(!a)return!0;var u=yield this.engine.dbApi.getAccounts([a]),c=d()(u,1)[0];if("undefined"!==typeof c&&!(yield this.checkAccountExistence(this.getAccountXpub(c)))){var s=Object(N.b)(o.impl,t).label;throw new D.w(s)}return!0}));return function(t,n){return e.apply(this,arguments)}}(),i.checkAccountExistence=function(){var e=l()((function*(e){var t=!1;try{var n=yield this.getProvider();t=(yield n.getAccount({type:"simple",xpub:e})).txs>0}catch(r){}return Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),i.getAccountBalance=function(){var e=l()((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.map((function(e){}));if(!t)return n;var r=yield this.getDbAccount(),i=this.getAccountXpub(r);if(!i)return[new x.a("0")].concat(c()(n));var o=yield this.getBalances([{address:i}]),a=d()(o,1),u=a[0];return[u].concat(n)}));return function(t){return e.apply(this,arguments)}}(),i.getBalances=function(){var e=l()((function*(e){return(yield this.getProvider()).getBalances(e)}));return function(t){return e.apply(this,arguments)}}(),i.getExportedCredential=function(){var t=l()((function*(t){var n=yield this.getDbAccount();if(n.id.startsWith("hd-")){var r=parseInt(n.path.split("/")[1]),i=Object(M.a)(r,this.getCoinName()).addressEncoding,o=(yield this.getProvider()).network,a=((o.segwitVersionBytes||{})[i]||o.bip32).private,u=this.keyring,c=Object.values(yield u.getPrivateKeys(t)),s=d()(c,1)[0];return O.a.encode(O.a.decode(n.xpub).fill(e.from(a.toString(16).padStart(8,"0"),"hex"),0,4).fill(e.concat([e.from([0]),Object(B.a)(t,s)]),45,78))}if(n.id.startsWith("imported-")){var f=(yield this.engine.dbApi.getCredential(this.accountId,t)).privateKey;if("undefined"===typeof f)throw new D.q("Unable to get credential.");return O.a.encode(Object(B.a)(t,f))}throw new D.q("Only credential of HD or imported accounts can be exported")}));return function(e){return t.apply(this,arguments)}}(),i.attachFeeInfoToEncodedTx=function(e){var t=e.feeInfoValue.price;return"string"===typeof t?this.buildEncodedTxFromTransfer(e.encodedTx.transferInfo,t):Promise.resolve(e.encodedTx)},i.decodedTxToLegacy=function(e){var t=e.actions[0],n=t.type,r=t.nativeTransfer;if(n!==F.a.NATIVE_TRANSFER||"undefined"===typeof r)throw new D.q("Incorrect decodedTx.");return Promise.resolve({txType:K.a.NATIVE_TRANSFER,symbol:"UNKNOWN",amount:r.amount,value:r.amountValue,fromAddress:r.from,toAddress:r.to,data:"",totalFeeInNative:e.totalFeeInNative,total:x.a.sum.apply(null,(r.utxoFrom||[]).map((function(e){return e.balanceValue}))).toFixed()})},i.decodeTx=function(){var e=l()((function*(e,t){var n=e.inputs,r=e.outputs,i=yield this.engine.getNetwork(this.networkId),o=yield this.getDbAccount(),a={tokenInfo:yield this.engine.getNativeTokenInfo(this.networkId),utxoFrom:n.map((function(e){return{address:e.address,balance:new x.a(e.value).shiftedBy(-i.decimals).toFixed(),balanceValue:e.value,symbol:i.symbol,isMine:!0}})),utxoTo:r.map((function(e){return{address:e.address,balance:new x.a(e.value).shiftedBy(-i.decimals).toFixed(),balanceValue:e.value,symbol:i.symbol,isMine:e.address===o.address}})),from:o.address,to:r[0].address,amount:new x.a(r[0].value).shiftedBy(-i.decimals).toFixed(),amountValue:r[0].value,extraInfo:null};return{txid:"",owner:o.address,signer:o.address,nonce:0,actions:[{type:F.a.NATIVE_TRANSFER,direction:r[0].address===o.address?F.b.OUT:F.b.SELF,nativeTransfer:a}],status:F.c.Pending,networkId:this.networkId,accountId:this.accountId,extraInfo:null,totalFeeInNative:e.totalFeeInNative}}));return function(t,n){return e.apply(this,arguments)}}(),i.buildEncodedTxFromTransfer=function(){var e=l()((function*(e,t){var n=e.to,r=e.amount,i=yield this.engine.getNetwork(this.networkId),o=yield this.getDbAccount(),u=yield this.collectUTXOs(),c="undefined"!==typeof t?new x.a(t).shiftedBy(i.feeDecimals).toFixed():(yield this.getFeeRate())[0],s=u.reduce((function(e,t){var n=t.value;return e.plus(n)}),new x.a("0")).shiftedBy(-i.decimals).lte(r),d=(s?I.a:A.a)(u.map((function(e){var t=e.txid,n=e.vout,r=e.value,i=e.address,o=e.path;return{txId:t,vout:n,value:parseInt(r),address:i,path:o}})),[s?{address:n}:{address:n,value:parseInt(new x.a(r).shiftedBy(i.decimals).toFixed())}],parseInt(c)),f=d.inputs,l=d.outputs,p=d.fee;if(!f||!l)throw new D.d("Failed to select UTXOs");var h=p.toString(),v=new x.a(h).shiftedBy(-1*i.feeDecimals).toFixed();return{inputs:f.map((function(e){var t=e.txId,n=e.value;return L(L({},a()(e,W)),{},{txid:t,value:n.toString()})})),outputs:l.map((function(e){var t=e.value,n=e.address;return{address:n||o.address,value:t.toString(),payload:n?void 0:{isCharge:!0,bip44Path:Object(M.b)(o,o.address)}}})),totalFee:h,totalFeeInNative:v,transferInfo:e}}));return function(t,n){return e.apply(this,arguments)}}(),i.buildEncodedTxFromApprove=function(e){throw new D.l},i.updateEncodedTxTokenApprove=function(e,t){throw new D.l},i.updateEncodedTx=function(e,t,n){return Promise.resolve(e)},i.buildUnsignedTxFromEncodedTx=function(e){var t=e.inputs,n=e.outputs,r=[];for(var i of t){var o=new x.a(i.value);r.push({address:i.address,value:o,utxo:{txid:i.txid,vout:i.vout,value:o}})}var a={inputs:r,outputs:n.map((function(e){var t=e.address,n=e.value,r=e.payload;return{address:t,value:new x.a(n),payload:r}})),payload:{},encodedTx:e};return Promise.resolve(a)},i.fetchFeeInfo=function(){var e=l()((function*(e){var t=this,n=yield this.engine.getNetwork(this.networkId),r=yield this.getProvider(),i=(yield r.buildUnsignedTx(L(L({},yield this.buildUnsignedTxFromEncodedTx(e)),{},{feePricePerUnit:new x.a(1)}))).feeLimit,o=(yield this.getFeeRate()).map((function(e){return new x.a(e).shiftedBy(-n.feeDecimals).toFixed()})),a=this.getDefaultBlockNums();return{customDisabled:!0,limit:(null!=i?i:new x.a(0)).toFixed(),prices:o,waitingSeconds:a.map((function(e){return e*t.getDefaultBlockTime()})),defaultPresetIndex:"1",feeSymbol:"BTC",feeDecimals:n.feeDecimals,nativeSymbol:n.symbol,nativeDecimals:n.decimals,tx:null}}));return function(t){return e.apply(this,arguments)}}(),i.broadcastTransaction=function(){var e=l()((function*(e){j.a.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var t=yield this.getProvider(),n=yield t.broadcastTransaction(e.rawTx);return j.a.engine.info("broadcastTransaction END:",{txid:n,rawTx:e.rawTx}),L(L({},e),{},{txid:n})}));return function(t){return e.apply(this,arguments)}}(),i.getTransactionStatuses=function(){var e=l()((function*(e){return(yield this.getProvider()).getTransactionStatuses(e)}));return function(t){return e.apply(this,arguments)}}(),i.fetchOnChainHistory=function(){var e=l()((function*(e){var t=this,n=e.localHistory,r=void 0===n?[]:n,i=yield this.getProvider(),o=yield this.getDbAccount(),a=yield this.engine.getNetwork(this.networkId),u=a.decimals,c=a.symbol,s=a.impl,d=yield this.engine.getNativeTokenInfo(this.networkId),f=[];try{var l;f=null!=(l=(yield i.getHistory({type:"history",xpub:this.getAccountXpub(o)},s,o.address,c,u)).transactions)?l:[]}catch(h){}var p=f.map((function(e){try{var n,i,a=r.find((function(t){return t.decodedTx.txid===e.txid}));if(a&&a.decodedTx.isFinal)return null;var c=e.direction,s=e.utxoFrom,f=e.utxoTo,l=e.from,p=e.to,v=e.amount,y=e.amountValue,g={txid:e.txid,owner:o.address,signer:o.address,nonce:0,actions:[{type:F.a.NATIVE_TRANSFER,direction:c,nativeTransfer:{tokenInfo:d,utxoFrom:s,utxoTo:f,from:l,to:p,amount:v,amountValue:y,extraInfo:null}}],status:(null!=(n=e.confirmations)?n:0)>0?F.c.Confirmed:F.c.Pending,networkId:t.networkId,accountId:t.accountId,extraInfo:null,totalFeeInNative:new x.a(e.fees).shiftedBy(-u).toFixed()};return g.updatedAt="undefined"!==typeof e.blockTime?1e3*e.blockTime:Date.now(),g.createdAt=null!=(i=null==a?void 0:a.decodedTx.createdAt)?i:g.updatedAt,g.isFinal=g.status===F.c.Confirmed,t.buildHistoryTx({decodedTx:g,historyTxToMerge:a})}catch(h){return Promise.resolve(null)}}));return(yield Promise.all(p)).filter(Boolean)}));return function(t){return e.apply(this,arguments)}}(),i.createClientFromURL=function(e){return new _.a(e)},i.fetchTokenInfos=function(e){throw new D.l},i.getPrivateKeyByCredential=function(){var e=l()((function*(e){return Promise.resolve(O.a.decode(e))}));return function(t){return e.apply(this,arguments)}}(),h()(r)}(U.a)}).call(this,n(22).Buffer)},3385:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r=n(16),i=n.n(r),o=n(2),a=n.n(o),u=n(3),c=n.n(u),s=n(6),d=n.n(s),f=n(9),l=n.n(f),p=n(12),h=n.n(p),v=n(5),y=n.n(v),g=n(3349),w=n(3098),b=n(309),m=n(11),P=n(19),x=n(310),T=n(184),O=n(89),k=n(3094),A=n(3350);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function H(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var S=function(e){l()(n,e);var t=H(n);function n(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).buildHardwareInput=function(){var e=c()((function*(e,t){var n=yield Object(b.a)(),r=n.getHDPath,i=n.getScriptType,o=r(t),a=i(o),u=e.utxo;return{prev_index:u.vout,prev_hash:u.txid,amount:u.value.integerValue().toString(),address_n:o,script_type:a}}));return function(t,n){return e.apply(this,arguments)}}(),e.buildHardwareOutput=function(){var e=c()((function*(e){var t=e.payload||{},n=t.isCharge,r=t.bip44Path;if(n&&r){var i=yield Object(b.a)(),o=i.getHDPath,a=i.getOutputScriptType,u=o(r);return{script_type:a(u),address_n:u,amount:e.value.integerValue().toString()}}return{script_type:"PAYTOADDRESS",address:e.address,amount:e.value.integerValue().toString()}}));return function(t){return e.apply(this,arguments)}}(),e.buildPrevTx=function(e){var t=g.Transaction.fromHex(e);return{hash:t.getId(),version:t.version,inputs:t.ins.map((function(e){return{prev_hash:e.hash.reverse().toString("hex"),prev_index:e.index,script_sig:e.script.toString("hex"),sequence:e.sequence}})),bin_outputs:t.outs.map((function(e){return{amount:e.value,script_pubkey:e.script.toString("hex")}})),lock_time:t.locktime}},e}var r=n.prototype;return r.signTransaction=function(){var e=c()((function*(e){var t=this,n=this.vault.getCoinName(),r=e.inputs.map((function(e){return e.address})),i=yield this.vault.collectUTXOs(),o={};for(var a of i){var u=a.address,s=a.path;r.includes(u)&&(o[u]=s)}var d=yield this.vault.getProvider(),f=e.inputs,l=e.outputs,p=Array.from(new Set(f.map((function(e){return e.utxo.txid})))),h=yield d.collectTxs(p),v=yield this.getHardwareInfo(),y=v.connectId,m=v.deviceId,P=yield this.getWalletPassphraseState();yield this.getHardwareSDKInstance();var x=yield b.b.btcSignTransaction(y,m,I({coin:n.toLowerCase(),inputs:yield Promise.all(f.map(function(){var e=c()((function*(e){return t.buildHardwareInput(e,o[e.address])}));return function(t){return e.apply(this,arguments)}}())),outputs:yield Promise.all(l.map(function(){var e=c()((function*(e){return t.buildHardwareOutput(e)}));return function(t){return e.apply(this,arguments)}}())),refTxs:Object.values(h).map((function(e){return t.buildPrevTx(e)}))},P));if(x.success){var T=x.payload.serializedTx;return{txid:g.Transaction.fromHex(T).getId(),rawTx:T}}throw Object(w.a)(x.payload)}));return function(t){return e.apply(this,arguments)}}(),r.prepareAccounts=function(){var e=c()((function*(e){var t,n=e.indexes,r=e.purpose,o=e.names,a=e.template,u=yield this.getNetworkImpl(),c=this.vault,s=c.getDefaultPurpose(),d=c.getCoinName(),f=c.getCoinType(),l=r||s,p=0!==n[0],h=[].concat(i()(p?[n[0]-1]:[]),i()(n)),v=Object(A.a)(l,d).addressEncoding,y=Object(T.b)(u,a).prefix,g=yield this.vault.getProvider();try{var k=yield this.getHardwareInfo(),E=k.connectId,H=k.deviceId,S=yield this.getWalletPassphraseState();yield this.getHardwareSDKInstance();var B=Object(x.g)(a).pathPrefix;t=yield b.b.btcGetPublicKey(E,H,I({bundle:h.map((function(e){return{path:B+"/"+e+"'",coin:d.toLowerCase(),showOnOneKey:!1}}))},S))}catch(M){throw new P.p(M)}if(!t.success||!t.payload)throw Object(w.a)(t.payload);if(t.payload.length!==h.length)throw new P.q("Unable to get publick key.");var C=[],j=0;for(var D of t.payload){var R,N=D.path,K=D.xpub,F=D.xpubSegwit,U=g.xpubToAddresses(K,["0/0"],v)["0/0"],V=[m.k,m.g].includes(f)?d:y,_=(o||[])[j]||V+" #"+(h[j]+1);if(!p||j>0)C.push({id:this.walletId+"--"+N,name:_,type:O.b.UTXO,path:N,coinType:f,xpub:K,xpubSegwit:F||K,address:U,addresses:(R={},R["0/0"]=U,R),template:a});if(1===h.length)break;if(!((yield g.getAccount({type:"simple",xpub:F||K},v)).txs>0))break;j+=1,yield new Promise((function(e){return setTimeout(e,200)}))}return C}));return function(t){return e.apply(this,arguments)}}(),r.getAddress=function(){var e=c()((function*(e){var t=this.vault.getCoinName(),n=yield this.getDbAccount({noCache:!0}),r=n.addresses,i=n.address,o=n.path,a=Object.keys(n.addresses).find((function(e){return r[e]===i}));if(!a)return"";yield this.getHardwareSDKInstance();var u=yield this.getHardwareInfo(),c=u.connectId,s=u.deviceId,d=yield this.getWalletPassphraseState(),f=yield b.b.btcGetAddress(c,s,I({path:o+"/"+a,showOnOneKey:e.showOnOneKey,coin:t.toLowerCase()},d));if(f.success)return f.payload.address;throw Object(w.a)(f.payload)}));return function(t){return e.apply(this,arguments)}}(),r.signMessage=function(){throw new P.l},d()(n)}(k.a)},3386:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return S}));var r=n(16),i=n.n(r),o=n(10),a=n.n(o),u=n(3),c=n.n(u),s=n(6),d=n.n(s),f=n(9),l=n.n(f),p=n(12),h=n.n(p),v=n(5),y=n.n(v),g=n(3101),w=n.n(g),b=n(428),m=n(11),P=n(20),x=n(19),T=n(310),O=n(184),k=n(950),A=n(89),E=n(3095),I=n(3350);function H(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var S=function(t){l()(r,t);var n=H(r);function r(){return n.apply(this,arguments)}var o=r.prototype;return o.signTransaction=function(){var e=c()((function*(e,t){var n=t.password;if("undefined"===typeof n)throw new x.q("Software signing requires a password.");var r=yield this.getSigners(n,e.inputs.map((function(e){return e.address})));return P.a.engine.info("signTransaction",this.networkId,e),(yield this.vault.getProvider()).signTransaction(e,r)}));return function(t,n){return e.apply(this,arguments)}}(),o.getSigners=function(){var e=c()((function*(e,t){var n={},r=yield this.vault.collectUTXOs();for(var i of r){var o=i.address,u=i.path;t.includes(o)&&(n[u]=o)}var c=Object.keys(n).map((function(e){return e.split("/").slice(-2).join("/")}));if(0===c.length)throw new x.q("No signers would be chosen.");var s=yield this.getPrivateKeys(e,c),d={};for(var f of Object.entries(s)){var l=a()(f,2),p=l[0],h=l[1];d[n[p]]=new k.b(h,e,"secp256k1")}return d}));return function(t,n){return e.apply(this,arguments)}}(),o.prepareAccounts=function(){var t=c()((function*(t){var n=t.password,r=t.indexes,o=t.purpose,a=t.names,u=t.template,c=yield this.getNetworkImpl(),s=this.vault,d=s.getDefaultPurpose(),f=s.getCoinName(),l=s.getCoinType(),p=o||d,h=0!==r[0],v=[].concat(i()(h?[r[0]-1]:[]),i()(r)),y=Object(I.a)(p,f).addressEncoding,g=Object(O.b)(c,u).prefix,P=(yield this.engine.dbApi.getCredential(this.walletId,n)).seed,k=yield this.vault.getProvider(),E=k.network,H=Object(T.g)(u).pathPrefix,S=Object(b.d)("secp256k1",P,n,H,v.map((function(e){return e.toString()+"'"})));if(S.length!==v.length)throw new x.q("Unable to get publick key.");var B=((E.segwitVersionBytes||{})[y]||E.bip32).public,C=[],j=0;for(var D of S){var R,N=D.path,K=D.parentFingerPrint,F=D.extendedKey,U=w.a.encode(e.concat([e.from(B.toString(16).padStart(8,"0"),"hex"),e.from([3]),K,e.from((v[j]+2**31).toString(16).padStart(8,"0"),"hex"),F.chainCode,F.key])),V=k.xpubToAddresses(U,["0/0"],y)["0/0"],_=[m.k,m.g].includes(l)?f:g,M=(a||[])[j]||_+" #"+(v[j]+1);if(!h||j>0)C.push({id:this.walletId+"--"+N,name:M,type:A.b.UTXO,path:N,coinType:l,xpub:U,address:V,addresses:(R={},R["0/0"]=V,R),template:u});if(1===v.length)break;if(!((yield k.getAccount({type:"simple",xpub:U},y)).txs>0))break;j+=1,yield new Promise((function(e){return setTimeout(e,200)}))}return C}));return function(e){return t.apply(this,arguments)}}(),d()(r)}(E.a)}).call(this,n(22).Buffer)},3387:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return H}));var r=n(16),i=n.n(r),o=n(10),a=n.n(o),u=n(3),c=n.n(u),s=n(6),d=n.n(s),f=n(9),l=n.n(f),p=n(12),h=n.n(p),v=n(5),y=n.n(v),g=n(3101),w=n.n(g),b=n(623),m=n(514),P=n(117),x=n(20),T=n(19),O=n(950),k=n(89),A=n(3096);function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var I=new b.a(e.from("Bitcoin seed"),m.c),H=function(t){l()(r,t);var n=E(r);function r(){return n.apply(this,arguments)}var o=r.prototype;return o.signTransaction=function(){var e=c()((function*(e,t){var n=t.password;if("undefined"===typeof n)throw new T.q("Software signing requires a password.");var r=yield this.getSigners(n,e.inputs.map((function(e){return e.address})));return x.a.engine.info("signTransaction",this.networkId,e),(yield this.vault.getProvider()).signTransaction(e,r)}));return function(t,n){return e.apply(this,arguments)}}(),o.getSigners=function(){var e=c()((function*(e,t){var n={},r=yield this.vault.collectUTXOs();for(var i of r){var o=i.address,u=i.path;if(t.includes(o)){var c=u.split("/").slice(-2).join("/");n[c]=o}}var s=Object.keys(n);if(0===s.length)throw new T.q("No signers would be chosen.");var d={},f={},l=Object.values(yield this.getPrivateKeys(e)),p=a()(l,1)[0],h=Object(P.a)(e,p),v={chainCode:h.slice(13,45),key:h.slice(46,78)};return s.forEach((function(t){var r=t.split("/"),i="",o=v;r.forEach((function(e){if(i=i.length>0?i+"/"+e:e,"undefined"===typeof f[i]){var t=e.endsWith("'")?parseInt(e.slice(0,-1))+2**31:parseInt(e),n=I.CKDPriv(o,t);f[i]=n}o=f[i]}));var a=n[t];d[a]=new O.b(Object(P.b)(e,f[t].key),e,"secp256k1")})),d}));return function(t,n){return e.apply(this,arguments)}}(),o.prepareAccounts=function(){var t=c()((function*(t){var n,r=t.privateKey,o=t.name,a=yield this.vault.getProvider(),u=this.vault.getCoinType(),c="",s=a.network,d=parseInt(r.slice(0,4).toString("hex"),16);for(var f of[].concat(i()(Object.values(s.segwitVersionBytes||{})),[s.bip32]))if(f.private===d){var l=m.c.publicFromPrivate(r.slice(46,78)),p=e.from(f.public.toString(16).padStart(8,"0"),"hex");try{c=w.a.encode(r.fill(p,0,4).fill(l,45,78))}catch(v){}}if(""===c)throw new T.q("Invalid private key.");var h=a.xpubToAddresses(c,["0/0"])["0/0"];return Promise.resolve([{id:"imported--"+u+"--"+c,name:o||"",type:k.b.UTXO,path:"",coinType:u,xpub:c,address:h,addresses:(n={},n["0/0"]=h,n)}])}));return function(e){return t.apply(this,arguments)}}(),d()(r)}(A.a)}).call(this,n(22).Buffer)},3388:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(3),i=n.n(r),o=n(6),a=n.n(o),u=n(9),c=n.n(u),s=n(12),d=n.n(s),f=n(5),l=n.n(f),p=n(19),h=n(89);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l()(e);if(t){var i=l()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var y=function(e){c()(n,e);var t=v(n);function n(){return t.apply(this,arguments)}return n.prototype.prepareAccounts=function(){var e=i()((function*(e){var t,n=e.target,r=e.name,i=e.accountIdPrefix,o=yield this.vault.getProvider(),a=this.vault.getCoinType();if(!o.isValidXpub(n))throw new p.f;var u=o.xpubToAddresses(n,["0/0"])["0/0"];return[{id:i+"--"+a+"--"+n,name:r||"",type:h.b.UTXO,path:"",coinType:a,xpub:n,address:u,addresses:(t={},t["0/0"]=u,t)}]}));return function(t){return e.apply(this,arguments)}}(),a()(n)}(n(3097).a)},3454:function(e,t,n){"use strict";n(693);var r=n(3820);n.d(t,"a",(function(){return r.a}))},3593:function(e,t,n){"use strict";(function(e){var r=n(480),i=n(567),o=n(219),a=n(3349);o.utils.sha256Sync=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.map((function(t){return e.isBuffer(t)?t:e.from(t)}));return a.crypto.sha256(e.concat(i))},o.utils.hmacSha256Sync=function(t){for(var n=r.hmac.create(i.sha256,e.from(t)),o=arguments.length,a=new Array(o>1?o-1:0),u=1;u<o;u++)a[u-1]=arguments[u];return a.forEach((function(e){return n.update(e)})),Uint8Array.from(n.digest())};var u=o.utils._normalizePrivateKey;function c(e){if("string"!==typeof e)throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt("0x"+e)}function s(e){var t,n;if("bigint"===typeof e)t=e;else if("number"===typeof e&&Number.isSafeInteger(e)&&e>=0)t=BigInt(e);else if("string"===typeof e){if(64!==e.length)throw new Error("Expected 32 bytes of private scalar");t=c(e)}else{if(!(e instanceof Uint8Array))throw new TypeError("Expected valid private scalar");if(32!==e.length)throw new Error("Expected 32 bytes of private scalar");n=e,t=c(o.utils.bytesToHex(n))}if(t<0)throw new Error("Expected private scalar >= 0");return t}var d=function(e,t,n){var r=o.Point.fromHex(e),i=s(t),a=o.Point.BASE.multiplyAndAddUnsafe(r,i,1n);if(!a)throw new Error("Tweaked point at infinity");return a.toRawBytes(n)},f=function(e){return!1!==e};function l(e){try{return e()}catch(t){return null}}function p(e,t){if(32===e.length!==t)return!1;try{return!!o.Point.fromHex(e)}catch(n){return!1}}var h={isPoint:function(e){return p(e,!1)},isPrivate:function(e){return o.utils.isValidPrivateKey(e)},isXOnlyPoint:function(e){return p(e,!0)},xOnlyPointAddTweak:function(e,t){return l((function(){var n=d(e,t,!0);return{parity:n[0]%2===1?1:0,xOnlyPubkey:n.slice(1)}}))},pointFromScalar:function(e,t){return l((function(){return o.getPublicKey(e,f(t))}))},pointCompress:function(e,t){return o.Point.fromHex(e).toRawBytes(f(t))},pointMultiply:function(e,t,n){return l((function(){return function(e,t,n){var r=o.Point.fromHex(e),i="string"===typeof t?t:o.utils.bytesToHex(t),a=BigInt("0x"+i);return r.multiply(a).toRawBytes(n)}(e,t,f(n))}))},pointAdd:function(e,t,n){return l((function(){var r=o.Point.fromHex(e),i=o.Point.fromHex(t);return r.add(i).toRawBytes(f(n))}))},pointAddScalar:function(e,t,n){return l((function(){return d(e,t,f(n))}))},privateAdd:function(e,t){return l((function(){return function(e,t){var n=u(e),r=s(t),i=o.utils._bigintTo32Bytes(o.utils.mod(n+r,o.CURVE.n));return o.utils.isValidPrivateKey(i)?i:null}(e,t)}))},privateNegate:function(e){return function(e){var t=u(e),n=o.utils._bigintTo32Bytes(o.CURVE.n-t);return o.utils.isValidPrivateKey(n)?n:null}(e)},sign:function(e,t,n){return o.signSync(e,t,{der:!1,extraEntropy:n})},signSchnorr:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.alloc(32,0);return o.schnorr.signSync(t,n,r)},verify:function(e,t,n,r){return o.verify(n,e,t,{strict:r})},verifySchnorr:function(e,t,n){return o.schnorr.verifySync(n,e,t)}};t.a=h}).call(this,n(22).Buffer)},3820:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return C}));var r=n(16),i=n.n(r),o=n(10),a=n.n(o),u=n(2),c=n.n(u),s=n(3),d=n.n(s),f=n(6),l=n.n(f),p=n(26),h=n.n(p),v=n(3349),y=n(3101),g=n.n(y),w=n(126),b=n.n(w),m=n(428),P=n(773),x=n(3350),T=n(693),O=n(4213),k=n(3593),A=n(4214);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var H=function(e,t){if(!e)throw t||"Invalid statement",t instanceof Error?t:new Error(t)},S=function(e,t){return H("undefined"!==typeof e,t||"Expect defined but actually undefined"),e},B=function(e,t,n){return Object(m.j)("secp256k1",e,t,n)};v.initEccLib(k.a);var C=function(){function t(e){var t=this;this.getUTXOs=b()(function(){var e=d()((function*(e){return t.blockbook.then((function(t){return t.getUTXOs(e)}))}));return function(t){return e.apply(this,arguments)}}(),{promise:!0,max:1,maxAge:3e4}),this.chainInfo=e}var n=t.prototype;return n.decodeAddress=function(e){return e},n.encodeAddress=function(e){return e},n.xpubToAddresses=function(e,t,n){var r=g.a.decode(e),i=parseInt(r.slice(0,4).toString("hex"),16),o=null!=n?n:this.versionBytesToEncodings.public[i][0],a={},u={chainCode:r.slice(13,45),key:r.slice(45,78)},c=new Map;for(var s of t){var d=u,f="",l=s.split("/");for(var p of l)if(f+=""===f?p:"/"+p,c.has(f))d=c.get(f);else{var h=p.endsWith("'")?parseInt(p.slice(0,-1))+2**31:parseInt(p);d=Object(m.a)("secp256k1",d,h),c.set(f,d)}var v=this.pubkeyToPayment(d.key,o).address;"string"===typeof v&&v.length>0&&(v=this.encodeAddress(v),a[s]=v)}return a},n.pubkeyToPayment=function(e,t){var n={pubkey:e,network:this.network};switch(t){case P.a.P2PKH:n=v.payments.p2pkh(n);break;case P.a.P2WPKH:n=v.payments.p2wpkh(n);break;case P.a.P2SH_P2WPKH:n=v.payments.p2sh({redeem:v.payments.p2wpkh(n),network:this.network});break;case P.a.P2TR:n=v.payments.p2tr({internalPubkey:e.slice(1,33),network:this.network});break;default:throw new Error("Invalid encoding: "+t)}return n},n.parseAddressEncodings=function(e){var t=this;return Promise.all(e.map((function(e){return t.verifyAddress(e)}))).then((function(e){return e.filter((function(e){return e.isValid})).map((function(e){return e.encoding}))}))},n.getAccount=function(e,t){var n=this.getEncodingXpub(e,t),r={};switch(e.type){case"simple":r={details:"basic"};break;case"details":r={details:"tokenBalances",tokens:"derived"};break;case"history":r={details:"txs",pageSize:50,to:e.to}}return this.blockbook.then((function(e){return e.getAccount(n,r)}))},n.getEncodingXpub=function(e,t){var n=t;if(Object(x.d)(e.xpub))n=P.a.P2TR;else{var r=g.a.decode(e.xpub);H(this.isValidXpub(r));var i=parseInt(r.slice(0,4).toString("hex"),16);n=null!=t?t:this.versionBytesToEncodings.public[i][0]}H("undefined"!==typeof n);var o=e.xpub;switch(n){case P.a.P2PKH:o="pkh("+e.xpub+")";break;case P.a.P2SH_P2WPKH:o="sh(wpkh("+e.xpub+"))";break;case P.a.P2WPKH:o="wpkh("+e.xpub+")";break;case P.a.P2TR:o=e.xpub}return o},n.getHistory=function(e,t,n,r,i){var o=this.getEncodingXpub(e);return this.blockbook.then((function(e){return e.getHistory(t,n,o,r,i)}))},n.isValidXpub=function(e){return this.isValidExtendedKey(e,"pub")},n.isValidXprv=function(e){return this.isValidExtendedKey(e,"prv")},n.isValidExtendedKey=function(e,t){var n="string"===typeof e?g.a.decode(e):e;if(78!==n.length)return!1;var r=parseInt(n.slice(0,4).toString("hex"),16);return"pub"===t?"undefined"!==typeof this.versionBytesToEncodings.public[r]:"undefined"!==typeof this.versionBytesToEncodings.private[r]},n.verifyAddress=function(e){var t,n=this.decodeAddress(e);try{var r=v.address.fromBase58Check(n);r.version===this.network.pubKeyHash&&20===r.hash.length?t=P.a.P2PKH:r.version===this.network.scriptHash&&20===r.hash.length&&(t=P.a.P2SH_P2WPKH)}catch(o){try{var i=v.address.fromBech32(n);0===i.version&&i.prefix===this.network.bech32&&20===i.data.length?t=P.a.P2WPKH:1===i.version&&i.prefix===this.network.bech32&&32===i.data.length&&(t=P.a.P2TR)}catch(a){}}return t?{displayAddress:n,normalizedAddress:n,encoding:t,isValid:!0}:{isValid:!1}},n.buildUnsignedTx=function(){var e=d()((function*(e){var t=e.inputs,n=e.outputs,r=e.payload.opReturn,i=e.feeLimit,o=e.feePricePerUnit;if(t.length>0&&n.length>0){var a=yield this.parseAddressEncodings(t.map((function(e){return e.address}))),u=yield this.parseAddressEncodings(n.map((function(e){return e.address})));if(a.length===t.length&&u.length===n.length){var c=Object(A.b)(a,u,r);i=i&&i.gte(c)?i:new h.a(c)}}return i=i||new h.a(A.a),I(I({},e),{},{feeLimit:i,feePricePerUnit:o})}));return function(t){return e.apply(this,arguments)}}(),n.getBalances=function(e){return this.blockbook.then((function(t){return Promise.all(e.map((function(e){var n=e.address;return t.getBalance(n)})))}))},n.getPsbt=function(){return new v.Psbt({network:this.network})},n.getBitcoinSigner=function(){var e=d()((function*(e,t){return{publicKey:yield e.getPubkey(!0),sign:function(){var t=d()((function*(t){var n=yield e.sign(t);return a()(n,1)[0]}));return function(e){return t.apply(this,arguments)}}()}}));return function(t,n){return e.apply(this,arguments)}}(),n.signTransaction=function(){var e=d()((function*(e,t){for(var n=yield this.packTransaction(e,t),r=0;r<e.inputs.length;++r){var i=t[e.inputs[r].address],o=n.data.inputs[0],a=yield this.getBitcoinSigner(i,o);yield n.signInputAsync(r,a)}n.validateSignaturesOfAllInputs(B),n.finalizeAllInputs();var u=n.extractTransaction();return{txid:u.getId(),rawTx:u.toHex()}}));return function(t,n){return e.apply(this,arguments)}}(),n.packTransaction=function(){var t=d()((function*(t,n){for(var r=t.inputs,i=t.outputs,o=t.payload.opReturn,u=yield this.collectInfoForSoftwareSign(t),c=a()(u,2),s=c[0],d=c[1],f=this.getPsbt(),l=0;l<r.length;++l){var p=r[l],h=p.utxo;H(h);var y=s[l],g={};switch(y){case P.a.P2PKH:g.nonWitnessUtxo=e.from(d[h.txid],"hex");break;case P.a.P2WPKH:g.witnessUtxo={script:S(this.pubkeyToPayment(yield n[p.address].getPubkey(!0),y)).output,value:h.value.integerValue().toNumber()};break;case P.a.P2SH_P2WPKH:var w,b=S(this.pubkeyToPayment(yield n[p.address].getPubkey(!0),y));g.witnessUtxo={script:b.output,value:h.value.integerValue().toNumber()},g.redeemScript=null==(w=b.redeem)?void 0:w.output;break;case P.a.P2TR:var m=S(this.pubkeyToPayment(yield n[p.address].getPubkey(!0),y));g.witnessUtxo={script:m.output,value:h.value.integerValue().toNumber()},g.tapInternalKey=m.internalPubkey}f.addInput(I({hash:h.txid,index:h.vout},g))}if(i.forEach((function(e){f.addOutput({address:e.address,value:e.value.integerValue().toNumber()})})),"string"===typeof o){var x=v.payments.embed({data:[Object(A.c)(o)]});f.addOutput({script:S(x.output),value:0})}return f}));return function(e,n){return t.apply(this,arguments)}}(),n.collectInfoForSoftwareSign=function(){var e=d()((function*(e){var t=e.inputs,n=yield this.parseAddressEncodings(t.map((function(e){return e.address})));H(n.length===t.length,"Found invalid address from inputs");var r=Array.from(new Set(n.map((function(e,n){if(e===P.a.P2PKH)return S(t[n].utxo).txid})).filter((function(e){return!!e}))));return[n,yield this.collectTxs(r)]}));return function(t){return e.apply(this,arguments)}}(),n.collectTxs=function(){var e=d()((function*(e){for(var t=yield this.blockbook,n={},r=function*(r,i){var o=e.slice(r,r+i),a=yield Promise.all(o.map((function(e){return t.getRawTransaction(e)})));o.forEach((function(e,t){return n[e]=a[t]}))},i=0;i<e.length;i+=5)yield*r(i,5);return n}));return function(t){return e.apply(this,arguments)}}(),n.broadcastTransaction=function(e){return this.blockbook.then((function(t){return t.broadcastTransaction(e)}))},n.getTransactionStatuses=function(e){return this.blockbook.then((function(t){return t.getTransactionStatuses(e)}))},l()(t,[{key:"network",get:function(){return Object(O.a)(this.chainInfo.code)}},{key:"blockbook",get:function(){return Object(T.b)(this.chainInfo)}},{key:"versionBytesToEncodings",get:function(){if("undefined"===typeof this._versionBytesToEncodings){var e,t,n=this.network,r={public:(e={},e[n.bip32.public]=[P.a.P2PKH],e),private:(t={},t[n.bip32.private]=[P.a.P2PKH],t)};Object.entries(n.segwitVersionBytes||{}).forEach((function(e){var t=a()(e,2),n=t[0],o=t[1],u=o.public,c=o.private;r.public[u]=[].concat(i()(r.public[u]||[]),[n]),r.private[c]=[].concat(i()(r.private[c]||[]),[n])})),this._versionBytesToEncodings=r}return this._versionBytesToEncodings}}]),t}()}).call(this,n(22).Buffer)},4213:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r,i,o,a,u=n(2),c=n.n(u),s=n(3349),d=(n(3099),n(773));function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128,forkId:0},h={btc:l(l({},s.networks.bitcoin),{},{segwitVersionBytes:(r={},r[d.a.P2SH_P2WPKH]={public:77429938,private:77428856},r[d.a.P2WPKH]={public:78792518,private:78791436},r[d.a.P2TR]={public:76067358,private:76066276},r)}),tbtc:l(l({},s.networks.testnet),{},{segwitVersionBytes:(i={},i[d.a.P2SH_P2WPKH]={public:71979618,private:71978536},i[d.a.P2WPKH]={public:73342198,private:73341116},i[d.a.P2TR]={public:70617039,private:70615956},i)}),rbtc:l(l({},s.networks.regtest),{},{segwitVersionBytes:(o={},o[d.a.P2SH_P2WPKH]={public:71979618,private:71978536},o[d.a.P2WPKH]={public:73342198,private:73341116},o)}),ltc:{messagePrefix:"\x19Litecoin Signed Message:\n",bech32:"ltc",bip32:{public:27108450,private:27106558},segwitVersionBytes:(a={},a[d.a.P2SH_P2WPKH]={public:28471030,private:28469138},a[d.a.P2WPKH]={public:78792518,private:78791436},a),pubKeyHash:48,scriptHash:50,wif:176},bch:p,doge:{messagePrefix:"\x19Dogecoin Signed Message:\n",bech32:"",bip32:{public:49990397,private:49988504},pubKeyHash:30,scriptHash:22,wif:158},btg:{messagePrefix:"\x1dBitcoin Gold Signed Message:\n",bech32:"btg",bip32:{public:76067358,private:76066276},pubKeyHash:38,scriptHash:23,wif:128},dgb:{messagePrefix:"\x19DigiByte Signed Message:\n",bech32:"dgb",bip32:{public:76067358,private:76066276},pubKeyHash:30,scriptHash:63,wif:176},nmc:{messagePrefix:"\x19Namecoin Signed Message:\n",bech32:"",bip32:{public:76067358,private:76066276},pubKeyHash:52,scriptHash:5,wif:128},vtc:{messagePrefix:"\x19Vertcoin Signed Message:\n",bech32:"vtc",bip32:{public:76067358,private:76066276},pubKeyHash:71,scriptHash:5,wif:128},dash:{messagePrefix:"\x19DarkCoin Signed Message:\n",bech32:"",bip32:{public:50221772,private:50221816},pubKeyHash:76,scriptHash:16,wif:204}},v=function(e){var t=h[e];if("undefined"===typeof t)throw new Error("Network not found. chainCode: "+e);return t}},4214:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}));var r={P2PKH:148,P2WPKH:68,P2SH_P2WPKH:91},i={P2PKH:34,P2WPKH:31,P2SH_P2WPKH:32},o=79,a=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:80,r=e.from(t);return r.slice(0,n)},u=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:80,u=10,c=e.filter((function(e){return e.includes("P2WPKH")})).length>=1;if(c&&(u+=.5),u+=e.map((function(e){return r[e]||0})).reduce((function(e,t){return e+t}),0),c&&(u+=.25),u+=t.map((function(e){return i[e]||0})).reduce((function(e,t){return e+t}),0),"string"===typeof n){var s=a(n,o).length;u+=12*Math.ceil(s/o),u+=s}return Math.ceil(u)}}).call(this,n(22).Buffer)}}]);