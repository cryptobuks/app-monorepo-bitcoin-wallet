(this.webpackJsonp=this.webpackJsonp||[]).push([[63],{3071:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(3),o=n.n(r),i=n(6),a=n.n(i),c=n(9),u=n.n(c),s=n(12),d=n.n(s),f=n(5),l=n.n(f);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l()(e);if(t){var o=l()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var y=function(e){u()(n,e);var t=p(n);function n(e){var n;return(n=t.call(this,e.options)).vault=e,n}return n.prototype.addressFromBase=function(){var e=o()((function*(e){return this.vault.addressFromBase(e)}));return function(t){return e.apply(this,arguments)}}(),a()(n)}(n(1147).a);!function(e){u()(n,e);var t=p(n);function n(){return t.apply(this,arguments)}a()(n)}(y)},3077:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var r=n(10),o=n.n(r),i=n(2),a=n.n(i),c=n(3),u=n.n(c),s=n(6),d=n.n(s),f=n(9),l=n.n(f),p=n(12),y=n.n(p),h=n(5),v=n.n(h),g=n(20),w=n(19);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var o=v()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return y()(this,n)}}var T=function(e){l()(n,e);var t=x(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=u()((function*(e,t){var n=t.password;if("undefined"===typeof n)throw new w.q("Software signing requires a password.");var r=yield this.getSigners(n,e.inputs.map((function(e){return e.address})));return g.a.engine.info("signTransaction",this.networkId,e),b(b({},yield this.engine.providerManager.signTransaction(this.networkId,e,r)),{},{encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=u()((function*(e,t){var n=this,r=t.password;if("undefined"===typeof r)throw new w.q("Software signing requires a password.");var i=yield this.getDbAccount(),a=Object.values(yield this.getSigners(r,[i.address])),c=o()(a,1)[0];return g.a.engine.info("signMessage",this.networkId,e),Promise.all(e.map((function(e){return n.engine.providerManager.signMessage(n.networkId,e,c)})))}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},d()(n)}(n(3071).a)},3093:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return D}));var r=n(2),o=n.n(r),i=n(146),a=n.n(i),c=n(3),u=n.n(c),s=n(6),d=n.n(s),f=n(9),l=n.n(f),p=n(12),y=n.n(p),h=n(5),v=n.n(h),g=n(26),w=n.n(g),m=n(11),b=n(20),x=n(14),T=n(53),O=n(19),I=n(184),A=n(658),P=n(56),E=n(1147);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var o=v()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return y()(this,n)}}if(x.a.isExtensionUi)throw new Error("engine/VaultBase is not allowed imported from ui");var D=function(t){l()(r,t);var n=S(r);function r(){return n.apply(this,arguments)}var o=r.prototype;return o.init=function(){var e=u()((function*(e){yield this.initProvider(),yield this.initKeyring(e)}));return function(t){return e.apply(this,arguments)}}(),o.initKeyring=function(){var e=u()((function*(e){this.keyring=yield e.keyringCreator(this)}));return function(t){return e.apply(this,arguments)}}(),o.signTransaction=function(){var e=u()((function*(e,t){return this.keyring.signTransaction(e,t)}));return function(t,n){return e.apply(this,arguments)}}(),o.signAndSendTransaction=function(){var e=u()((function*(e,t,n){var r=yield this.signTransaction(e,t);return n?C(C({},r),{},{encodedTx:e.encodedTx}):this.broadcastTransaction(C(C({},r),{},{encodedTx:e.encodedTx}))}));return function(t,n,r){return e.apply(this,arguments)}}(),o.broadcastTransaction=function(){var e=u()((function*(e,t){b.a.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var n=yield this.engine.providerManager.broadcastTransaction(this.networkId,e.rawTx,t);return b.a.engine.info("broadcastTransaction END:",{txid:n,rawTx:e.rawTx}),C(C({},e),{},{txid:n,encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),o.buildEncodedTxFromBatchTransfer=function(){var e=u()((function*(e,t,n){throw new O.l}));return function(t,n,r){return e.apply(this,arguments)}}(),o.buildEncodedTxsFromSetApproveForAll=function(){var e=u()((function*(e,t){throw new O.l}));return function(t,n){return e.apply(this,arguments)}}(),o.activateAccount=function(){var e=u()((function*(){throw new O.l}));return function(){return e.apply(this,arguments)}}(),o.activateToken=function(){var e=u()((function*(e,t){throw new O.l}));return function(t,n){return e.apply(this,arguments)}}(),o.getTokenAllowance=function(){var e=u()((function*(e,t){throw new O.l}));return function(t,n){return e.apply(this,arguments)}}(),o.batchTokensAllowance=function(){var e=u()((function*(e,t){throw new O.l}));return function(t,n){return e.apply(this,arguments)}}(),o.getOutputAccount=function(){var e=u()((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address}}));return function(){return e.apply(this,arguments)}}(),o.getAccountBalance=function(){var e=u()((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=yield this.getDbAccount(),o=r.address;return this.getBalances((t?[{address:o}]:[]).concat(e.map((function(e){return{address:o,tokenAddress:e}}))),n)}));return function(t){return e.apply(this,arguments)}}(),o.updatePendingTxs=function(){var e=u()((function*(e){throw new O.l}));return function(t){return e.apply(this,arguments)}}(),o.getAccountNonce=function(){var e=u()((function*(){return Promise.resolve(null)}));return function(){return e.apply(this,arguments)}}(),o.fixActionDirection=function(){var e=u()((function*(e){var t,n,r,o,i=e.action,a=e.accountAddress;(i.direction=P.b.OTHER,i.type===P.a.NATIVE_TRANSFER)&&(i.direction=yield this.buildTxActionDirection({from:(null==(t=i.nativeTransfer)?void 0:t.from)||"",to:(null==(n=i.nativeTransfer)?void 0:n.to)||"",address:a}));i.type===P.a.TOKEN_TRANSFER&&(i.direction=yield this.buildTxActionDirection({from:(null==(r=i.tokenTransfer)?void 0:r.from)||"",to:(null==(o=i.tokenTransfer)?void 0:o.to)||"",address:a}));return i}));return function(t){return e.apply(this,arguments)}}(),o.fixDecodedTx=function(){var e=u()((function*(e){var t,n;e.createdAt=null!=(t=e.createdAt)?t:Date.now();var r=null==(n=e.encodedTx)?void 0:n.nonce;e.nonce=a()(r)?e.nonce:new w.a(r).toNumber();for(var o=e.owner,i=0;i<e.actions.length;i+=1){var c=e.actions[i];yield this.fixActionDirection({action:c,accountAddress:o})}if(e.outputActions)for(var u=0;u<e.outputActions.length;u+=1){var s=e.outputActions[u];yield this.fixActionDirection({action:s,accountAddress:o})}return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),o.fixHistoryTx=function(){var e=u()((function*(e){return e.decodedTx=yield this.fixDecodedTx(e.decodedTx),x.a.isDev&&x.a.isDesktop&&Object.assign(e,{_tmpCreatedAtText:new Date(e.decodedTx.createdAt||0).toLocaleString(),_tmpUpdatedAtText:new Date(e.decodedTx.updatedAt||0).toLocaleString(),_tmpStatus:e.decodedTx.status,_tmpIsFinal:e.decodedTx.isFinal}),Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),o.buildHistoryTx=function(){var e=u()((function*(e){var t=e.historyTxToMerge,n=(e.encodedTx,e.decodedTx),r=e.signedTx,o=e.isSigner,i=e.isLocalCreated,a=(null==r?void 0:r.txid)||(null==n?void 0:n.txid)||"";if(!a)throw new Error("buildHistoryTx txid not found");var c=yield this.getAccountAddress();n.txid=a||n.txid,n.owner=c,o&&(n.signer=c),null!=r&&r.txKey&&(n.extraInfo?n.extraInfo.txKey=r.txKey:n.extraInfo={txKey:r.txKey});var u=C(C({id:this.networkId+"_"+a+"_"+this.accountId,isLocalCreated:Boolean(i)},t),{},{decodedTx:n});return u=yield this.fixHistoryTx(u),Promise.resolve(u)}));return function(t){return e.apply(this,arguments)}}(),o.checkIsScamHistoryTx=function(){var e=u()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),o.fetchOnChainHistory=function(){var e=u()((function*(e){throw new O.l}));return function(t){return e.apply(this,arguments)}}(),o.fixAddressCase=function(e){return Promise.resolve(e)},o.buildTxActionDirection=function(){var e=u()((function*(e){var t=e.from,n=e.to,r=e.address;return t=yield this.fixAddressCase(t||""),n=yield this.fixAddressCase(n),r=yield this.fixAddressCase(r),t===n&&t===r?P.b.SELF:t&&t===r?P.b.OUT:n&&n===r?P.b.IN:P.b.OTHER}));return function(t){return e.apply(this,arguments)}}(),o.getNextNonce=function(){var e=u()((function*(e,t){var n,r,o=null!=(n=null==(r=(yield this.engine.providerManager.getAddresses(e,[t.address]))[0])?void 0:r.nonce)?n:0,i=(yield this.engine.getHistory(e,t.id,void 0,!1),yield T.a.history.getMaxPendingNonce({accountId:this.accountId,networkId:e})),c=yield T.a.history.getPendingNonceList({accountId:this.accountId,networkId:e}),u=Math.max(a()(i)?0:i+1,o);if(Number.isNaN(u)&&(u=o),u>o)for(var s=o;s<u;s+=1)if(!c.includes(s)){u=s;break}if(u<o&&(u=o),u-o>=m.y.PENDING_QUEUE_MAX_LENGTH)throw new O.v(m.y.PENDING_QUEUE_MAX_LENGTH);return u}));return function(t,n){return e.apply(this,arguments)}}(),o.validateSendAmount=function(e,t,n){return Promise.resolve(!0)},o.notifyChainChanged=function(e,t){},o.getFetchBalanceAddress=function(e){return Promise.resolve(e.address)},o.getPrivateKeyByCredential=function(t){return Promise.resolve(e.from(t.startsWith("0x")?t.slice(2):t,"hex"))},o.getMinDepositAmount=function(){var e=u()((function*(){return"0"}));return function(){return e.apply(this,arguments)}}(),o.specialCheckEncodedTx=function(){var e=u()((function*(e){return{success:!0}}));return function(t){return e.apply(this,arguments)}}(),d()(r)}(function(e){l()(n,e);var t=S(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.initProvider=function(){var e=u()((function*(){var e=(yield this.getNetwork()).impl;a()(A.a[e])||(this.engineProvider=yield this.engine.providerManager.getProvider(this.networkId))}));return function(){return e.apply(this,arguments)}}(),r.proxyJsonRPCCall=function(){var e=u()((function*(e){throw new O.l}));return function(t){return e.apply(this,arguments)}}(),r.createClientFromURL=function(e){throw new O.l},r.getEthersProvider=function(){var e=u()((function*(){throw new O.l}));return function(){return e.apply(this,arguments)}}(),r.getClientEndpointStatus=function(){var e=u()((function*(e){var t=this.createClientFromURL(e),n=performance.now(),r=(yield t.getInfo()).bestBlockNumber;return{responseTime:Math.floor(performance.now()-n),latestBlock:r}}));return function(t){return e.apply(this,arguments)}}(),r.validateAddress=function(){var e=u()((function*(e){var t=yield this.engineProvider.verifyAddress(e),n=t.normalizedAddress;if(!t.isValid||"undefined"===typeof n)throw new O.f;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.validateImportedCredential=function(e){return Promise.resolve(this.settings.importedAccountEnabled&&/^(0x)?[0-9a-zA-Z]{64}$/.test(e))},r.validateWatchingCredential=function(){var e=u()((function*(e){return Promise.resolve(this.settings.watchingAccountEnabled&&(yield this.engineProvider.verifyAddress(e)).isValid)}));return function(t){return e.apply(this,arguments)}}(),r.validateTokenAddress=function(){var e=u()((function*(e){var t=yield this.engineProvider.verifyTokenAddress(e),n=t.normalizedAddress;if(!t.isValid||"undefined"===typeof n)throw new O.i;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.validateCanCreateNextAccount=function(){var e=u()((function*(e,t){return Promise.resolve(!0)}));return function(t,n){return e.apply(this,arguments)}}(),r.checkAccountExistence=function(){var e=u()((function*(e){return Promise.resolve(!0)}));return function(t){return e.apply(this,arguments)}}(),r.getBalances=function(){var e=u()((function*(e,t){return(yield this.engine.providerManager.getClient(this.networkId)).getBalances(e.map((function(e){var t=e.address,n=e.tokenAddress;return{address:t,coin:C({},"string"===typeof n?{tokenAddress:n}:{})}})))}));return function(t,n){return e.apply(this,arguments)}}(),r.getFrozenBalance=function(){var e=u()((function*(e){return 0}));return function(t){return e.apply(this,arguments)}}(),r.getTransactionStatuses=function(e){return this.engine.providerManager.getTransactionStatuses(this.networkId,e)},r.getTransactionFeeInNative=function(e){return Promise.resolve("")},r.isContractAddress=function(){var e=u()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),r.getAccountNameInfoMap=function(){var e=u()((function*(){var e=yield this.getNetwork();return Object(I.a)(e.impl)}));return function(){return e.apply(this,arguments)}}(),r.canAutoCreateNextAccount=function(){var e=u()((function*(e){return Promise.resolve(!1)}));return function(t){return e.apply(this,arguments)}}(),r.filterAccounts=function(){var e=u()((function*(e){var t=e.accounts;e.networkId;return Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),r.shouldChangeAccountWhenNetworkChanged=function(){var e=u()((function*(e){e.previousNetwork,e.newNetwork,e.activeAccountId;return Promise.resolve({shouldReloadAccountList:!1,shouldChangeActiveAccount:!1})}));return function(t){return e.apply(this,arguments)}}(),r.getAccountNameInfosByImportedOrWatchingCredential=function(){var e=u()((function*(e){return Promise.resolve([])}));return function(t){return e.apply(this,arguments)}}(),d()(n)}(E.a))}).call(this,n(22).Buffer)},3094:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return v}));var r=n(3),o=n.n(r),i=n(6),a=n.n(i),c=n(9),u=n.n(c),s=n(12),d=n.n(s),f=n(5),l=n.n(f),p=n(309),y=n(253);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l()(e);if(t){var o=l()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var v=function(t){u()(r,t);var n=h(r);function r(){return n.apply(this,arguments)}var i=r.prototype;return i.getHardwareInfo=function(){var e=o()((function*(){var e,t,n,r=yield this.engine.getHWDeviceByWalletId(this.vault.walletId);return{connectId:null!=(e=null==r?void 0:r.mac)?e:"",deviceId:null!=(t=null==r?void 0:r.deviceId)?t:"",deviceType:null!=(n=null==r?void 0:r.deviceType)?n:""}}));return function(){return e.apply(this,arguments)}}(),i.getWalletPassphraseState=function(){var e=o()((function*(){var e=yield this.engine.getWallet(this.vault.walletId);return{passphraseState:null==e?void 0:e.passphraseState,useEmptyPassphrase:!Object(y.g)(e)}}));return function(){return e.apply(this,arguments)}}(),i.getHardwareSDKInstance=function(){var t=o()((function*(){var t,n,r,o,i;return null!=(i=yield null==(t=e)||null==(n=t.$backgroundApiProxy)||null==(r=n.backgroundApi)||null==(o=r.serviceHardware)||null==o.getSDKInstance?void 0:o.getSDKInstance())?i:p.b}));return function(){return t.apply(this,arguments)}}(),a()(r)}(n(3071).a)}).call(this,n(40))},3095:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(2),o=n.n(r),i=n(3),a=n.n(i),c=n(6),u=n.n(c),s=n(9),d=n.n(s),f=n(12),l=n.n(f),p=n(5),y=n.n(p),h=n(428),v=n(19);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l()(this,n)}}var b=function(e){d()(n,e);var t=m(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getPrivateKeys=function(){var e=a()((function*(e,t){var n=(yield this.getDbAccount()).path.split("/"),r=t||[n.pop()],o=n.join("/"),i=(yield this.engine.dbApi.getCredential(this.walletId,e)).seed;if("undefined"===typeof i)throw new v.q("Unable to get credential.");var a=(yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId)).curve;return Object(h.c)(a,i,e,o,r).reduce((function(e,t){var n;return w(w({},e),{},((n={})[t.path]=t.extendedKey.key,n))}),{})}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},u()(n)}(n(3077).a)},3096:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(3),o=n.n(r),i=n(6),a=n.n(i),c=n(9),u=n.n(c),s=n(12),d=n.n(s),f=n(5),l=n.n(f),p=n(19);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l()(e);if(t){var o=l()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var h=function(e){u()(n,e);var t=y(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getPrivateKeys=function(){var e=o()((function*(e,t){if("undefined"!==typeof t)throw new p.l("Getting private keys from extended private key");var n=(yield this.engine.dbApi.getCredential(this.accountId,e)).privateKey;if("undefined"===typeof n)throw new p.q("Unable to get credential.");return{"":n}}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},a()(n)}(n(3077).a)},3097:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(3),o=n.n(r),i=n(6),a=n.n(i),c=n(9),u=n.n(c),s=n(12),d=n.n(s),f=n(5),l=n.n(f),p=n(19);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l()(e);if(t){var o=l()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var h=function(e){u()(n,e);var t=y(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=o()((function*(e,t){throw new p.q("signTransaction is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=o()((function*(e,t){throw new p.q("signMessage is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},a()(n)}(n(3071).a)},3098:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(42),o=n(70),i=n(20),a=n(14);function c(e,t){return"string"!==typeof t?null:e===r.HardwareErrorCode.DeviceInitializeFailed&&t.includes("ECONNABORTED")?new o.h({message:t}):t.includes("Bridge network error")?new o.e({message:t}):null}function u(e){var t,n=e||{},u=n.code,s=n.error,d=n.message,f=null!=(t=null!=s?s:d)?t:"Unknown error";if(c(u,f))return c(u,f);switch(i.a.hardwareSDK.info("Device Utils Convert Device Error:",u,f),u){case r.HardwareErrorCode.UnknownError:return new o.H(e);case r.HardwareErrorCode.DeviceFwException:return new o.t(e);case r.HardwareErrorCode.DeviceUnexpectedMode:return"string"===typeof f&&-1!==f.indexOf("ui-device_bootloader_mode")?new o.E(e):new o.H(e);case r.HardwareErrorCode.DeviceCheckDeviceIdError:return new o.m(e);case r.HardwareErrorCode.DeviceNotFound:return new o.k(e);case r.HardwareErrorCode.DeviceUnexpectedBootloaderMode:return new o.E(e);case r.HardwareErrorCode.DeviceInterruptedFromOutside:case r.HardwareErrorCode.DeviceInterruptedFromUser:return new o.K(e);case r.HardwareErrorCode.DeviceNotSupportPassphrase:return new o.F(e);case r.HardwareErrorCode.IFrameLoadFail:return new o.v(e);case r.HardwareErrorCode.IframeTimeout:return new o.w(e);case r.HardwareErrorCode.FirmwareUpdateDownloadFailed:return new o.p(e);case r.HardwareErrorCode.FirmwareUpdateManuallyEnterBoot:return new o.s(e);case r.HardwareErrorCode.FirmwareUpdateAutoEnterBootFailure:return new o.q(e);case r.HardwareErrorCode.FirmwareUpdateLimitOneDevice:return new o.r(e);case r.HardwareErrorCode.CallMethodNeedUpgradeFirmware:return new o.t(e);case r.HardwareErrorCode.NewFirmwareUnRelease:return new o.D(e);case r.HardwareErrorCode.NetworkError:return new o.C(e);case r.HardwareErrorCode.BlePermissionError:return new o.A(e);case r.HardwareErrorCode.BleLocationError:return new o.z({message:f});case r.HardwareErrorCode.BleLocationServicesDisabled:return new o.b({message:f});case r.HardwareErrorCode.BleDeviceNotBonded:return new o.j(e);case r.HardwareErrorCode.BleWriteCharacteristicError:return new o.d(e);case r.HardwareErrorCode.BleScanError:return new o.c({message:f});case r.HardwareErrorCode.BleAlreadyConnected:return new o.a(e);case r.HardwareErrorCode.RuntimeError:return-1!==f.indexOf("EIP712 blind sign is disabled")?new o.G(e):-1!==f.indexOf("Unknown message")||-1!==f.indexOf("Failure_UnexpectedMessage")?new o.I(e):new o.H(e);case r.HardwareErrorCode.PinInvalid:return new o.x(e);case r.HardwareErrorCode.DeviceCheckPassphraseStateError:return new o.y(e);case r.HardwareErrorCode.DeviceOpenedPassphrase:return new o.n(e);case r.HardwareErrorCode.DeviceNotOpenedPassphrase:return new o.l(e);case r.HardwareErrorCode.PinCancelled:case r.HardwareErrorCode.ActionCancelled:return new o.J(e);case r.HardwareErrorCode.BridgeNotInstalled:case o.i.NeedOneKeyBridge:return new o.B(e);case r.HardwareErrorCode.BridgeNetworkError:return new o.e(e);case r.HardwareErrorCode.BridgeTimeoutError:return a.a.isDesktop&&(i.a.hardwareSDK.debug("desktop bridge timeout, restart desktop bridge."),window.desktopApi.reloadBridgeProcess()),new o.f(e);case r.HardwareErrorCode.PollingTimeout:return new o.h(e);case r.HardwareErrorCode.PollingStop:return new o.g(e);case r.HardwareErrorCode.BlindSignDisabled:return new o.G(e);default:return new o.H(e)}}},3351:function(e,t,n){"use strict";var r=n(4312);t.a=r},3618:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d}));var r=n(10),o=n.n(r),i=n(3),a=n.n(i),c=n(3351);function u(e,t){return s.apply(this,arguments)}function s(){return(s=a()((function*(t,n){var r=t.payload.encodedTx,i=c.a.Transaction.from_obj_for_encoding(c.a.decodeObj(e.from(r,"base64"))),a=yield n.sign(i.bytesToSign()),u=o()(a,1)[0];return{txid:i.txID(),rawTx:e.from(c.a.encodeObj({sig:u,txn:i.get_obj_for_encoding()})).toString("base64")}}))).apply(this,arguments)}function d(t){return e.from(t.toByte()).toString("base64")}}).call(this,n(22).Buffer)},4311:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return P}));var r=n(2),o=n.n(r),i=n(3),a=n.n(i),c=n(6),u=n.n(c),s=n(9),d=n.n(s),f=n(12),l=n.n(f),p=n(5),y=n.n(p),h=n(3098),v=n(11),g=n(20),w=n(19),m=n(89),b=n(3094),x=n(3351);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l()(this,n)}}var A="m/44'/"+v.e+"'/0'/0'",P=function(t){d()(r,t);var n=I(r);function r(){return n.apply(this,arguments)}var o=r.prototype;return o.signTransaction=function(){var t=a()((function*(t){var n=yield this.getHardwareSDKInstance(),r=yield this.getAccountPath(),o=yield this.getHardwareInfo(),i=o.connectId,a=o.deviceId,c=yield this.getWalletPassphraseState(),u=t.payload.encodedTx,s=x.a.Transaction.from_obj_for_encoding(x.a.decodeObj(e.from(u,"base64"))),d=yield n.algoSignTransaction(i,a,O({path:r,rawTx:s.bytesToSign().toString("hex")},c));if(d.success){var f=d.payload.signature;return{txid:s.txID(),rawTx:e.from(x.a.encodeObj({sig:e.from(f,"hex"),txn:s.get_obj_for_encoding()})).toString("base64")}}throw Object(h.a)(d.payload)}));return function(e){return t.apply(this,arguments)}}(),o.signMessage=function(e,t){throw new w.l},o.prepareAccounts=function(){var e=a()((function*(e){var t,n=this,r=e.indexes,o=e.names,i=r.map((function(e){return A+"/"+e+"'"})),a=yield this.getHardwareSDKInstance(),c=yield this.getHardwareInfo(),u=c.connectId,s=c.deviceId,d=yield this.getWalletPassphraseState();try{t=yield a.algoGetAddress(u,s,O({bundle:i.map((function(e){return{path:e,showOnOneKey:!1}}))},d))}catch(f){throw g.a.common.error(f),new w.p(f)}if(!t.success)throw g.a.common.error(t.payload),Object(h.a)(t.payload);return t.payload.map((function(e,t){var i=e.address,a=void 0===i?"":i,c=e.path;return{id:n.walletId+"--"+c,name:(o||[])[t]||"ALGO #"+(r[t]+1),type:m.b.SIMPLE,path:c,coinType:v.e,pub:"",address:a}})).filter((function(e){return!!e.address}))}));return function(t){return e.apply(this,arguments)}}(),o.getAddress=function(){var e=a()((function*(e){var t,n=yield this.getHardwareSDKInstance(),r=yield this.getHardwareInfo(),o=r.connectId,i=r.deviceId,a=yield this.getWalletPassphraseState(),c=yield n.algoGetAddress(o,i,O({path:e.path,showOnOneKey:e.showOnOneKey},a));if(c.success&&null!=(t=c.payload)&&t.address)return c.payload.address;throw Object(h.a)(c.payload)}));return function(t){return e.apply(this,arguments)}}(),u()(r)}(b.a)}).call(this,n(22).Buffer)},4328:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var r=n(3),o=n.n(r),i=n(6),a=n.n(i),c=n(9),u=n.n(c),s=n(12),d=n.n(s),f=n(5),l=n.n(f),p=n(428),y=n(11),h=n(19),v=n(950),g=n(89),w=n(3095),m=n(3351),b=n(3618);function x(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l()(e);if(t){var o=l()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var T="m/44'/"+y.e+"'/0'/0'",O=function(e){u()(n,e);var t=x(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.prepareAccounts=function(){var e=o()((function*(e){var t=e.password,n=e.indexes,r=e.names,o=(yield this.engine.dbApi.getCredential(this.walletId,t)).seed,i=Object(p.d)("ed25519",o,t,T,n.map((function(e){return e+"'"})));if(i.length!==n.length)throw new h.q("Unable to get publick key.");var a=[],c=0;for(var u of i){var s=u.path,d=u.extendedKey.key,f=m.a.encodeAddress(d),l=(r||[])[c]||"ALGO #"+(n[c]+1);a.push({id:this.walletId+"--"+s,name:l,type:g.b.SIMPLE,path:s,coinType:y.e,pub:""+d.toString("hex"),address:f}),c+=1}return a}));return function(t){return e.apply(this,arguments)}}(),r.getSigners=function(){var e=o()((function*(e,t){var n,r=yield this.getDbAccount();if(1!==t.length)throw new h.q("ALGO signers number should be 1.");if(t[0]!==r.address)throw new h.q("Wrong address required for signing.");var o=(yield this.getPrivateKeys(e))[r.path];if("undefined"===typeof o)throw new h.q("Unable to get signer.");return(n={})[r.address]=new v.b(o,e,"ed25519"),n}));return function(t,n){return e.apply(this,arguments)}}(),r.signTransaction=function(){var e=o()((function*(e,t){var n=yield this.getDbAccount(),r=(yield this.getSigners(t.password||"",[n.address]))[n.address];return Object(b.b)(e,r)}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(e,t){},a()(n)}(w.a)},4329:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var r=n(3),o=n.n(r),i=n(6),a=n.n(i),c=n(9),u=n.n(c),s=n(12),d=n.n(s),f=n(5),l=n.n(f),p=n(514),y=n(11),h=n(19),v=n(950),g=n(89),w=n(3096),m=n(3351),b=n(3618);function x(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l()(e);if(t){var o=l()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var T=function(e){u()(n,e);var t=x(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.prepareAccounts=function(){var e=o()((function*(e){var t=e.name,n=e.privateKey;if(32!==n.length)throw new h.q("Invalid private key.");var r=p.a.publicFromPrivate(n),o=m.a.encodeAddress(r);return Promise.resolve([{id:"imported--"+y.e+"--"+o,name:t||"",type:g.b.SIMPLE,path:"",coinType:y.e,pub:""+r.toString("hex"),address:o}])}));return function(t){return e.apply(this,arguments)}}(),r.getSigners=function(){var e=o()((function*(e,t){var n,r=yield this.getDbAccount();if(1!==t.length)throw new h.q("ALGO signers number should be 1.");if(t[0]!==r.address)throw new h.q("Wrong address required for signing.");var o=(yield this.getPrivateKeys(e))[r.path];if("undefined"===typeof o)throw new h.q("Unable to get signer.");return(n={})[r.address]=new v.b(o,e,"ed25519"),n}));return function(t,n){return e.apply(this,arguments)}}(),r.signTransaction=function(){var e=o()((function*(e,t){var n=yield this.getDbAccount(),r=(yield this.getSigners(t.password||"",[n.address]))[n.address];return Object(b.b)(e,r)}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(e,t){},a()(n)}(w.a)},4330:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return w}));var r=n(3),o=n.n(r),i=n(6),a=n.n(i),c=n(9),u=n.n(c),s=n(12),d=n.n(s),f=n(5),l=n.n(f),p=n(11),y=n(89),h=n(3097),v=n(3351);function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l()(e);if(t){var o=l()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var w=function(t){u()(r,t);var n=g(r);function r(){return n.apply(this,arguments)}return r.prototype.prepareAccounts=function(){var t=o()((function*(t){var n=t.name,r=t.target,o=t.accountIdPrefix,i=yield this.vault.validateAddress(r),a=v.a.decodeAddress(i).publicKey;return Promise.resolve([{id:o+"--"+p.e+"--"+r,name:n||"",type:y.b.SIMPLE,path:"",coinType:p.e,pub:""+e.from(a).toString("hex"),address:i}])}));return function(e){return t.apply(this,arguments)}}(),a()(r)}(h.a)}).call(this,n(22).Buffer)},5656:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"default",(function(){return W}));var r=n(2),o=n.n(r),i=n(10),a=n.n(i),c=n(16),u=n.n(c),s=n(3),d=n.n(s),f=n(6),l=n.n(f),p=n(9),y=n.n(p),h=n(12),v=n.n(h),g=n(5),w=n.n(g),m=n(26),b=n.n(m),x=n(126),T=n.n(x),O=n(117),I=n(136),A=n(47),P=n(20),E=n(19),k=n(56),C=n(3093),S=n(4311),D=n(4328),j=n(4329),B=n(4330),R=n(3351),N=n(2104),F=n(3618);function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return v()(this,n)}}var U=new b.a("0x10000000000000000"),K=/^.*account \w+ balance \d+ below min (\d+).*$/,L=/^.*asset (\d+) missing from \w+$/,q=R.a,W=function(t){y()(r,t);var n=_(r);function r(){for(var e,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return(e=n.call.apply(n,[this].concat(r))).keyringMap={hd:D.a,hw:S.a,imported:j.a,watching:B.a,external:B.a},e.settings=N.default,e.getAlgod=T()((function(e,t,n){return new q.Algodv2(e,t,n)}),{primitive:!0,maxAge:Object(A.b)({minute:3}),max:3}),e.getIndexer=T()(d()((function*(){var t=(yield e.engine.getNetwork(e.networkId)).isTestnet,n=void 0===t||t?"testnet":"mainnet";return new q.Indexer("","https://algosigner.api.purestake.io/"+n+"/indexer",443)})),{maxAge:Object(A.b)({minute:3}),promise:!0,max:1}),e.getSuggestedParams=T()(d()((function*(){return(yield e.getClient()).getTransactionParams().do()})),{promise:!0,maxAge:Object(A.b)({minute:3})}),e}var o=r.prototype;return o.getClient=function(){var e=d()((function*(){var e=yield this.getRpcUrl();return this.getAlgod("",e,443)}));return function(){return e.apply(this,arguments)}}(),o.getClientEndpointStatus=function(){var e=d()((function*(e){var t=this.getAlgod("",e,443),n=performance.now(),r=(yield t.status().do())["last-round"];return{responseTime:Math.floor(performance.now()-n),latestBlock:r}}));return function(t){return e.apply(this,arguments)}}(),o.fetchTokenInfos=function(){var e=d()((function*(e){var t=yield this.getClient();return Promise.all(e.map(function(){var e=d()((function*(e){try{var n=(yield t.getAssetByID(parseInt(e)).do()).params;return{decimals:n.decimals,name:n.name,symbol:n["unit-name"]}}catch(r){}}));return function(t){return e.apply(this,arguments)}}()))}));return function(t){return e.apply(this,arguments)}}(),o.validateAddress=function(e){return q.isValidAddress(e)?Promise.resolve(e):Promise.reject(new E.f)},o.validateWatchingCredential=function(e){return Promise.resolve(this.settings.watchingAccountEnabled&&q.isValidAddress(e))},o.validateTokenAddress=function(e){var t=new b.a(e);return t.isFinite()&&t.gte(0)&&t.lt(U)?Promise.resolve(e):Promise.reject(new E.i)},o.getBalances=function(){var e=d()((function*(e){var t=yield this.getClient(),n=u()(new Set(e.map((function(e){return e.address})))),r=(yield Promise.all(n.map(function(){var e=d()((function*(e){try{return yield t.accountInformation(e).do()}catch(n){}}));return function(t){return e.apply(this,arguments)}}()))).filter(Boolean),o=Object.fromEntries(r.map((function(e){var t=e.address,n=e.amount,r=e.assets;return[t,Object.fromEntries([["main",new b.a(n)]].concat(r.map((function(e){var t=e.amount;return[e["asset-id"].toString(),new b.a(t)]}))))]})));return e.map((function(e){var t,n=e.address,r=e.tokenAddress;if("undefined"!==typeof o[n])return null!=(t=o[n][r||"main"])?t:new b.a(0)}))}));return function(t){return e.apply(this,arguments)}}(),o.getTransactionStatuses=function(){var e=d()((function*(e){var t=yield this.getClient(),n=yield this.getIndexer();return Promise.all(e.map(function(){var e=d()((function*(e){try{var r=yield t.pendingTransactionInformation(e).do(),o=r["confirmed-round"];return r["pool-error"]?I.a.CONFIRM_BUT_FAILED:o>0?I.a.CONFIRM_AND_SUCCESS:I.a.PENDING}catch(i){if(404===i.status)try{return yield n.lookupTransactionByID(e).do(),I.a.CONFIRM_AND_SUCCESS}catch(a){if(404===a.status)return I.a.NOT_FOUND;throw a}throw i}}));return function(t){return e.apply(this,arguments)}}()))}));return function(t){return e.apply(this,arguments)}}(),o.activateToken=function(){var e=d()((function*(e,t){var n=(yield this.getDbAccount()).address,r=yield this.getClient(),o=(yield r.accountInformation(n).do()).assets;for(var i of o){if(i["asset-id"]===parseInt(e))return Promise.resolve(!0)}var a=yield this.buildEncodedTxFromTransfer({from:n,to:n,amount:"0",token:e}),c=yield this.buildUnsignedTxFromEncodedTx(a);return!!(yield this.signAndSendTransaction(c,{password:t},!1)).txid}));return function(t,n){return e.apply(this,arguments)}}(),o.attachFeeInfoToEncodedTx=function(e){return Promise.resolve(e.encodedTx)},o.decodeTx=function(){var t=d()((function*(t,n){var r,o=yield this.getDbAccount(),i=yield this.engine.getNativeTokenInfo(this.networkId),c={type:k.a.UNKNOWN},u=q.decodeObj(e.from(t,"base64")),s=q.encodeAddress(u.snd);if(u.type===q.TransactionType.pay){var d,f=(null==(d=u.amt)?void 0:d.toString())||"0",l=q.encodeAddress(u.rcv);c={type:k.a.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:i,from:s,to:l,amount:new b.a(f).shiftedBy(-i.decimals).toFixed(),amountValue:f.toString(),extraInfo:null}}}if(u.type===q.TransactionType.axfer){var p,y,h=q.encodeAddress(u.arcv),v=yield this.engine.ensureTokenInDB(this.networkId,u.xaid.toString()),g=new b.a(null!=(p=null==(y=u.aamt)?void 0:y.toString())?p:0).toFixed();if("undefined"!==typeof v)if(s===h&&"0"===g)c={type:k.a.TOKEN_ACTIVATE,tokenActivate:{tokenAddress:v.tokenIdOnNetwork,logoURI:"",decimals:v.decimals,name:v.name,symbol:v.symbol,extraInfo:null}};else{var w=u.asnd&&q.encodeAddress(u.asnd);if(u.aclose){var m=yield this.getBalances([{address:o.address,tokenAddress:v.tokenIdOnNetwork}]),x=a()(m,1)[0];g=new b.a(null!=x?x:0).toFixed()}c={type:k.a.TOKEN_TRANSFER,tokenTransfer:{tokenInfo:v,from:null!=w?w:s,to:h,amount:new b.a(g).shiftedBy(-v.decimals).toFixed(),amountValue:g,extraInfo:null}}}}return{txid:"",owner:o.address,signer:s,nonce:0,actions:[c],status:k.c.Pending,networkId:this.networkId,accountId:this.accountId,totalFeeInNative:new b.a(u.fee).shiftedBy(-i.decimals).toFixed(),extraInfo:{note:e.from(null!=(r=u.note)?r:"").toString()},encodedTx:t}}));return function(e,n){return t.apply(this,arguments)}}(),o.decodedTxToLegacy=function(e){return Promise.resolve({})},o.buildEncodedTxFromTransfer=function(){var e=d()((function*(e){var t=e.from,n=e.to,r=e.amount,o=e.token,i=yield this.engine.ensureTokenInDB(this.networkId,o||"");if(!i)throw new E.q("Token not found: "+(o||"ALGO"));var a=yield this.getSuggestedParams();return o?Object(F.a)(q.makeAssetTransferTxnWithSuggestedParamsFromObject({amount:BigInt(new b.a(r).shiftedBy(i.decimals).toFixed()),assetIndex:parseInt(o),from:t,to:n,suggestedParams:a})):Object(F.a)(q.makePaymentTxnWithSuggestedParamsFromObject({amount:BigInt(new b.a(r).shiftedBy(i.decimals).toFixed()),from:t,to:n,suggestedParams:a}))}));return function(t){return e.apply(this,arguments)}}(),o.buildEncodedTxFromApprove=function(e){throw new E.l},o.updateEncodedTxTokenApprove=function(e,t){throw new E.l},o.getFrozenBalance=function(){var e=d()((function*(){var e=yield this.getClient(),t=(yield this.engine.getNativeTokenInfo(this.networkId)).decimals,n=(yield this.getDbAccount()).address;try{var r=(yield e.accountInformation(n).do())["min-balance"],o=void 0===r?0:r;return{main:new b.a(null!=o?o:0).shiftedBy(-t).toNumber()}}catch(i){return 0}}));return function(){return e.apply(this,arguments)}}(),o.updateEncodedTx=function(){var t=d()((function*(t,n,r){var o=q.decodeObj(e.from(t,"base64"));if(r.type===k.d.transfer&&o.type===q.TransactionType.pay){var i=(yield this.engine.getNativeTokenInfo(this.networkId)).decimals,a=n.amount;return Object(F.a)(q.Transaction.from_obj_for_encoding(M(M({},o),{},{amt:BigInt(new b.a(a).shiftedBy(i).toFixed())})))}return Promise.resolve(t)}));return function(e,n,r){return t.apply(this,arguments)}}(),o.buildUnsignedTxFromEncodedTx=function(e){return Promise.resolve({inputs:[],outputs:[],payload:{encodedTx:e},encodedTx:e})},o.fetchFeeInfo=function(){var t=d()((function*(t){var n=yield this.getNetwork(),r=q.decodeObj(e.from(t,"base64")).fee,o=void 0===r?0:r;return{nativeSymbol:n.symbol,nativeDecimals:n.decimals,feeSymbol:n.feeSymbol,feeDecimals:n.feeDecimals,limit:"0",prices:["0"],defaultPresetIndex:"0",tx:null,baseFeeValue:new b.a(o.toString()).shiftedBy(-n.feeDecimals).toFixed()}}));return function(e){return t.apply(this,arguments)}}(),o.broadcastTransaction=function(){var t=d()((function*(t){P.a.engine.info("broadcastTransaction START:",{rawTx:t.rawTx});var n=yield this.getClient();try{var r=(yield n.sendRawTransaction(e.from(t.rawTx,"base64")).do()).txId;return P.a.engine.info("broadcastTransaction END:",{txid:r,rawTx:t.rawTx}),M(M({},t),{},{txid:r})}catch(f){var o=f.message;if(L.test(o)){var i=o.match(L)[1],a=yield this.engine.ensureTokenInDB(this.networkId,i.toString());return Promise.reject(new E.x((null==a?void 0:a.name)||i))}if(K.test(o)){var c=yield this.engine.getNativeTokenInfo(this.networkId),u=c.name,s=c.decimals,d=o.match(K)[1];return Promise.reject(new E.k(u,new b.a(d).shiftedBy(-s).toFixed()))}return Promise.reject(f)}}));return function(e){return t.apply(this,arguments)}}(),o.getExportedCredential=function(){var e=d()((function*(e){var t=yield this.getDbAccount();if(t.id.startsWith("hd-")||t.id.startsWith("imported")){var n=this.keyring,r=Object.values(yield n.getPrivateKeys(e)),o=a()(r,1)[0];return q.mnemonicFromSeed(Object(O.a)(e,o))}throw new E.q("Only credential of HD or imported accounts can be exported")}));return function(t){return e.apply(this,arguments)}}(),o.fetchOnChainHistory=function(){var e=d()((function*(e){var t=this,n=e.localHistory,r=void 0===n?[]:n;if(e.tokenIdOnNetwork)return Promise.resolve([]);var o=(yield this.getDbAccount()).address,i=yield this.engine.getNativeTokenInfo(this.networkId),a=yield this.getIndexer(),c=(yield a.lookupAccountTransactions(o).limit(50).do()).transactions.map(function(){var e=d()((function*(e){var n=r.find((function(t){return t.decodedTx.txid===e.id}));if(n&&n.decodedTx.isFinal)return Promise.resolve(null);try{var a,c={txid:e.id,owner:o,signer:e.sender,nonce:0,actions:[{type:k.a.UNKNOWN}],status:k.c.Confirmed,networkId:t.networkId,accountId:t.accountId,extraInfo:null==n?void 0:n.decodedTx.extraInfo,totalFeeInNative:new b.a(e.fee).shiftedBy(-i.decimals).toFixed(),updatedAt:1e3*e["round-time"],createdAt:null!=(a=null==n?void 0:n.decodedTx.createdAt)?a:1e3*e["round-time"],isFinal:!0};if(e["tx-type"]===q.TransactionType.pay&&"undefined"!==typeof e["payment-transaction"]){var u=e["payment-transaction"],s=u.receiver,d=u.amount,f=k.b.IN;e.sender===o&&(f=s===o?k.b.SELF:k.b.OUT),c.actions[0]={type:k.a.NATIVE_TRANSFER,direction:f,nativeTransfer:{tokenInfo:i,from:e.sender,to:s,amount:new b.a(d).shiftedBy(-i.decimals).toFixed(),amountValue:d.toString(),extraInfo:null}}}else if(e["tx-type"]===q.TransactionType.axfer&&"undefined"!==typeof e["asset-transfer-transaction"]){var l=e["asset-transfer-transaction"],p=l.receiver,y=l.amount,h=(l["close-to"],l["close-amount"]),v=l["asset-id"],g=yield t.engine.ensureTokenInDB(t.networkId,v.toString());if("undefined"===typeof g)throw new E.q("Failed to get token info.");if(e.sender===o&&p===o&&0===y)c.actions[0]={type:k.a.TOKEN_ACTIVATE,tokenActivate:{tokenAddress:g.tokenIdOnNetwork,logoURI:"",decimals:g.decimals,name:g.name,symbol:g.symbol,extraInfo:null}};else{var w=k.b.IN;e.sender===o&&(w=p===o?k.b.SELF:k.b.OUT),c.actions[0]={type:k.a.TOKEN_TRANSFER,direction:w,tokenTransfer:{tokenInfo:g,from:e.sender,to:p,amount:new b.a(h>0?h:y).shiftedBy(-g.decimals).toFixed(),amountValue:y.toString(),extraInfo:null}}}}return yield t.buildHistoryTx({decodedTx:c,historyTxToMerge:n})}catch(m){P.a.common.error(m)}}));return function(t){return e.apply(this,arguments)}}());return(yield Promise.all(c)).filter(Boolean)}));return function(t){return e.apply(this,arguments)}}(),o.getPrivateKeyByCredential=function(){var t=d()((function*(t){return Promise.resolve(e.from(q.seedFromMnemonic(t)))}));return function(e){return t.apply(this,arguments)}}(),o.validateImportedCredential=function(e){if(this.settings.importedAccountEnabled)try{if(q.seedFromMnemonic(e))return Promise.resolve(!0)}catch(t){}return Promise.resolve(!1)},l()(r)}(C.a)}.call(this,n(22).Buffer)}}]);