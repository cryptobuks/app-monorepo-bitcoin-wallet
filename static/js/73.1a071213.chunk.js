(this.webpackJsonp=this.webpackJsonp||[]).push([[73],{3071:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(3),o=n.n(r),i=n(6),a=n.n(i),u=n(9),c=n.n(u),s=n(12),d=n.n(s),l=n(5),f=n.n(l);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var y=function(e){c()(n,e);var t=p(n);function n(e){var n;return(n=t.call(this,e.options)).vault=e,n}return n.prototype.addressFromBase=function(){var e=o()((function*(e){return this.vault.addressFromBase(e)}));return function(t){return e.apply(this,arguments)}}(),a()(n)}(n(1147).a);!function(e){c()(n,e);var t=p(n);function n(){return t.apply(this,arguments)}a()(n)}(y)},3077:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var r=n(10),o=n.n(r),i=n(2),a=n.n(i),u=n(3),c=n.n(u),s=n(6),d=n.n(s),l=n(9),f=n.n(l),p=n(12),y=n.n(p),h=n(5),v=n.n(h),g=n(20),w=n(19);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var o=v()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return y()(this,n)}}var T=function(e){f()(n,e);var t=x(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=c()((function*(e,t){var n=t.password;if("undefined"===typeof n)throw new w.q("Software signing requires a password.");var r=yield this.getSigners(n,e.inputs.map((function(e){return e.address})));return g.a.engine.info("signTransaction",this.networkId,e),b(b({},yield this.engine.providerManager.signTransaction(this.networkId,e,r)),{},{encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=c()((function*(e,t){var n=this,r=t.password;if("undefined"===typeof r)throw new w.q("Software signing requires a password.");var i=yield this.getDbAccount(),a=Object.values(yield this.getSigners(r,[i.address])),u=o()(a,1)[0];return g.a.engine.info("signMessage",this.networkId,e),Promise.all(e.map((function(e){return n.engine.providerManager.signMessage(n.networkId,e,u)})))}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},d()(n)}(n(3071).a)},3093:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return R}));var r=n(2),o=n.n(r),i=n(146),a=n.n(i),u=n(3),c=n.n(u),s=n(6),d=n.n(s),l=n(9),f=n.n(l),p=n(12),y=n.n(p),h=n(5),v=n.n(h),g=n(26),w=n.n(g),m=n(11),b=n(20),x=n(14),T=n(53),O=n(19),A=n(184),P=n(658),k=n(56),I=n(1147);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var o=v()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return y()(this,n)}}if(x.a.isExtensionUi)throw new Error("engine/VaultBase is not allowed imported from ui");var R=function(t){f()(r,t);var n=N(r);function r(){return n.apply(this,arguments)}var o=r.prototype;return o.init=function(){var e=c()((function*(e){yield this.initProvider(),yield this.initKeyring(e)}));return function(t){return e.apply(this,arguments)}}(),o.initKeyring=function(){var e=c()((function*(e){this.keyring=yield e.keyringCreator(this)}));return function(t){return e.apply(this,arguments)}}(),o.signTransaction=function(){var e=c()((function*(e,t){return this.keyring.signTransaction(e,t)}));return function(t,n){return e.apply(this,arguments)}}(),o.signAndSendTransaction=function(){var e=c()((function*(e,t,n){var r=yield this.signTransaction(e,t);return n?C(C({},r),{},{encodedTx:e.encodedTx}):this.broadcastTransaction(C(C({},r),{},{encodedTx:e.encodedTx}))}));return function(t,n,r){return e.apply(this,arguments)}}(),o.broadcastTransaction=function(){var e=c()((function*(e,t){b.a.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var n=yield this.engine.providerManager.broadcastTransaction(this.networkId,e.rawTx,t);return b.a.engine.info("broadcastTransaction END:",{txid:n,rawTx:e.rawTx}),C(C({},e),{},{txid:n,encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),o.buildEncodedTxFromBatchTransfer=function(){var e=c()((function*(e,t,n){throw new O.l}));return function(t,n,r){return e.apply(this,arguments)}}(),o.buildEncodedTxsFromSetApproveForAll=function(){var e=c()((function*(e,t){throw new O.l}));return function(t,n){return e.apply(this,arguments)}}(),o.activateAccount=function(){var e=c()((function*(){throw new O.l}));return function(){return e.apply(this,arguments)}}(),o.activateToken=function(){var e=c()((function*(e,t){throw new O.l}));return function(t,n){return e.apply(this,arguments)}}(),o.getTokenAllowance=function(){var e=c()((function*(e,t){throw new O.l}));return function(t,n){return e.apply(this,arguments)}}(),o.batchTokensAllowance=function(){var e=c()((function*(e,t){throw new O.l}));return function(t,n){return e.apply(this,arguments)}}(),o.getOutputAccount=function(){var e=c()((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address}}));return function(){return e.apply(this,arguments)}}(),o.getAccountBalance=function(){var e=c()((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=yield this.getDbAccount(),o=r.address;return this.getBalances((t?[{address:o}]:[]).concat(e.map((function(e){return{address:o,tokenAddress:e}}))),n)}));return function(t){return e.apply(this,arguments)}}(),o.updatePendingTxs=function(){var e=c()((function*(e){throw new O.l}));return function(t){return e.apply(this,arguments)}}(),o.getAccountNonce=function(){var e=c()((function*(){return Promise.resolve(null)}));return function(){return e.apply(this,arguments)}}(),o.fixActionDirection=function(){var e=c()((function*(e){var t,n,r,o,i=e.action,a=e.accountAddress;(i.direction=k.b.OTHER,i.type===k.a.NATIVE_TRANSFER)&&(i.direction=yield this.buildTxActionDirection({from:(null==(t=i.nativeTransfer)?void 0:t.from)||"",to:(null==(n=i.nativeTransfer)?void 0:n.to)||"",address:a}));i.type===k.a.TOKEN_TRANSFER&&(i.direction=yield this.buildTxActionDirection({from:(null==(r=i.tokenTransfer)?void 0:r.from)||"",to:(null==(o=i.tokenTransfer)?void 0:o.to)||"",address:a}));return i}));return function(t){return e.apply(this,arguments)}}(),o.fixDecodedTx=function(){var e=c()((function*(e){var t,n;e.createdAt=null!=(t=e.createdAt)?t:Date.now();var r=null==(n=e.encodedTx)?void 0:n.nonce;e.nonce=a()(r)?e.nonce:new w.a(r).toNumber();for(var o=e.owner,i=0;i<e.actions.length;i+=1){var u=e.actions[i];yield this.fixActionDirection({action:u,accountAddress:o})}if(e.outputActions)for(var c=0;c<e.outputActions.length;c+=1){var s=e.outputActions[c];yield this.fixActionDirection({action:s,accountAddress:o})}return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),o.fixHistoryTx=function(){var e=c()((function*(e){return e.decodedTx=yield this.fixDecodedTx(e.decodedTx),x.a.isDev&&x.a.isDesktop&&Object.assign(e,{_tmpCreatedAtText:new Date(e.decodedTx.createdAt||0).toLocaleString(),_tmpUpdatedAtText:new Date(e.decodedTx.updatedAt||0).toLocaleString(),_tmpStatus:e.decodedTx.status,_tmpIsFinal:e.decodedTx.isFinal}),Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),o.buildHistoryTx=function(){var e=c()((function*(e){var t=e.historyTxToMerge,n=(e.encodedTx,e.decodedTx),r=e.signedTx,o=e.isSigner,i=e.isLocalCreated,a=(null==r?void 0:r.txid)||(null==n?void 0:n.txid)||"";if(!a)throw new Error("buildHistoryTx txid not found");var u=yield this.getAccountAddress();n.txid=a||n.txid,n.owner=u,o&&(n.signer=u),null!=r&&r.txKey&&(n.extraInfo?n.extraInfo.txKey=r.txKey:n.extraInfo={txKey:r.txKey});var c=C(C({id:this.networkId+"_"+a+"_"+this.accountId,isLocalCreated:Boolean(i)},t),{},{decodedTx:n});return c=yield this.fixHistoryTx(c),Promise.resolve(c)}));return function(t){return e.apply(this,arguments)}}(),o.checkIsScamHistoryTx=function(){var e=c()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),o.fetchOnChainHistory=function(){var e=c()((function*(e){throw new O.l}));return function(t){return e.apply(this,arguments)}}(),o.fixAddressCase=function(e){return Promise.resolve(e)},o.buildTxActionDirection=function(){var e=c()((function*(e){var t=e.from,n=e.to,r=e.address;return t=yield this.fixAddressCase(t||""),n=yield this.fixAddressCase(n),r=yield this.fixAddressCase(r),t===n&&t===r?k.b.SELF:t&&t===r?k.b.OUT:n&&n===r?k.b.IN:k.b.OTHER}));return function(t){return e.apply(this,arguments)}}(),o.getNextNonce=function(){var e=c()((function*(e,t){var n,r,o=null!=(n=null==(r=(yield this.engine.providerManager.getAddresses(e,[t.address]))[0])?void 0:r.nonce)?n:0,i=(yield this.engine.getHistory(e,t.id,void 0,!1),yield T.a.history.getMaxPendingNonce({accountId:this.accountId,networkId:e})),u=yield T.a.history.getPendingNonceList({accountId:this.accountId,networkId:e}),c=Math.max(a()(i)?0:i+1,o);if(Number.isNaN(c)&&(c=o),c>o)for(var s=o;s<c;s+=1)if(!u.includes(s)){c=s;break}if(c<o&&(c=o),c-o>=m.y.PENDING_QUEUE_MAX_LENGTH)throw new O.v(m.y.PENDING_QUEUE_MAX_LENGTH);return c}));return function(t,n){return e.apply(this,arguments)}}(),o.validateSendAmount=function(e,t,n){return Promise.resolve(!0)},o.notifyChainChanged=function(e,t){},o.getFetchBalanceAddress=function(e){return Promise.resolve(e.address)},o.getPrivateKeyByCredential=function(t){return Promise.resolve(e.from(t.startsWith("0x")?t.slice(2):t,"hex"))},o.getMinDepositAmount=function(){var e=c()((function*(){return"0"}));return function(){return e.apply(this,arguments)}}(),o.specialCheckEncodedTx=function(){var e=c()((function*(e){return{success:!0}}));return function(t){return e.apply(this,arguments)}}(),d()(r)}(function(e){f()(n,e);var t=N(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.initProvider=function(){var e=c()((function*(){var e=(yield this.getNetwork()).impl;a()(P.a[e])||(this.engineProvider=yield this.engine.providerManager.getProvider(this.networkId))}));return function(){return e.apply(this,arguments)}}(),r.proxyJsonRPCCall=function(){var e=c()((function*(e){throw new O.l}));return function(t){return e.apply(this,arguments)}}(),r.createClientFromURL=function(e){throw new O.l},r.getEthersProvider=function(){var e=c()((function*(){throw new O.l}));return function(){return e.apply(this,arguments)}}(),r.getClientEndpointStatus=function(){var e=c()((function*(e){var t=this.createClientFromURL(e),n=performance.now(),r=(yield t.getInfo()).bestBlockNumber;return{responseTime:Math.floor(performance.now()-n),latestBlock:r}}));return function(t){return e.apply(this,arguments)}}(),r.validateAddress=function(){var e=c()((function*(e){var t=yield this.engineProvider.verifyAddress(e),n=t.normalizedAddress;if(!t.isValid||"undefined"===typeof n)throw new O.f;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.validateImportedCredential=function(e){return Promise.resolve(this.settings.importedAccountEnabled&&/^(0x)?[0-9a-zA-Z]{64}$/.test(e))},r.validateWatchingCredential=function(){var e=c()((function*(e){return Promise.resolve(this.settings.watchingAccountEnabled&&(yield this.engineProvider.verifyAddress(e)).isValid)}));return function(t){return e.apply(this,arguments)}}(),r.validateTokenAddress=function(){var e=c()((function*(e){var t=yield this.engineProvider.verifyTokenAddress(e),n=t.normalizedAddress;if(!t.isValid||"undefined"===typeof n)throw new O.i;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.validateCanCreateNextAccount=function(){var e=c()((function*(e,t){return Promise.resolve(!0)}));return function(t,n){return e.apply(this,arguments)}}(),r.checkAccountExistence=function(){var e=c()((function*(e){return Promise.resolve(!0)}));return function(t){return e.apply(this,arguments)}}(),r.getBalances=function(){var e=c()((function*(e,t){return(yield this.engine.providerManager.getClient(this.networkId)).getBalances(e.map((function(e){var t=e.address,n=e.tokenAddress;return{address:t,coin:C({},"string"===typeof n?{tokenAddress:n}:{})}})))}));return function(t,n){return e.apply(this,arguments)}}(),r.getFrozenBalance=function(){var e=c()((function*(e){return 0}));return function(t){return e.apply(this,arguments)}}(),r.getTransactionStatuses=function(e){return this.engine.providerManager.getTransactionStatuses(this.networkId,e)},r.getTransactionFeeInNative=function(e){return Promise.resolve("")},r.isContractAddress=function(){var e=c()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),r.getAccountNameInfoMap=function(){var e=c()((function*(){var e=yield this.getNetwork();return Object(A.a)(e.impl)}));return function(){return e.apply(this,arguments)}}(),r.canAutoCreateNextAccount=function(){var e=c()((function*(e){return Promise.resolve(!1)}));return function(t){return e.apply(this,arguments)}}(),r.filterAccounts=function(){var e=c()((function*(e){var t=e.accounts;e.networkId;return Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),r.shouldChangeAccountWhenNetworkChanged=function(){var e=c()((function*(e){e.previousNetwork,e.newNetwork,e.activeAccountId;return Promise.resolve({shouldReloadAccountList:!1,shouldChangeActiveAccount:!1})}));return function(t){return e.apply(this,arguments)}}(),r.getAccountNameInfosByImportedOrWatchingCredential=function(){var e=c()((function*(e){return Promise.resolve([])}));return function(t){return e.apply(this,arguments)}}(),d()(n)}(I.a))}).call(this,n(22).Buffer)},3094:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return v}));var r=n(3),o=n.n(r),i=n(6),a=n.n(i),u=n(9),c=n.n(u),s=n(12),d=n.n(s),l=n(5),f=n.n(l),p=n(309),y=n(253);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var v=function(t){c()(r,t);var n=h(r);function r(){return n.apply(this,arguments)}var i=r.prototype;return i.getHardwareInfo=function(){var e=o()((function*(){var e,t,n,r=yield this.engine.getHWDeviceByWalletId(this.vault.walletId);return{connectId:null!=(e=null==r?void 0:r.mac)?e:"",deviceId:null!=(t=null==r?void 0:r.deviceId)?t:"",deviceType:null!=(n=null==r?void 0:r.deviceType)?n:""}}));return function(){return e.apply(this,arguments)}}(),i.getWalletPassphraseState=function(){var e=o()((function*(){var e=yield this.engine.getWallet(this.vault.walletId);return{passphraseState:null==e?void 0:e.passphraseState,useEmptyPassphrase:!Object(y.g)(e)}}));return function(){return e.apply(this,arguments)}}(),i.getHardwareSDKInstance=function(){var t=o()((function*(){var t,n,r,o,i;return null!=(i=yield null==(t=e)||null==(n=t.$backgroundApiProxy)||null==(r=n.backgroundApi)||null==(o=r.serviceHardware)||null==o.getSDKInstance?void 0:o.getSDKInstance())?i:p.b}));return function(){return t.apply(this,arguments)}}(),a()(r)}(n(3071).a)}).call(this,n(40))},3095:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(2),o=n.n(r),i=n(3),a=n.n(i),u=n(6),c=n.n(u),s=n(9),d=n.n(s),l=n(12),f=n.n(l),p=n(5),y=n.n(p),h=n(428),v=n(19);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return f()(this,n)}}var b=function(e){d()(n,e);var t=m(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getPrivateKeys=function(){var e=a()((function*(e,t){var n=(yield this.getDbAccount()).path.split("/"),r=t||[n.pop()],o=n.join("/"),i=(yield this.engine.dbApi.getCredential(this.walletId,e)).seed;if("undefined"===typeof i)throw new v.q("Unable to get credential.");var a=(yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId)).curve;return Object(h.c)(a,i,e,o,r).reduce((function(e,t){var n;return w(w({},e),{},((n={})[t.path]=t.extendedKey.key,n))}),{})}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},c()(n)}(n(3077).a)},3096:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(3),o=n.n(r),i=n(6),a=n.n(i),u=n(9),c=n.n(u),s=n(12),d=n.n(s),l=n(5),f=n.n(l),p=n(19);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var h=function(e){c()(n,e);var t=y(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getPrivateKeys=function(){var e=o()((function*(e,t){if("undefined"!==typeof t)throw new p.l("Getting private keys from extended private key");var n=(yield this.engine.dbApi.getCredential(this.accountId,e)).privateKey;if("undefined"===typeof n)throw new p.q("Unable to get credential.");return{"":n}}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},a()(n)}(n(3077).a)},3097:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(3),o=n.n(r),i=n(6),a=n.n(i),u=n(9),c=n.n(u),s=n(12),d=n.n(s),l=n(5),f=n.n(l),p=n(19);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var h=function(e){c()(n,e);var t=y(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=o()((function*(e,t){throw new p.q("signTransaction is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=o()((function*(e,t){throw new p.q("signMessage is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},a()(n)}(n(3071).a)},3098:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(42),o=n(70),i=n(20),a=n(14);function u(e,t){return"string"!==typeof t?null:e===r.HardwareErrorCode.DeviceInitializeFailed&&t.includes("ECONNABORTED")?new o.h({message:t}):t.includes("Bridge network error")?new o.e({message:t}):null}function c(e){var t,n=e||{},c=n.code,s=n.error,d=n.message,l=null!=(t=null!=s?s:d)?t:"Unknown error";if(u(c,l))return u(c,l);switch(i.a.hardwareSDK.info("Device Utils Convert Device Error:",c,l),c){case r.HardwareErrorCode.UnknownError:return new o.H(e);case r.HardwareErrorCode.DeviceFwException:return new o.t(e);case r.HardwareErrorCode.DeviceUnexpectedMode:return"string"===typeof l&&-1!==l.indexOf("ui-device_bootloader_mode")?new o.E(e):new o.H(e);case r.HardwareErrorCode.DeviceCheckDeviceIdError:return new o.m(e);case r.HardwareErrorCode.DeviceNotFound:return new o.k(e);case r.HardwareErrorCode.DeviceUnexpectedBootloaderMode:return new o.E(e);case r.HardwareErrorCode.DeviceInterruptedFromOutside:case r.HardwareErrorCode.DeviceInterruptedFromUser:return new o.K(e);case r.HardwareErrorCode.DeviceNotSupportPassphrase:return new o.F(e);case r.HardwareErrorCode.IFrameLoadFail:return new o.v(e);case r.HardwareErrorCode.IframeTimeout:return new o.w(e);case r.HardwareErrorCode.FirmwareUpdateDownloadFailed:return new o.p(e);case r.HardwareErrorCode.FirmwareUpdateManuallyEnterBoot:return new o.s(e);case r.HardwareErrorCode.FirmwareUpdateAutoEnterBootFailure:return new o.q(e);case r.HardwareErrorCode.FirmwareUpdateLimitOneDevice:return new o.r(e);case r.HardwareErrorCode.CallMethodNeedUpgradeFirmware:return new o.t(e);case r.HardwareErrorCode.NewFirmwareUnRelease:return new o.D(e);case r.HardwareErrorCode.NetworkError:return new o.C(e);case r.HardwareErrorCode.BlePermissionError:return new o.A(e);case r.HardwareErrorCode.BleLocationError:return new o.z({message:l});case r.HardwareErrorCode.BleLocationServicesDisabled:return new o.b({message:l});case r.HardwareErrorCode.BleDeviceNotBonded:return new o.j(e);case r.HardwareErrorCode.BleWriteCharacteristicError:return new o.d(e);case r.HardwareErrorCode.BleScanError:return new o.c({message:l});case r.HardwareErrorCode.BleAlreadyConnected:return new o.a(e);case r.HardwareErrorCode.RuntimeError:return-1!==l.indexOf("EIP712 blind sign is disabled")?new o.G(e):-1!==l.indexOf("Unknown message")||-1!==l.indexOf("Failure_UnexpectedMessage")?new o.I(e):new o.H(e);case r.HardwareErrorCode.PinInvalid:return new o.x(e);case r.HardwareErrorCode.DeviceCheckPassphraseStateError:return new o.y(e);case r.HardwareErrorCode.DeviceOpenedPassphrase:return new o.n(e);case r.HardwareErrorCode.DeviceNotOpenedPassphrase:return new o.l(e);case r.HardwareErrorCode.PinCancelled:case r.HardwareErrorCode.ActionCancelled:return new o.J(e);case r.HardwareErrorCode.BridgeNotInstalled:case o.i.NeedOneKeyBridge:return new o.B(e);case r.HardwareErrorCode.BridgeNetworkError:return new o.e(e);case r.HardwareErrorCode.BridgeTimeoutError:return a.a.isDesktop&&(i.a.hardwareSDK.debug("desktop bridge timeout, restart desktop bridge."),window.desktopApi.reloadBridgeProcess()),new o.f(e);case r.HardwareErrorCode.PollingTimeout:return new o.h(e);case r.HardwareErrorCode.PollingStop:return new o.g(e);case r.HardwareErrorCode.BlindSignDisabled:return new o.G(e);default:return new o.H(e)}}},4215:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return N}));var r=n(2),o=n.n(r),i=n(10),a=n.n(i),u=n(3),c=n.n(u),s=n(6),d=n.n(s),l=n(9),f=n.n(l),p=n(12),y=n.n(p),h=n(5),v=n.n(h),g=n(13),w=n(133),m=n(1218),b=n(3098),x=n(11),T=n(20),O=n(19),A=n(89),P=n(3094);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var o=v()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return y()(this,n)}}var C="m/44'/"+x.s+"'/0'/0'",N=function(t){f()(r,t);var n=E(r);function r(){return n.apply(this,arguments)}var o=r.prototype;return o.signTransaction=function(){var t=c()((function*(t,n){var r=yield this.getDbAccount(),o=yield this.getNetworkChainId(),i=Object(m.c)(t,o),u=a()(i,2),c=u[0],s=u[1],d=a()(t.inputs,1)[0].publicKey;if(!d)throw new O.p(Error("senderPublicKey is required"));var l=yield this.getHardwareInfo(),f=l.connectId,p=l.deviceId,y=yield this.getWalletPassphraseState(),h=yield this.getHardwareSDKInstance(),v=yield h.starcoinSignTransaction(f,p,I({path:r.path,rawTx:e.from(s).toString("hex")},y));if(v.success){var g=v.payload.signature;return Object(m.b)(d,e.from(g,"hex"),c)}throw Object(b.a)(v.payload)}));return function(e,n){return t.apply(this,arguments)}}(),o.signMessage=function(){var e=c()((function*(e,t){var n=yield this.getDbAccount(),r=yield this.getNetworkChainId(),o=yield this.getHardwareInfo(),i=o.connectId,a=o.deviceId,u=yield this.getWalletPassphraseState(),s=yield this.getHardwareSDKInstance();return Promise.all(e.map(function(){var e=c()((function*(e){var t,o=e.type,c=e.message;try{t=yield s.starcoinSignMessage(i,a,I({path:n.path,messageHex:c},u))}catch(h){throw T.a.common.error(h),new O.p(h)}if(!t.success)throw T.a.common.error(t.payload),Object(b.a)(t.payload);var d=t.payload,l=d.public_key,f=d.signature;if(1===o){var p=Object(g.arrayify)(c),y=new w.d.SigningMessage(p);return yield w.e.signedMessage.generateSignedMessage(y,parseInt(r),l,f)}return f}));return function(t){return e.apply(this,arguments)}}()))}));return function(t,n){return e.apply(this,arguments)}}(),o.prepareAccounts=function(){var e=c()((function*(e){var t,n=e.type,r=e.indexes,o=e.names,i=r.map((function(e){return C+"/"+e+"'"})),a="SEARCH_ACCOUNTS"===n,u=yield this.getHardwareSDKInstance(),c=yield this.getHardwareInfo(),s=c.connectId,d=c.deviceId,l=yield this.getWalletPassphraseState(),f=[];if(!a){var p;try{p=yield u.starcoinGetPublicKey(s,d,I({bundle:i.map((function(e){return{path:e,showOnOneKey:!1}}))},l))}catch(P){throw T.a.common.error(P),new O.p(P)}if(!p.success)throw T.a.common.error(p.payload),Object(b.a)(p.payload);f=p.payload.map((function(e){return e.public_key})).filter((function(e){return!!e}))}try{t=yield u.starcoinGetAddress(s,d,I({bundle:i.map((function(e){return{path:e,showOnOneKey:!1}}))},l))}catch(P){throw T.a.common.error(P),new O.p(P)}if(!t.success)throw T.a.common.error(t.payload),Object(b.a)(t.payload);var y=[],h=0;for(var v of t.payload){var g=v.address,w=v.path;if(g){var m=(o||[])[h]||"STC #"+(r[h]+1);y.push({id:this.walletId+"--"+w,name:m,type:A.b.SIMPLE,path:w,coinType:x.s,pub:f[h]||"",address:g}),h+=1}}return y}));return function(t){return e.apply(this,arguments)}}(),o.getAddress=function(){var e=c()((function*(e){var t,n=yield this.getHardwareSDKInstance(),r=yield this.getHardwareInfo(),o=r.connectId,i=r.deviceId,a=yield this.getWalletPassphraseState(),u=yield n.starcoinGetAddress(o,i,I({path:e.path,showOnOneKey:e.showOnOneKey},a));if(u.success&&null!=(t=u.payload)&&t.address)return u.payload.address;throw Object(b.a)(u.payload)}));return function(t){return e.apply(this,arguments)}}(),d()(r)}(P.a)}).call(this,n(22).Buffer)},4216:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return x}));var r=n(3),o=n.n(r),i=n(6),a=n.n(i),u=n(9),c=n.n(u),s=n(12),d=n.n(s),l=n(5),f=n.n(l),p=n(428),y=n(11),h=n(19),v=n(950),g=n(89),w=n(3095);function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var b="m/44'/"+y.s+"'/0'/0'",x=function(t){c()(r,t);var n=m(r);function r(){return n.apply(this,arguments)}var i=r.prototype;return i.getSigners=function(){var e=o()((function*(e,t){var n,r=yield this.getDbAccount();if(1!==t.length)throw new h.q("Starcoin signers number should be 1.");if(t[0]!==r.address)throw new h.q("Wrong address required for signing.");var o=(yield this.getPrivateKeys(e))[r.path];if("undefined"===typeof o)throw new h.q("Unable to get signer.");return(n={})[r.address]=new v.b(o,e,"ed25519"),n}));return function(t,n){return e.apply(this,arguments)}}(),i.prepareAccounts=function(){var t=o()((function*(t){var n=this,r=t.password,o=t.indexes,i=t.names,a=(yield this.engine.dbApi.getCredential(this.walletId,r)).seed,u=Object(p.d)("ed25519",a,r,b,o.map((function(e){return e.toString()+"'"})));if(u.length!==o.length)throw new h.q("Unable to get publick key.");var c=[],s=0,d=function*(t){var r=t.path,a=t.extendedKey.key,u=a.toString("hex"),d=yield n.engine.providerManager.pubkeyToAddress(n.networkId,{getPubkey:function(e){return Promise.resolve(a)},verify:function(t,n){return Promise.resolve(e.from([]))}},"hex"),l=(i||[])[s]||"STC #"+(o[s]+1);c.push({id:n.walletId+"--"+r,name:l,type:g.b.SIMPLE,path:r,coinType:y.s,pub:u,address:d}),s+=1};for(var l of u)yield*d(l);return c}));return function(e){return t.apply(this,arguments)}}(),a()(r)}(w.a)}).call(this,n(22).Buffer)},4217:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return x}));var r=n(10),o=n.n(r),i=n(3),a=n.n(i),u=n(6),c=n.n(u),s=n(9),d=n.n(s),l=n(12),f=n.n(l),p=n(5),y=n.n(p),h=n(514),v=n(11),g=n(19),w=n(950),m=n(89);function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return f()(this,n)}}var x=function(t){d()(r,t);var n=b(r);function r(){return n.apply(this,arguments)}var i=r.prototype;return i.getSigners=function(){var e=a()((function*(e,t){var n,r=yield this.getDbAccount();if(1!==t.length)throw new g.q("Starcoin signers number should be 1.");if(t[0]!==r.address)throw new g.q("Wrong address required for signing");var i=Object.values(yield this.getPrivateKeys(e)),a=o()(i,1)[0];return(n={})[r.address]=new w.b(a,e,"ed25519"),n}));return function(t,n){return e.apply(this,arguments)}}(),i.prepareAccounts=function(){var t=a()((function*(t){var n=t.privateKey,r=t.name;if(32!==n.length)throw new g.q("Invalid private key.");var o=h.a.publicFromPrivate(n),i=o.toString("hex"),a=yield this.engine.providerManager.pubkeyToAddress(this.networkId,{getPubkey:function(e){return Promise.resolve(o)},verify:function(t,n){return Promise.resolve(e.from([]))}},"hex");return Promise.resolve([{id:"imported--"+v.s+"--"+i,name:r||"",type:m.b.SIMPLE,path:"",coinType:v.s,pub:i,address:a}])}));return function(e){return t.apply(this,arguments)}}(),c()(r)}(n(3096).a)}).call(this,n(22).Buffer)},5684:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return ue}));var r=n(10),o=n.n(r),i=n(15),a=n.n(i),u=n(2),c=n.n(u),s=n(3),d=n.n(s),l=n(6),f=n.n(l),p=n(9),y=n.n(p),h=n(12),v=n.n(h),g=n(5),w=n.n(g),m=n(26),b=n.n(m),x=n(3603),T=n.n(x),O=n(126),A=n.n(O),P=n(117),k=n(47),I=n(20),E=n(19),C=n(950),N=n(56),R=n(465),S=n(3093),D=n(77),j=n(133),B=n(189),F=n(403),_=n(136);function H(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return v()(this,n)}}var U=function(e){y()(n,e);var t=H(n);function n(e){var n;return(n=t.call(this)).rpc=new F.a(e),n}var r=n.prototype;return r.getInfo=function(){var e=d()((function*(){var e=yield this.rpc.call("chain.info",[]),t=parseInt(e.head.number);return{bestBlockNumber:t,isReady:!isNaN(t)&&t>0}}));return function(){return e.apply(this,arguments)}}(),r.getAddresses=function(){var e=d()((function*(e){for(var t=e.reduce((function(e,t){return e.push(["state.get_resource",[t,"0x1::Account::Account",{decode:!0}]]),e.push(["txpool.next_sequence_number",[t]]),e.push(["state.get_resource",[t,"0x1::Account::Balance<0x1::STC::STC>",{decode:!0}]]),e}),[]),n=yield this.rpc.batchCall(t),r=[],i=0,a=n.length;i<a;i+=3){var u=n.slice(i,i+3),c=o()(u,3),s=c[0],d=c[1],l=c[2],f=void 0;if("undefined"!==typeof s&&"undefined"!==typeof d&&"undefined"!==typeof l){var p,y,h=null!==s;f={balance:new b.a(null!=(p=null==l?void 0:l.json.token.value)?p:0),nonce:Math.max(null!=(y=null==s?void 0:s.json.sequence_number)?y:0,null!=d?d:0),existing:h}}r.push(f)}return r}));return function(t){return e.apply(this,arguments)}}(),r.getBalances=function(){var e=d()((function*(e){var t=e.map((function(e){var t;return["state.get_resource",[e.address,"0x1::Account::Balance<"+(null!=(t=e.coin.tokenAddress)?t:"0x1::STC::STC")+">",{decode:!0}]]}));return(yield this.rpc.batchCall(t)).map((function(e){var t,n;"undefined"!==typeof e&&(t=new b.a(null!=(n=null==e?void 0:e.json.token.value)?n:0));return t}))}));return function(t){return e.apply(this,arguments)}}(),r.getTransactionStatuses=function(){var e=d()((function*(e){for(var t=e.reduce((function(e,t){return e.push(["txpool.pending_txn",[t]]),e.push(["chain.get_transaction_info",[t]]),e}),[]),n=yield this.rpc.batchCall(t),r=[],i=0,a=n.length;i<a;i+=2){var u=n.slice(i,i+2),c=o()(u,2),s=c[0],d=c[1],l=void 0;"undefined"!==typeof d&&"undefined"!==typeof s&&(l=null===s&&null===d?_.a.NOT_FOUND:s?_.a.PENDING:"Executed"===(null==d?void 0:d.status)?_.a.CONFIRM_AND_SUCCESS:_.a.CONFIRM_BUT_FAILED),r.push(l)}return r}));return function(t){return e.apply(this,arguments)}}(),r.getFeePricePerUnit=function(){var e=d()((function*(){var e=yield this.rpc.call("txpool.gas_price",[]),t=parseInt(null!=e?e:"1");return{normal:{price:new b.a(t)}}}));return function(){return e.apply(this,arguments)}}(),r.broadcastTransaction=function(){var e=d()((function*(e){return this.rpc.call("txpool.submit_hex_transaction",[e])}));return function(t){return e.apply(this,arguments)}}(),r.estimateGasLimitAndTokensChangedTo=function(){var e=d()((function*(e,t){var n,r,o=j.c.publicKeyToAddress(t),i=yield this.rpc.call("contract.dry_run_raw",[e,t]);return"Executed"===(null==i?void 0:i.status)?(n=new b.a(parseInt(i.gas_used)),r=this.getTokensChangedTo(i,o)):(n=isNaN(parseInt(null==i?void 0:i.gas_used))?new b.a(127845):new b.a(parseInt(null==i?void 0:i.gas_used)),r={}),{feeLimit:n,tokensChangedTo:r}}));return function(t,n){return e.apply(this,arguments)}}(),r.getTokensChangedTo=function(e,t){return e.write_set.reduce((function(e,n){var r,o=n.access_path.match(/^(0x[a-zA-Z0-9]{32})\/[01]\/0x00000000000000000000000000000001::Account::Balance<(.*)>$/i);o&&3===o.length&&t===o[1]&&(e[o[2]]=new b.a(null!=(r=n.value.Resource.json.token.value)?r:0).toFixed());return e}),{})},f()(n)}(B.a),K=n(4215),M=n(4216),L=n(4217),q=n(11),V=n(89);function W(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return v()(this,n)}}var G,z=function(e){y()(n,e);var t=W(n);function n(){return t.apply(this,arguments)}return n.prototype.prepareAccounts=function(){var e=d()((function*(e){var t=e.name,n=e.target,r=e.accountIdPrefix,o=yield this.engine.providerManager.verifyAddress(this.networkId,n),i=o.normalizedAddress;if(!o.isValid||"undefined"===typeof i)throw new E.f;return Promise.resolve([{id:r+"--"+q.s+"--"+n,name:t||"",type:V.b.SIMPLE,path:"",coinType:q.s,pub:"",address:i}])}));return function(t){return e.apply(this,arguments)}}(),f()(n)}(n(3097).a),J=n(2098),$=n(13),Q=n(78),X=n.n(Q),Z=n(36),Y=((G={})[Z.a.stc]="https://api.stcscan.io/v2/transaction/main/byAddress",G[Z.a.tstc]="https://api.stcscan.io/v2/transaction/barnard/byAddress",G);function ee(){return(ee=d()((function*(e,t){var n=Y[e];if("undefined"===typeof n)return Promise.resolve([]);var r=n+"/"+t;try{return(yield X.a.get(r)).data.contents}catch(o){return I.a.common.error(o),Promise.resolve([])}}))).apply(this,arguments)}function te(e){var t={to:"",tokenAddress:"",amountValue:""};try{var n,r=j.c.decodeTransactionPayload(e),i=r.ScriptFunction,a=i.func,u=a.address,c=a.module,s=a.functionName,d=i.args;if("0x00000000000000000000000000000001"===u||"TransferScripts"===c)if("peer_to_peer_v2"===s)n=o()(d,2)[1];else if("peer_to_peer"===s){n=o()(d,3)[2]}if(n){t.amountValue=new b.a(new j.a.BcsDeserializer(Object($.arrayify)(n)).deserializeU128().toString()).toFixed();var l=r,f=o()(l.ScriptFunction.ty_args,1)[0].Struct,p=f.name,y=f.module,h=f.address;t.tokenAddress=h+"::"+y+"::"+p;var v=o()(d,1);t.to=v[0]}}catch(g){I.a.common.error(g)}return t}function ne(e,t,n){return j.c.bcsEncode(j.e.tx.encodeScriptFunction("0x00000000000000000000000000000001::TransferScripts::peer_to_peer_v2",j.e.tx.encodeStructTypeTags([t.tokenIdOnNetwork]),j.e.tx.encodeScriptFunctionArgs([{type_tag:"Address"},{type_tag:"U128"}],[e,"0x"+new b.a(n).shiftedBy(t.decimals).toString(16)])))}var re=["gasLimit"];function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ae(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return v()(this,n)}}var ue=function(e){y()(n,e);var t=ae(n);function n(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).settings=J.default,e.keyringMap={hd:M.a,hw:K.a,imported:L.a,watching:z,external:z},e.createClientFromURL=A()((function(e){return new U(e)}),{max:1,maxAge:Object(k.b)({minute:3})}),e}var r=n.prototype;return r.decodedTxToLegacy=function(e){var t,n=e.actions[0],r=n.type,o=n.nativeTransfer,i=n.tokenTransfer;if(r===N.a.NATIVE_TRANSFER)t={txType:D.a.NATIVE_TRANSFER,symbol:"UNKNOWN",amount:null==o?void 0:o.amount,value:null==o?void 0:o.amountValue,fromAddress:null==o?void 0:o.from,toAddress:null==o?void 0:o.to,data:"",total:"0"};else if(r===N.a.UNKNOWN){var a;t={txType:D.a.NATIVE_TRANSFER,symbol:"UNKNOWN",fromAddress:e.owner,data:null==(a=e.payload)?void 0:a.data,total:"0"}}else{if(r!==N.a.TOKEN_TRANSFER)throw new E.q("Incorrect decodedTx.");var u;t={txType:D.a.TOKEN_TRANSFER,symbol:null==i?void 0:i.tokenInfo.symbol,amount:null==i?void 0:i.amount,value:null==i?void 0:i.amountValue,fromAddress:null==i?void 0:i.from,toAddress:null==i?void 0:i.to,data:null==(u=e.payload)?void 0:u.data,total:"0"}}return Promise.resolve(t)},r.decodeTx=function(){var e=d()((function*(e,t){var n,r=yield this.engine.getNetwork(this.networkId),i=yield this.getDbAccount(),a=yield this.engine.getNativeTokenInfo(this.networkId),u=e.data,c=null;if(e.to){var s={tokenInfo:a,from:e.from,to:e.to,amount:new b.a(e.value).shiftedBy(-a.decimals).toFixed(),amountValue:e.value,extraInfo:null};c={type:N.a.NATIVE_TRANSFER,nativeTransfer:s}}else if(u){var d=function(e){var t=te(e);if(t.tokenAddress)return{type:"tokenTransfer",payload:t};var n,r="";try{var i=j.c.decodeTransactionPayload(e),a=Object.keys(i);n=i[r=o()(a,1)[0]]}catch(u){I.a.common.error("Failed to decode transaction data.",u,e)}return{type:"other",payload:{name:r,params:n}}}(u);if("tokenTransfer"===d.type){var l,f=d.payload,p=f.tokenAddress,y=f.to,h=f.amountValue,v="nativeTransfer",g=N.a.NATIVE_TRANSFER;if("0x00000000000000000000000000000001::STC::STC"!==p){if("undefined"===typeof(a=yield this.engine.ensureTokenInDB(this.networkId,p)))throw new E.q("Failed to get token info.");v="tokenTransfer",g=N.a.TOKEN_TRANSFER}var w=new b.a(h).shiftedBy(-a.decimals).toFixed();(l={type:g})[v]={tokenInfo:a,from:e.from,to:y,amount:w,amountValue:h,extraInfo:null},c=l}else c={type:N.a.UNKNOWN,direction:N.b.SELF,unknownAction:{extraInfo:{}}}}else c={type:N.a.UNKNOWN,direction:N.b.OTHER,unknownAction:{extraInfo:{}}};var m={txid:"",owner:i.address,signer:i.address,nonce:0,actions:[c],status:N.c.Pending,networkId:this.networkId,accountId:this.accountId,feeInfo:{price:Object(R.d)({value:null!=(n=e.gasPrice)?n:"1",network:r}),limit:e.gasLimit},extraInfo:null,encodedTx:e,payload:{data:e.data}};return Promise.resolve(m)}));return function(t,n){return e.apply(this,arguments)}}(),r.buildEncodedTxFromTransfer=function(){var e=d()((function*(e){var t=e.from,n=e.to,r=e.amount,o=e.token;if("undefined"!==typeof o&&o.length>0){var i=yield this.engine.ensureTokenInDB(this.networkId,o);if("undefined"===typeof i)throw new E.q("Failed to get token info.");return Promise.resolve({from:t,to:"",value:"",data:ne(n,i,r)})}var a=yield this.getNetwork();return Promise.resolve({from:t,to:n,value:new b.a(r).shiftedBy(a.decimals).toFixed()})}));return function(t){return e.apply(this,arguments)}}(),r.buildEncodedTxFromApprove=function(){var e=d()((function*(e){throw new E.l}));return function(t){return e.apply(this,arguments)}}(),r.getJsonRPCClient=function(){var e=d()((function*(){var e=yield this.getRpcUrl();return this.createClientFromURL(e)}));return function(){return e.apply(this,arguments)}}(),r.getBalances=function(){var e=d()((function*(e){var t=e.map((function(e){var t=e.address,n=e.tokenAddress;return{address:t,coin:ie({},"string"===typeof n?{tokenAddress:n}:{})}}));return(yield this.getJsonRPCClient()).getBalances(t)}));return function(t){return e.apply(this,arguments)}}(),r.updateEncodedTxTokenApprove=function(e,t){throw new E.l},r.updateEncodedTx=function(){var e=d()((function*(e,t,n){if(n.type===N.d.transfer){var r=yield this.getNetwork();e.value=new b.a(t.amount).shiftedBy(r.decimals).toFixed()}return Promise.resolve(e)}));return function(t,n,r){return e.apply(this,arguments)}}(),r.buildUnsignedTxFromEncodedTx=function(){var e=d()((function*(e){var t=yield this.getDbAccount(),n=yield this.getNetwork(),r=new b.a(e.value),o=e.nonce,i=new b.a(null!=o?o:"NaN"),a=i.isNaN()?yield this.getNextNonce(n.id,t):i.toNumber(),u=yield this.engine.providerManager.buildUnsignedTx(this.networkId,ie({inputs:[{address:t.address,value:r,publicKey:t.pub}],outputs:e.to?[{address:e.to,value:r}]:[],nonce:a,feePricePerUnit:new b.a(e.gasPrice||"1"),payload:ie({},e.data?{data:e.data}:{})},"undefined"!==typeof e.gasLimit?{feeLimit:new b.a(e.gasLimit)}:{}));return I.a.sendTx.info("buildUnsignedTxFromEncodedTx >>>> buildUnsignedTx",u),ie(ie({},u),{},{encodedTx:e})}));return function(t){return e.apply(this,arguments)}}(),r.fetchFeeInfo=function(){var e=d()((function*(e){var t,n=ie(ie({},e),{},{gasPrice:"1"}),r=n.gasLimit,i=a()(n,re),u=yield Promise.all([this.getNetwork(),this.engine.getGasPrice(this.networkId),this.buildUnsignedTxFromEncodedTx(i)]),c=o()(u,3),s=c[0],d=c[1],l=c[2],f=b.a.max(null!=(t=l.feeLimit)?t:"0",null!=r?r:"0").toFixed();return"0"===f&&(e.data||(f="105547")),{nativeSymbol:s.symbol,nativeDecimals:s.decimals,feeSymbol:s.feeSymbol,feeDecimals:s.feeDecimals,limit:f,prices:d,defaultPresetIndex:"0",extraInfo:ie({},Object.keys(l.tokensChangedTo||{}).length?{tokensChangedTo:l.tokensChangedTo}:{})}}));return function(t){return e.apply(this,arguments)}}(),r.attachFeeInfoToEncodedTx=function(){var e=d()((function*(e){var t=e.feeInfoValue,n=t.price,r=t.limit;if("undefined"!==typeof n&&"string"!==typeof n)throw new E.q("Invalid gas price.");if("string"!==typeof r)throw new E.q("Invalid fee limit");var o=yield this.getNetwork(),i=ie(ie({},e.encodedTx),{},{gasPrice:Object(R.c)({value:n||"0.000000001",network:o}),gasLimit:r});return Promise.resolve(i)}));return function(t){return e.apply(this,arguments)}}(),r.getExportedCredential=function(){var e=d()((function*(e){var t=yield this.getDbAccount();if(t.id.startsWith("hd-")||t.id.startsWith("imported")){var n=this.keyring,r=Object.values(yield n.getPrivateKeys(e)),i=o()(r,1)[0];return"0x"+Object(P.a)(e,i).toString("hex")}throw new E.q("Only credential of HD or imported accounts can be exported")}));return function(t){return e.apply(this,arguments)}}(),r.fetchOnChainHistory=function(){var e=d()((function*(e){var t=this,n=e.localHistory,r=void 0===n?[]:n;if(e.tokenIdOnNetwork)return Promise.resolve([]);var o=yield this.getDbAccount(),i=(yield this.engine.getNetwork(this.networkId)).decimals,a=(yield function(e,t){return ee.apply(this,arguments)}(this.networkId,o.address)).map(function(){var e=d()((function*(e){var n=r.find((function(t){return t.decodedTx.txid===e.transaction_hash}));if(n&&n.decodedTx.isFinal)return Promise.resolve(null);try{var a=function(e){try{var t=te(e.user_transaction.raw_txn.payload),n=t.to,r=t.tokenAddress,o=t.amountValue;return{from:e.user_transaction.raw_txn.sender,to:n,tokenAddress:r,amountValue:o,feeValue:new b.a(e.user_transaction.raw_txn.gas_unit_price).times(e.gas_used).toFixed()}}catch(i){return I.a.common.error(i),null}}(e);if(a){var u,c=a.from,s=a.to,d=a.tokenAddress,l=a.amountValue,f=a.feeValue,p={from:c,to:"",value:"",data:e.user_transaction.raw_txn.payload},y={type:N.a.UNKNOWN};if(l&&d){var h,v=N.b.IN;c===o.address&&(v=s===o.address?N.b.SELF:N.b.OUT);var g=N.a.NATIVE_TRANSFER,w=yield t.engine.getNativeTokenInfo(t.networkId),m="nativeTransfer";if("0x00000000000000000000000000000001::STC::STC"===d)p.to=s,p.value=l;else if(g=N.a.TOKEN_TRANSFER,m="tokenTransfer","undefined"===typeof(w=yield t.engine.ensureTokenInDB(t.networkId,d)))throw new E.q("Failed to get token info.");(h={type:g,direction:v})[m]={tokenInfo:w,from:c,to:s,amount:new b.a(l).shiftedBy(-w.decimals).toFixed(),amountValue:l,extraInfo:null},y=h}var x={txid:e.transaction_hash,owner:o.address,signer:c,nonce:0,actions:[y],status:"Executed"===e.status?N.c.Confirmed:N.c.Pending,networkId:t.networkId,accountId:t.accountId,encodedTx:p,extraInfo:null,totalFeeInNative:new b.a(f).shiftedBy(-i).toFixed()};return x.updatedAt=e.timestamp,x.createdAt=null!=(u=null==n?void 0:n.decodedTx.createdAt)?u:x.updatedAt,x.isFinal=x.status===N.c.Confirmed,yield t.buildHistoryTx({decodedTx:x,historyTxToMerge:n})}}catch(T){I.a.common.error(T)}return Promise.resolve(null)}));return function(t){return e.apply(this,arguments)}}());return(yield Promise.all(a)).filter(Boolean)}));return function(t){return e.apply(this,arguments)}}(),r.proxyJsonRPCCall=function(){var e=d()((function*(e){var t=yield this.getJsonRPCClient();try{return yield t.rpc.call(e.method,e.params)}catch(n){throw Object(C.c)(n)}}));return function(t){return e.apply(this,arguments)}}(),r.fetchTokenInfos=function(){var e=d()((function*(e){var t=yield this.getJsonRPCClient();try{return(yield t.rpc.batchCall(e.map((function(e){var t=e.split("::");return["state.get_resource",[o()(t,1)[0],"0x1::Token::TokenInfo<"+e+">",{decode:!0}]]})))).map((function(t,n){var r=t.json.scaling_factor;try{var i=e[n].split("::"),a=o()(i,3)[2];return{name:a,symbol:a,decimals:T.a.log10(r).toDP(0).toNumber()}}catch(u){return void I.a.common.error(u)}}))}catch(n){throw Object(C.c)(n)}}));return function(t){return e.apply(this,arguments)}}(),r.validateTokenAddress=function(){var e=d()((function*(e){var t=e.split("::"),n=o()(t,3),r=n[0],i=n[1],a=n[2];if(i&&a)try{return(yield this.validateAddress(r))+"::"+i+"::"+a}catch(u){}throw new E.i}));return function(t){return e.apply(this,arguments)}}(),f()(n)}(S.a)}}]);