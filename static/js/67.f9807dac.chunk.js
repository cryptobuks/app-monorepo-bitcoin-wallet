(this.webpackJsonp=this.webpackJsonp||[]).push([[67],{3071:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(3),o=r.n(n),i=r(6),a=r.n(i),c=r(9),u=r.n(c),s=r(12),d=r.n(s),f=r(5),l=r.n(f);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l()(e);if(t){var o=l()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d()(this,r)}}var y=function(e){u()(r,e);var t=p(r);function r(e){var r;return(r=t.call(this,e.options)).vault=e,r}return r.prototype.addressFromBase=function(){var e=o()((function*(e){return this.vault.addressFromBase(e)}));return function(t){return e.apply(this,arguments)}}(),a()(r)}(r(1147).a);!function(e){u()(r,e);var t=p(r);function r(){return t.apply(this,arguments)}a()(r)}(y)},3077:function(e,t,r){"use strict";r.d(t,"a",(function(){return T}));var n=r(10),o=r.n(n),i=r(2),a=r.n(i),c=r(3),u=r.n(c),s=r(6),d=r.n(s),f=r(9),l=r.n(f),p=r(12),y=r.n(p),h=r(5),v=r.n(h),g=r(20),w=r(19);function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var o=v()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y()(this,r)}}var T=function(e){l()(r,e);var t=b(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.signTransaction=function(){var e=u()((function*(e,t){var r=t.password;if("undefined"===typeof r)throw new w.q("Software signing requires a password.");var n=yield this.getSigners(r,e.inputs.map((function(e){return e.address})));return g.a.engine.info("signTransaction",this.networkId,e),x(x({},yield this.engine.providerManager.signTransaction(this.networkId,e,n)),{},{encodedTx:e.encodedTx})}));return function(t,r){return e.apply(this,arguments)}}(),n.signMessage=function(){var e=u()((function*(e,t){var r=this,n=t.password;if("undefined"===typeof n)throw new w.q("Software signing requires a password.");var i=yield this.getDbAccount(),a=Object.values(yield this.getSigners(n,[i.address])),c=o()(a,1)[0];return g.a.engine.info("signMessage",this.networkId,e),Promise.all(e.map((function(e){return r.engine.providerManager.signMessage(r.networkId,e,c)})))}));return function(t,r){return e.apply(this,arguments)}}(),n.getAddress=function(){throw new Error("Method not implemented.")},d()(r)}(r(3071).a)},3093:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return j}));var n=r(2),o=r.n(n),i=r(146),a=r.n(i),c=r(3),u=r.n(c),s=r(6),d=r.n(s),f=r(9),l=r.n(f),p=r(12),y=r.n(p),h=r(5),v=r.n(h),g=r(26),w=r.n(g),m=r(11),x=r(20),b=r(14),T=r(53),O=r(19),A=r(184),P=r(658),k=r(56),E=r(1147);function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){o()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function D(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var o=v()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y()(this,r)}}if(b.a.isExtensionUi)throw new Error("engine/VaultBase is not allowed imported from ui");var j=function(t){l()(n,t);var r=D(n);function n(){return r.apply(this,arguments)}var o=n.prototype;return o.init=function(){var e=u()((function*(e){yield this.initProvider(),yield this.initKeyring(e)}));return function(t){return e.apply(this,arguments)}}(),o.initKeyring=function(){var e=u()((function*(e){this.keyring=yield e.keyringCreator(this)}));return function(t){return e.apply(this,arguments)}}(),o.signTransaction=function(){var e=u()((function*(e,t){return this.keyring.signTransaction(e,t)}));return function(t,r){return e.apply(this,arguments)}}(),o.signAndSendTransaction=function(){var e=u()((function*(e,t,r){var n=yield this.signTransaction(e,t);return r?C(C({},n),{},{encodedTx:e.encodedTx}):this.broadcastTransaction(C(C({},n),{},{encodedTx:e.encodedTx}))}));return function(t,r,n){return e.apply(this,arguments)}}(),o.broadcastTransaction=function(){var e=u()((function*(e,t){x.a.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var r=yield this.engine.providerManager.broadcastTransaction(this.networkId,e.rawTx,t);return x.a.engine.info("broadcastTransaction END:",{txid:r,rawTx:e.rawTx}),C(C({},e),{},{txid:r,encodedTx:e.encodedTx})}));return function(t,r){return e.apply(this,arguments)}}(),o.buildEncodedTxFromBatchTransfer=function(){var e=u()((function*(e,t,r){throw new O.l}));return function(t,r,n){return e.apply(this,arguments)}}(),o.buildEncodedTxsFromSetApproveForAll=function(){var e=u()((function*(e,t){throw new O.l}));return function(t,r){return e.apply(this,arguments)}}(),o.activateAccount=function(){var e=u()((function*(){throw new O.l}));return function(){return e.apply(this,arguments)}}(),o.activateToken=function(){var e=u()((function*(e,t){throw new O.l}));return function(t,r){return e.apply(this,arguments)}}(),o.getTokenAllowance=function(){var e=u()((function*(e,t){throw new O.l}));return function(t,r){return e.apply(this,arguments)}}(),o.batchTokensAllowance=function(){var e=u()((function*(e,t){throw new O.l}));return function(t,r){return e.apply(this,arguments)}}(),o.getOutputAccount=function(){var e=u()((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address}}));return function(){return e.apply(this,arguments)}}(),o.getAccountBalance=function(){var e=u()((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,n=yield this.getDbAccount(),o=n.address;return this.getBalances((t?[{address:o}]:[]).concat(e.map((function(e){return{address:o,tokenAddress:e}}))),r)}));return function(t){return e.apply(this,arguments)}}(),o.updatePendingTxs=function(){var e=u()((function*(e){throw new O.l}));return function(t){return e.apply(this,arguments)}}(),o.getAccountNonce=function(){var e=u()((function*(){return Promise.resolve(null)}));return function(){return e.apply(this,arguments)}}(),o.fixActionDirection=function(){var e=u()((function*(e){var t,r,n,o,i=e.action,a=e.accountAddress;(i.direction=k.b.OTHER,i.type===k.a.NATIVE_TRANSFER)&&(i.direction=yield this.buildTxActionDirection({from:(null==(t=i.nativeTransfer)?void 0:t.from)||"",to:(null==(r=i.nativeTransfer)?void 0:r.to)||"",address:a}));i.type===k.a.TOKEN_TRANSFER&&(i.direction=yield this.buildTxActionDirection({from:(null==(n=i.tokenTransfer)?void 0:n.from)||"",to:(null==(o=i.tokenTransfer)?void 0:o.to)||"",address:a}));return i}));return function(t){return e.apply(this,arguments)}}(),o.fixDecodedTx=function(){var e=u()((function*(e){var t,r;e.createdAt=null!=(t=e.createdAt)?t:Date.now();var n=null==(r=e.encodedTx)?void 0:r.nonce;e.nonce=a()(n)?e.nonce:new w.a(n).toNumber();for(var o=e.owner,i=0;i<e.actions.length;i+=1){var c=e.actions[i];yield this.fixActionDirection({action:c,accountAddress:o})}if(e.outputActions)for(var u=0;u<e.outputActions.length;u+=1){var s=e.outputActions[u];yield this.fixActionDirection({action:s,accountAddress:o})}return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),o.fixHistoryTx=function(){var e=u()((function*(e){return e.decodedTx=yield this.fixDecodedTx(e.decodedTx),b.a.isDev&&b.a.isDesktop&&Object.assign(e,{_tmpCreatedAtText:new Date(e.decodedTx.createdAt||0).toLocaleString(),_tmpUpdatedAtText:new Date(e.decodedTx.updatedAt||0).toLocaleString(),_tmpStatus:e.decodedTx.status,_tmpIsFinal:e.decodedTx.isFinal}),Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),o.buildHistoryTx=function(){var e=u()((function*(e){var t=e.historyTxToMerge,r=(e.encodedTx,e.decodedTx),n=e.signedTx,o=e.isSigner,i=e.isLocalCreated,a=(null==n?void 0:n.txid)||(null==r?void 0:r.txid)||"";if(!a)throw new Error("buildHistoryTx txid not found");var c=yield this.getAccountAddress();r.txid=a||r.txid,r.owner=c,o&&(r.signer=c),null!=n&&n.txKey&&(r.extraInfo?r.extraInfo.txKey=n.txKey:r.extraInfo={txKey:n.txKey});var u=C(C({id:this.networkId+"_"+a+"_"+this.accountId,isLocalCreated:Boolean(i)},t),{},{decodedTx:r});return u=yield this.fixHistoryTx(u),Promise.resolve(u)}));return function(t){return e.apply(this,arguments)}}(),o.checkIsScamHistoryTx=function(){var e=u()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),o.fetchOnChainHistory=function(){var e=u()((function*(e){throw new O.l}));return function(t){return e.apply(this,arguments)}}(),o.fixAddressCase=function(e){return Promise.resolve(e)},o.buildTxActionDirection=function(){var e=u()((function*(e){var t=e.from,r=e.to,n=e.address;return t=yield this.fixAddressCase(t||""),r=yield this.fixAddressCase(r),n=yield this.fixAddressCase(n),t===r&&t===n?k.b.SELF:t&&t===n?k.b.OUT:r&&r===n?k.b.IN:k.b.OTHER}));return function(t){return e.apply(this,arguments)}}(),o.getNextNonce=function(){var e=u()((function*(e,t){var r,n,o=null!=(r=null==(n=(yield this.engine.providerManager.getAddresses(e,[t.address]))[0])?void 0:n.nonce)?r:0,i=(yield this.engine.getHistory(e,t.id,void 0,!1),yield T.a.history.getMaxPendingNonce({accountId:this.accountId,networkId:e})),c=yield T.a.history.getPendingNonceList({accountId:this.accountId,networkId:e}),u=Math.max(a()(i)?0:i+1,o);if(Number.isNaN(u)&&(u=o),u>o)for(var s=o;s<u;s+=1)if(!c.includes(s)){u=s;break}if(u<o&&(u=o),u-o>=m.y.PENDING_QUEUE_MAX_LENGTH)throw new O.v(m.y.PENDING_QUEUE_MAX_LENGTH);return u}));return function(t,r){return e.apply(this,arguments)}}(),o.validateSendAmount=function(e,t,r){return Promise.resolve(!0)},o.notifyChainChanged=function(e,t){},o.getFetchBalanceAddress=function(e){return Promise.resolve(e.address)},o.getPrivateKeyByCredential=function(t){return Promise.resolve(e.from(t.startsWith("0x")?t.slice(2):t,"hex"))},o.getMinDepositAmount=function(){var e=u()((function*(){return"0"}));return function(){return e.apply(this,arguments)}}(),o.specialCheckEncodedTx=function(){var e=u()((function*(e){return{success:!0}}));return function(t){return e.apply(this,arguments)}}(),d()(n)}(function(e){l()(r,e);var t=D(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.initProvider=function(){var e=u()((function*(){var e=(yield this.getNetwork()).impl;a()(P.a[e])||(this.engineProvider=yield this.engine.providerManager.getProvider(this.networkId))}));return function(){return e.apply(this,arguments)}}(),n.proxyJsonRPCCall=function(){var e=u()((function*(e){throw new O.l}));return function(t){return e.apply(this,arguments)}}(),n.createClientFromURL=function(e){throw new O.l},n.getEthersProvider=function(){var e=u()((function*(){throw new O.l}));return function(){return e.apply(this,arguments)}}(),n.getClientEndpointStatus=function(){var e=u()((function*(e){var t=this.createClientFromURL(e),r=performance.now(),n=(yield t.getInfo()).bestBlockNumber;return{responseTime:Math.floor(performance.now()-r),latestBlock:n}}));return function(t){return e.apply(this,arguments)}}(),n.validateAddress=function(){var e=u()((function*(e){var t=yield this.engineProvider.verifyAddress(e),r=t.normalizedAddress;if(!t.isValid||"undefined"===typeof r)throw new O.f;return Promise.resolve(r)}));return function(t){return e.apply(this,arguments)}}(),n.validateImportedCredential=function(e){return Promise.resolve(this.settings.importedAccountEnabled&&/^(0x)?[0-9a-zA-Z]{64}$/.test(e))},n.validateWatchingCredential=function(){var e=u()((function*(e){return Promise.resolve(this.settings.watchingAccountEnabled&&(yield this.engineProvider.verifyAddress(e)).isValid)}));return function(t){return e.apply(this,arguments)}}(),n.validateTokenAddress=function(){var e=u()((function*(e){var t=yield this.engineProvider.verifyTokenAddress(e),r=t.normalizedAddress;if(!t.isValid||"undefined"===typeof r)throw new O.i;return Promise.resolve(r)}));return function(t){return e.apply(this,arguments)}}(),n.validateCanCreateNextAccount=function(){var e=u()((function*(e,t){return Promise.resolve(!0)}));return function(t,r){return e.apply(this,arguments)}}(),n.checkAccountExistence=function(){var e=u()((function*(e){return Promise.resolve(!0)}));return function(t){return e.apply(this,arguments)}}(),n.getBalances=function(){var e=u()((function*(e,t){return(yield this.engine.providerManager.getClient(this.networkId)).getBalances(e.map((function(e){var t=e.address,r=e.tokenAddress;return{address:t,coin:C({},"string"===typeof r?{tokenAddress:r}:{})}})))}));return function(t,r){return e.apply(this,arguments)}}(),n.getFrozenBalance=function(){var e=u()((function*(e){return 0}));return function(t){return e.apply(this,arguments)}}(),n.getTransactionStatuses=function(e){return this.engine.providerManager.getTransactionStatuses(this.networkId,e)},n.getTransactionFeeInNative=function(e){return Promise.resolve("")},n.isContractAddress=function(){var e=u()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),n.getAccountNameInfoMap=function(){var e=u()((function*(){var e=yield this.getNetwork();return Object(A.a)(e.impl)}));return function(){return e.apply(this,arguments)}}(),n.canAutoCreateNextAccount=function(){var e=u()((function*(e){return Promise.resolve(!1)}));return function(t){return e.apply(this,arguments)}}(),n.filterAccounts=function(){var e=u()((function*(e){var t=e.accounts;e.networkId;return Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),n.shouldChangeAccountWhenNetworkChanged=function(){var e=u()((function*(e){e.previousNetwork,e.newNetwork,e.activeAccountId;return Promise.resolve({shouldReloadAccountList:!1,shouldChangeActiveAccount:!1})}));return function(t){return e.apply(this,arguments)}}(),n.getAccountNameInfosByImportedOrWatchingCredential=function(){var e=u()((function*(e){return Promise.resolve([])}));return function(t){return e.apply(this,arguments)}}(),d()(r)}(E.a))}).call(this,r(22).Buffer)},3094:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return v}));var n=r(3),o=r.n(n),i=r(6),a=r.n(i),c=r(9),u=r.n(c),s=r(12),d=r.n(s),f=r(5),l=r.n(f),p=r(309),y=r(253);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l()(e);if(t){var o=l()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d()(this,r)}}var v=function(t){u()(n,t);var r=h(n);function n(){return r.apply(this,arguments)}var i=n.prototype;return i.getHardwareInfo=function(){var e=o()((function*(){var e,t,r,n=yield this.engine.getHWDeviceByWalletId(this.vault.walletId);return{connectId:null!=(e=null==n?void 0:n.mac)?e:"",deviceId:null!=(t=null==n?void 0:n.deviceId)?t:"",deviceType:null!=(r=null==n?void 0:n.deviceType)?r:""}}));return function(){return e.apply(this,arguments)}}(),i.getWalletPassphraseState=function(){var e=o()((function*(){var e=yield this.engine.getWallet(this.vault.walletId);return{passphraseState:null==e?void 0:e.passphraseState,useEmptyPassphrase:!Object(y.g)(e)}}));return function(){return e.apply(this,arguments)}}(),i.getHardwareSDKInstance=function(){var t=o()((function*(){var t,r,n,o,i;return null!=(i=yield null==(t=e)||null==(r=t.$backgroundApiProxy)||null==(n=r.backgroundApi)||null==(o=n.serviceHardware)||null==o.getSDKInstance?void 0:o.getSDKInstance())?i:p.b}));return function(){return t.apply(this,arguments)}}(),a()(n)}(r(3071).a)}).call(this,r(40))},3095:function(e,t,r){"use strict";r.d(t,"a",(function(){return x}));var n=r(2),o=r.n(n),i=r(3),a=r.n(i),c=r(6),u=r.n(c),s=r(9),d=r.n(s),f=r(12),l=r.n(f),p=r(5),y=r.n(p),h=r(428),v=r(19);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){o()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var o=y()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l()(this,r)}}var x=function(e){d()(r,e);var t=m(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.getPrivateKeys=function(){var e=a()((function*(e,t){var r=(yield this.getDbAccount()).path.split("/"),n=t||[r.pop()],o=r.join("/"),i=(yield this.engine.dbApi.getCredential(this.walletId,e)).seed;if("undefined"===typeof i)throw new v.q("Unable to get credential.");var a=(yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId)).curve;return Object(h.c)(a,i,e,o,n).reduce((function(e,t){var r;return w(w({},e),{},((r={})[t.path]=t.extendedKey.key,r))}),{})}));return function(t,r){return e.apply(this,arguments)}}(),n.getAddress=function(){throw new Error("Method not implemented.")},u()(r)}(r(3077).a)},3096:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(3),o=r.n(n),i=r(6),a=r.n(i),c=r(9),u=r.n(c),s=r(12),d=r.n(s),f=r(5),l=r.n(f),p=r(19);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l()(e);if(t){var o=l()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d()(this,r)}}var h=function(e){u()(r,e);var t=y(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.getPrivateKeys=function(){var e=o()((function*(e,t){if("undefined"!==typeof t)throw new p.l("Getting private keys from extended private key");var r=(yield this.engine.dbApi.getCredential(this.accountId,e)).privateKey;if("undefined"===typeof r)throw new p.q("Unable to get credential.");return{"":r}}));return function(t,r){return e.apply(this,arguments)}}(),n.getAddress=function(){throw new Error("Method not implemented.")},a()(r)}(r(3077).a)},3097:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(3),o=r.n(n),i=r(6),a=r.n(i),c=r(9),u=r.n(c),s=r(12),d=r.n(s),f=r(5),l=r.n(f),p=r(19);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l()(e);if(t){var o=l()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d()(this,r)}}var h=function(e){u()(r,e);var t=y(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.signTransaction=function(){var e=o()((function*(e,t){throw new p.q("signTransaction is not supported for watching accounts")}));return function(t,r){return e.apply(this,arguments)}}(),n.signMessage=function(){var e=o()((function*(e,t){throw new p.q("signMessage is not supported for watching accounts")}));return function(t,r){return e.apply(this,arguments)}}(),n.getAddress=function(){throw new Error("Method not implemented.")},a()(r)}(r(3071).a)},3098:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(42),o=r(70),i=r(20),a=r(14);function c(e,t){return"string"!==typeof t?null:e===n.HardwareErrorCode.DeviceInitializeFailed&&t.includes("ECONNABORTED")?new o.h({message:t}):t.includes("Bridge network error")?new o.e({message:t}):null}function u(e){var t,r=e||{},u=r.code,s=r.error,d=r.message,f=null!=(t=null!=s?s:d)?t:"Unknown error";if(c(u,f))return c(u,f);switch(i.a.hardwareSDK.info("Device Utils Convert Device Error:",u,f),u){case n.HardwareErrorCode.UnknownError:return new o.H(e);case n.HardwareErrorCode.DeviceFwException:return new o.t(e);case n.HardwareErrorCode.DeviceUnexpectedMode:return"string"===typeof f&&-1!==f.indexOf("ui-device_bootloader_mode")?new o.E(e):new o.H(e);case n.HardwareErrorCode.DeviceCheckDeviceIdError:return new o.m(e);case n.HardwareErrorCode.DeviceNotFound:return new o.k(e);case n.HardwareErrorCode.DeviceUnexpectedBootloaderMode:return new o.E(e);case n.HardwareErrorCode.DeviceInterruptedFromOutside:case n.HardwareErrorCode.DeviceInterruptedFromUser:return new o.K(e);case n.HardwareErrorCode.DeviceNotSupportPassphrase:return new o.F(e);case n.HardwareErrorCode.IFrameLoadFail:return new o.v(e);case n.HardwareErrorCode.IframeTimeout:return new o.w(e);case n.HardwareErrorCode.FirmwareUpdateDownloadFailed:return new o.p(e);case n.HardwareErrorCode.FirmwareUpdateManuallyEnterBoot:return new o.s(e);case n.HardwareErrorCode.FirmwareUpdateAutoEnterBootFailure:return new o.q(e);case n.HardwareErrorCode.FirmwareUpdateLimitOneDevice:return new o.r(e);case n.HardwareErrorCode.CallMethodNeedUpgradeFirmware:return new o.t(e);case n.HardwareErrorCode.NewFirmwareUnRelease:return new o.D(e);case n.HardwareErrorCode.NetworkError:return new o.C(e);case n.HardwareErrorCode.BlePermissionError:return new o.A(e);case n.HardwareErrorCode.BleLocationError:return new o.z({message:f});case n.HardwareErrorCode.BleLocationServicesDisabled:return new o.b({message:f});case n.HardwareErrorCode.BleDeviceNotBonded:return new o.j(e);case n.HardwareErrorCode.BleWriteCharacteristicError:return new o.d(e);case n.HardwareErrorCode.BleScanError:return new o.c({message:f});case n.HardwareErrorCode.BleAlreadyConnected:return new o.a(e);case n.HardwareErrorCode.RuntimeError:return-1!==f.indexOf("EIP712 blind sign is disabled")?new o.G(e):-1!==f.indexOf("Unknown message")||-1!==f.indexOf("Failure_UnexpectedMessage")?new o.I(e):new o.H(e);case n.HardwareErrorCode.PinInvalid:return new o.x(e);case n.HardwareErrorCode.DeviceCheckPassphraseStateError:return new o.y(e);case n.HardwareErrorCode.DeviceOpenedPassphrase:return new o.n(e);case n.HardwareErrorCode.DeviceNotOpenedPassphrase:return new o.l(e);case n.HardwareErrorCode.PinCancelled:case n.HardwareErrorCode.ActionCancelled:return new o.J(e);case n.HardwareErrorCode.BridgeNotInstalled:case o.i.NeedOneKeyBridge:return new o.B(e);case n.HardwareErrorCode.BridgeNetworkError:return new o.e(e);case n.HardwareErrorCode.BridgeTimeoutError:return a.a.isDesktop&&(i.a.hardwareSDK.debug("desktop bridge timeout, restart desktop bridge."),window.desktopApi.reloadBridgeProcess()),new o.f(e);case n.HardwareErrorCode.PollingTimeout:return new o.h(e);case n.HardwareErrorCode.PollingStop:return new o.g(e);case n.HardwareErrorCode.BlindSignDisabled:return new o.G(e);default:return new o.H(e)}}},3840:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return v}));var n=r(2),o=r.n(n),i=r(10),a=r.n(i),c=r(3),u=r.n(c),s=r(84),d=r(3604),f=r.n(d),l=r(428);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){o()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(t){var r=Object(l.i)("secp256k1",e.from(t,"hex"));return f.a.address.fromHex("41"+Object(s.keccak256)(r.slice(-64)).slice(-40))}function v(e,t){return g.apply(this,arguments)}function g(){return(g=u()((function*(t,r){var n=t.payload.encodedTx,o=yield r.sign(e.from(n.txID,"hex")),i=a()(o,2),c=i[0],u=i[1];return Promise.resolve({txid:n.txID,rawTx:JSON.stringify(y(y({},n),{},{signature:[e.concat([c,e.from([u])]).toString("hex")]}))})}))).apply(this,arguments)}}).call(this,r(22).Buffer)},4305:function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n=r(2),o=r.n(n),i=r(3),a=r.n(i),c=r(6),u=r.n(c),s=r(9),d=r.n(s),f=r(12),l=r.n(f),p=r(5),y=r.n(p),h=r(3604),v=r.n(h),g=r(3098),w=r(11),m=r(20),x=r(19),b=r(89),T=r(3094);function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){o()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var o=y()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l()(this,r)}}var k="m/44'/"+w.v+"'/0'/0",E=function(e){d()(r,e);var t=P(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.signTransaction=function(){var e=a()((function*(e,t){var r,n=e.payload.encodedTx,o=n.raw_data,i=o.ref_block_bytes,a=o.ref_block_hash,c=o.expiration,u=o.timestamp,s=o.fee_limit;if("TransferContract"===n.raw_data.contract[0].type){var d=n.raw_data.contract[0].parameter.value,f=d.amount,l=d.to_address;r={transferContract:{amount:f,toAddress:v.a.address.fromHex(l)}}}else if("TriggerSmartContract"===n.raw_data.contract[0].type){var p=n.raw_data.contract[0].parameter.value,y=p.contract_address,h=p.call_value,w=p.data;r={triggerSmartContract:{contractAddress:v.a.address.fromHex(y),data:w,callValue:h}}}if("undefined"===typeof r)throw new x.l;var m=yield this.getDbAccount(),b=yield this.getHardwareSDKInstance(),T=yield this.getHardwareInfo(),O=T.connectId,P=T.deviceId,k=yield this.getWalletPassphraseState(),E=yield b.tronSignTransaction(O,P,A({path:m.path,transaction:{refBlockBytes:i,refBlockHash:a,expiration:c,timestamp:u,feeLimit:s,contract:r}},k));if(E.success&&E.payload.signature){var I=E.payload,C=I.signature,D=I.serialized_tx;return Promise.resolve({txid:n.txID,rawTx:JSON.stringify(A(A({},n),{},{raw_data_hex:D||n.raw_data_hex,signature:[C]}))})}throw Object(g.a)(E.payload)}));return function(t,r){return e.apply(this,arguments)}}(),n.signMessage=function(e,t){throw new x.l("Signing tron message is not supported yet.")},n.prepareAccounts=function(){var e=a()((function*(e){var t,r=this,n=e.indexes,o=e.names,i=n.map((function(e){return k+"/"+e})),a=yield this.getHardwareSDKInstance(),c=yield this.getHardwareInfo(),u=c.connectId,s=c.deviceId,d=yield this.getWalletPassphraseState();try{t=yield a.tronGetAddress(u,s,A({bundle:i.map((function(e){return{path:e,showOnOneKey:!1}}))},d))}catch(f){throw m.a.common.error(f),new x.p(f)}if(!t.success)throw m.a.common.error(t.payload),Object(g.a)(t.payload);return t.payload.map((function(e,t){var i=e.address,a=e.path;return{id:r.walletId+"--"+a,name:(o||[])[t]||"TRON #"+(n[t]+1),type:b.b.SIMPLE,path:a,coinType:w.v,pub:"",address:null!=i?i:""}})).filter((function(e){return!!e.address}))}));return function(t){return e.apply(this,arguments)}}(),n.getAddress=function(){var e=a()((function*(e){var t,r=yield this.getHardwareSDKInstance(),n=yield this.getHardwareInfo(),o=n.connectId,i=n.deviceId,a=yield this.getWalletPassphraseState(),c=yield r.tronGetAddress(o,i,A({path:e.path,showOnOneKey:e.showOnOneKey},a));if(c.success&&null!=(t=c.payload)&&t.address)return c.payload.address;throw Object(g.a)(c.payload)}));return function(t){return e.apply(this,arguments)}}(),u()(r)}(T.a)},4306:function(e,t,r){"use strict";r.d(t,"a",(function(){return T}));var n=r(3),o=r.n(n),i=r(6),a=r.n(i),c=r(9),u=r.n(c),s=r(12),d=r.n(s),f=r(5),l=r.n(f),p=r(428),y=r(11),h=r(19),v=r(950),g=r(89),w=r(3095),m=r(3840);function x(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l()(e);if(t){var o=l()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d()(this,r)}}var b="m/44'/"+y.v+"'/0'/0",T=function(e){u()(r,e);var t=x(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.getSigners=function(){var e=o()((function*(e,t){var r,n=yield this.getDbAccount();if(1!==t.length)throw new h.q("TRON signers number should be 1.");if(t[0]!==n.address)throw new h.q("Wrong address required for signing.");var o=(yield this.getPrivateKeys(e))[n.path];if("undefined"===typeof o)throw new h.q("Unable to get signer.");return(r={})[n.address]=new v.b(o,e,"secp256k1"),r}));return function(t,r){return e.apply(this,arguments)}}(),n.prepareAccounts=function(){var e=o()((function*(e){var t=e.password,r=e.indexes,n=e.names,o=(yield this.engine.dbApi.getCredential(this.walletId,t)).seed,i=Object(p.d)("secp256k1",o,t,b,r.map((function(e){return e.toString()})));if(i.length!==r.length)throw new h.q("Unable to get publick key.");var a=[],c=0;for(var u of i){var s=u.path,d=u.extendedKey.key.toString("hex"),f=Object(m.a)(d),l=(n||[])[c]||"TRON #"+(r[c]+1);a.push({id:this.walletId+"--"+s,name:l,type:g.b.SIMPLE,path:s,coinType:y.v,pub:d,address:f}),c+=1}return a}));return function(t){return e.apply(this,arguments)}}(),n.signTransaction=function(){var e=o()((function*(e,t){var r=yield this.getDbAccount(),n=(yield this.getSigners(t.password||"",[r.address]))[r.address];return Object(m.b)(e,n)}));return function(t,r){return e.apply(this,arguments)}}(),a()(r)}(w.a)},4307:function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n=r(10),o=r.n(n),i=r(3),a=r.n(i),c=r(6),u=r.n(c),s=r(9),d=r.n(s),f=r(12),l=r.n(f),p=r(5),y=r.n(p),h=r(514),v=r(11),g=r(19),w=r(950),m=r(89),x=r(3096),b=r(3840);function T(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var o=y()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l()(this,r)}}var O=function(e){d()(r,e);var t=T(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.getSigners=function(){var e=a()((function*(e,t){var r,n=yield this.getDbAccount();if(1!==t.length)throw new g.q("TRON signers number should be 1.");if(t[0]!==n.address)throw new g.q("Wrong address required for signing.");var i=Object.values(yield this.getPrivateKeys(e)),a=o()(i,1)[0];return(r={})[n.address]=new w.b(a,e,"secp256k1"),r}));return function(t,r){return e.apply(this,arguments)}}(),n.signTransaction=function(){var e=a()((function*(e,t){var r=yield this.getDbAccount(),n=(yield this.getSigners(t.password||"",[r.address]))[r.address];return Object(b.b)(e,n)}));return function(t,r){return e.apply(this,arguments)}}(),n.prepareAccounts=function(){var e=a()((function*(e){var t=e.name,r=e.privateKey;if(32!==r.length)throw new g.q("Invalid private key.");var n=h.c.publicFromPrivate(r).toString("hex"),o=Object(b.a)(n);return Promise.resolve([{id:"imported--"+v.v+"--"+n,name:t||"",type:m.b.SIMPLE,path:"",coinType:v.v,pub:n,address:o}])}));return function(t){return e.apply(this,arguments)}}(),u()(r)}(x.a)},4308:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(3),o=r.n(n),i=r(6),a=r.n(i),c=r(9),u=r.n(c),s=r(12),d=r.n(s),f=r(5),l=r.n(f),p=r(11),y=r(89);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l()(e);if(t){var o=l()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d()(this,r)}}var v=function(e){u()(r,e);var t=h(r);function r(){return t.apply(this,arguments)}return r.prototype.prepareAccounts=function(){var e=o()((function*(e){var t=e.name,r=e.target,n=e.accountIdPrefix,o=yield this.vault.validateAddress(r);return Promise.resolve([{id:n+"--"+p.v+"--"+o,name:t||"",type:y.b.SIMPLE,path:"",coinType:p.v,pub:"",address:o}])}));return function(t){return e.apply(this,arguments)}}(),a()(r)}(r(3097).a)},5655:function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"default",(function(){return z}));var n=r(16),o=r.n(n),i=r(2),a=r.n(i),c=r(10),u=r.n(c),s=r(1220),d=r.n(s),f=r(3),l=r.n(f),p=r(6),y=r.n(p),h=r(9),v=r.n(h),g=r(12),w=r.n(g),m=r(5),x=r.n(m),b=r(303),T=r(78),O=r.n(T),A=r(26),P=r.n(A),k=r(126),E=r.n(k),I=r(3604),C=r.n(I),D=r(117),j=r(136),R=r(47),B=r(253),S=r(20),N=r(19),H=r(950),_=r(56),F=r(3093),U=r(324),M=r(4305),K=r(4306),L=r(4307),q=r(4308),W=r(2100);function V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?V(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function J(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=x()(e);if(t){var o=x()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return w()(this,r)}}var z=function(t){v()(n,t);var r=J(n);function n(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.call.apply(r,[this].concat(n))).keyringMap={hd:K.a,hw:M.a,imported:L.a,watching:q.a,external:q.a},e.settings=W.default,e.getTronWeb=E()((function(e){var t=new C.a({fullHost:e});return t.setAddress("T9yD14Nj9j7xAB4dbGeiX9h8unkKHxuWwb"),t}),{promise:!0,max:3,maxAge:Object(R.b)({minute:3})}),e.getApiExplorerCache=E()(function(){var e=l()((function*(e){return O.a.create({baseURL:e})}));return function(t){return e.apply(this,arguments)}}(),{primitive:!0,promise:!0,max:1,maxAge:Object(R.b)({minute:3})}),e.getTokenContact=E()(function(){var t=l()((function*(t){var r,n,o,i,a=yield e.getApiExplorer(),c=yield a.get("api/contract",{params:{contract:t}});if(0===(null==c||null==(r=c.data)||null==(n=r.status)?void 0:n.code)&&(null==c||null==(o=c.data)||null==(i=o.data)?void 0:i.length)>0)return c.data.data[0]}));return function(e){return t.apply(this,arguments)}}(),{primitive:!0,promise:!0,max:100,maxAge:Object(R.b)({minute:3})}),e.getTokenInfo=E()(function(){var t=l()((function*(t){var r,n=yield e.getTokenContact(t);if(n&&null!=(r=n.tokenInfo)&&r.tokenId){var o=n.tokenInfo;return{name:o.tokenName,symbol:o.tokenAbbr,decimals:o.tokenDecimal,logoURI:o.tokenLogo}}}));return function(e){return t.apply(this,arguments)}}(),{promise:!0,max:100,maxAge:Object(R.b)({minute:3})}),e.getAccountTokens=E()(function(){var t=l()((function*(t){try{var r,n=yield e.getApiExplorer(),o=yield n.get("api/account/tokens",{params:{address:t}});return(null==o||null==(r=o.data)?void 0:r.data)||[]}catch(i){}}));return function(e){return t.apply(this,arguments)}}(),{primitive:!0,promise:!0,max:1,maxAge:Object(R.b)({seconds:30})}),e.getParameters=E()(l()((function*(){var t=yield e.getClient();return Object.fromEntries((yield t.trx.getChainParameters()).map((function(e){return[e.key,e.value]})))})),{promise:!0,maxAge:Object(R.b)({minute:3})}),e}var i=n.prototype;return i.getApiExplorer=function(){var e=l()((function*(){var e=yield this.engine.getNetwork(this.networkId),t=e.blockExplorerURL.name;return t=e.isTestnet?e.blockExplorerURL.name.replace(/shasta/,"shastapi"):e.blockExplorerURL.name.replace(/(tronscan)/,"apilist.$1"),this.getApiExplorerCache(t)}));return function(){return e.apply(this,arguments)}}(),i.getClient=function(){var e=l()((function*(){var e=(yield this.engine.getNetwork(this.networkId)).rpcURL;return this.getTronWeb(e)}));return function(){return e.apply(this,arguments)}}(),i.getConsumableResource=function(){var e=l()((function*(e){var t=yield this.getClient(),r=yield t.trx.getAccountResources(e),n=r.freeNetUsed,o=void 0===n?0:n,i=r.freeNetLimit,a=void 0===i?0:i,c=r.NetUsed,u=void 0===c?0:c,s=r.NetLimit,d=void 0===s?0:s,f=r.EnergyUsed,l=void 0===f?0:f,p=r.EnergyLimit;return{freeBandwidth:a-o,stakedBandwidth:d-u,stakedEnergy:(void 0===p?0:p)-l}}));return function(t){return e.apply(this,arguments)}}(),i.getClientEndpointStatus=function(){var e=l()((function*(e){var t=this.getTronWeb(e),r=performance.now(),n=(yield t.fullNode.request("jsonrpc",{jsonrpc:"2.0",id:1,method:"eth_getBlockByNumber",params:["latest",!1]},"post")).result.number,o=parseInt(n);return{responseTime:Math.floor(performance.now()-r),latestBlock:o}}));return function(t){return e.apply(this,arguments)}}(),i.fetchTokenInfos=function(){var e=l()((function*(e){var t=this;return Promise.all(e.map(function(){var e=l()((function*(e){try{return yield t.getTokenInfo(e)}catch(r){}}));return function(t){return e.apply(this,arguments)}}()))}));return function(t){return e.apply(this,arguments)}}(),i.validateAddress=function(e){return C.a.isAddress(e)?Promise.resolve(C.a.address.fromHex(e)):Promise.reject(new N.f)},i.validateWatchingCredential=function(e){return Promise.resolve(this.settings.watchingAccountEnabled&&C.a.isAddress(e))},i.validateTokenAddress=function(e){return this.validateAddress(e)},i.checkAccountExistence=function(){var e=l()((function*(e){var t=yield this.getClient();return"undefined"!==typeof(yield t.trx.getAccount(e)).address}));return function(t){return e.apply(this,arguments)}}(),i.getBalances=function(){var e=l()((function*(e){var t=this,r=yield this.getClient();return Promise.all(e.map(function(){var e=l()((function*(e){var n=e.address,o=e.tokenAddress;try{if("undefined"===typeof o)return new P.a(yield r.trx.getBalance(n));var i=yield t.getAccountTokens(n);if(i){var a,c=d()(i,{tokenId:o});return new P.a(null!=(a=null==c?void 0:c.balance)?a:0)}return new P.a(0)}catch(u){return new P.a(0)}}));return function(t){return e.apply(this,arguments)}}()))}));return function(t){return e.apply(this,arguments)}}(),i.getTransactionStatuses=function(){var e=l()((function*(e){var t=yield this.getClient();return Promise.all(e.map((function(e){return t.trx.getConfirmedTransaction(e).then((function(e){var t=u()(e.ret,1)[0].contractRet;return"SUCCESS"===(void 0===t?"":t)?j.a.CONFIRM_AND_SUCCESS:j.a.CONFIRM_BUT_FAILED}),(function(r){return"Transaction not found"===r?t.trx.getTransaction(e).then((function(){return j.a.PENDING}),(function(e){return"Transaction not found"===e?j.a.NOT_FOUND:void 0})):void 0}))})))}));return function(t){return e.apply(this,arguments)}}(),i.attachFeeInfoToEncodedTx=function(e){return Promise.resolve(e.encodedTx)},i.decodeTx=function(){var e=l()((function*(e,t){var r=e,n={type:_.a.UNKNOWN};if("TransferContract"===r.raw_data.contract[0].type){var o=r.raw_data.contract[0].parameter.value,i=o.amount,a=o.owner_address,c=o.to_address,s=yield this.engine.getNativeTokenInfo(this.networkId);n={type:_.a.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:s,from:C.a.address.fromHex(a),to:C.a.address.fromHex(c),amount:new P.a(i).shiftedBy(-s.decimals).toFixed(),amountValue:i.toString(),extraInfo:null}}}else if("TriggerSmartContract"===r.raw_data.contract[0].type){var d=r.raw_data.contract[0].parameter.value,f=d.contract_address,l=d.data,p=d.owner_address;try{var y=C.a.address.fromHex(f),h=yield this.fetchTokenInfos([y]);if("undefined"!==typeof u()(h,1)[0]&&"0x"+l.slice(0,8)===U.d.tokenTransfer){var v=b.b.decode(["address","uint256"],"0x"+l.slice(8)),g=u()(v,2),w=g[0],m=g[1],x=new P.a(m._hex),T=yield this.engine.ensureTokenInDB(this.networkId,y);"undefined"!==typeof T&&(n={type:_.a.TOKEN_TRANSFER,tokenTransfer:{tokenInfo:T,from:C.a.address.fromHex(p),to:C.a.address.fromHex(w),amount:x.shiftedBy(-T.decimals).toFixed(),amountValue:x.toFixed(),extraInfo:null}})}}catch(A){}}var O=yield this.getAccountAddress();return{txid:r.txID,owner:O,signer:O,nonce:0,actions:[n],status:_.c.Pending,networkId:this.networkId,accountId:this.accountId,extraInfo:null,encodedTx:r}}));return function(t,r){return e.apply(this,arguments)}}(),i.decodedTxToLegacy=function(e){return Promise.resolve({})},i.buildEncodedTxFromTransfer=function(){var e=l()((function*(e){var t=e.from,r=e.to,n=e.amount,o=e.token,i=yield this.getClient(),a=yield this.engine.ensureTokenInDB(this.networkId,o||"");if(!a)throw new N.q("Token not found: "+(o||"TRX"));if(o){var c=yield i.transactionBuilder.triggerSmartContract(o,"transfer(address,uint256)",{},[{type:"address",value:r},{type:"uint256",value:new P.a(n).shiftedBy(a.decimals).toFixed(0)}],t),u=c.result.result,s=c.transaction;if(!u)throw new N.q("Unable to build token transfer transaction");return s}try{return yield i.transactionBuilder.sendTrx(r,parseInt(new P.a(n).shiftedBy(a.decimals).toFixed()),t)}catch(d){throw"string"===typeof d&&d.endsWith("balance is not sufficient.")?new N.d:"string"===typeof d?new Error(d):d}}));return function(t){return e.apply(this,arguments)}}(),i.buildEncodedTxFromApprove=function(e){throw new N.l},i.updateEncodedTxTokenApprove=function(e,t){throw new N.l},i.updateEncodedTx=function(){var e=l()((function*(e,t,r){var n=e;if("transfer"===r.type&&"TransferContract"===n.raw_data.contract[0].type){var o=yield this.getClient(),i=(yield this.engine.getNativeTokenInfo(this.networkId)).decimals,a=n.raw_data.contract[0].parameter.value,c=a.owner_address,u=a.to_address,s=t.amount;return o.transactionBuilder.sendTrx(C.a.address.fromHex(u),parseInt(new P.a(s).shiftedBy(i).toFixed()),C.a.address.fromHex(c))}return Promise.resolve(n)}));return function(t,r,n){return e.apply(this,arguments)}}(),i.buildUnsignedTxFromEncodedTx=function(e){return Promise.resolve({inputs:[],outputs:[],payload:{encodedTx:e},encodedTx:e})},i.fetchFeeInfo=function(){var e=l()((function*(e){var t=0,r=yield this.getNetwork(),n=e,o=yield this.getParameters(),i=yield this.getConsumableResource(yield this.getAccountAddress()),a=i.freeBandwidth,c=i.stakedBandwidth,u=i.stakedEnergy,s=n.raw_data_hex.length/2+65+64+5;if(t+=(s>a&&s>c?s:0)*o.getTransactionFee,"TransferContract"===n.raw_data.contract[0].type){var d=n.raw_data.contract[0].parameter.value.to_address;(yield this.checkAccountExistence(C.a.address.fromHex(d)))||(t=o.getCreateNewAccountFeeInSystemContract,t+=o.getCreateAccountFee>c?o.getCreateAccountFee:0)}else if("TriggerSmartContract"===n.raw_data.contract[0].type){var f=n.raw_data.contract[0].parameter.value,l=f.contract_address,p=f.data,y=f.call_value,h=f.owner_address,v=yield this.getClient(),g=yield v.fullNode.request("jsonrpc",{jsonrpc:"2.0",id:1,method:"eth_estimateGas",params:[{from:h,to:l,gas:"0x01",gasPrice:"0x01",value:Object(B.i)(new P.a(null!=y?y:0)),data:p}]},"post");if(g.error&&g.error.message)throw new Error(g.error.message);var w=parseInt(g.result);w>u&&(t+=w*o.getEnergyFee)}return{nativeSymbol:r.symbol,nativeDecimals:r.decimals,feeSymbol:r.feeSymbol,feeDecimals:r.feeDecimals,limit:"0",prices:["0"],defaultPresetIndex:"0",tx:null,baseFeeValue:new P.a(t.toString()).shiftedBy(-r.feeDecimals).toFixed()}}));return function(t){return e.apply(this,arguments)}}(),i.broadcastTransaction=function(){var t=l()((function*(t){S.a.engine.info("broadcastTransaction START:",{rawTx:t.rawTx});var r=yield this.getClient(),n=yield r.trx.sendRawTransaction(JSON.parse(t.rawTx));if("undefined"!==typeof n.code)throw new N.q(n.code+" "+e.from(n.message||"","hex").toString());return S.a.engine.info("broadcastTransaction END:",{txid:t.txid,rawTx:t.rawTx}),t}));return function(e){return t.apply(this,arguments)}}(),i.getExportedCredential=function(){var e=l()((function*(e){var t=yield this.getDbAccount();if(t.id.startsWith("hd-")||t.id.startsWith("imported")){var r=this.keyring,n=Object.values(yield r.getPrivateKeys(e)),o=u()(n,1)[0];return Object(D.a)(e,o).toString("hex")}throw new N.q("Only credential of HD or imported accounts can be exported")}));return function(t){return e.apply(this,arguments)}}(),i.fetchOnChainHistory=function(){var e=l()((function*(e){var t=this,r=e.localHistory,n=void 0===r?[]:r,i=e.tokenIdOnNetwork,a=[],c=[],s=yield this.getClient(),d=yield this.getDbAccount(),f=(yield this.engine.getNativeTokenInfo(this.networkId)).decimals;a=(yield s.fullNode.request("v1/accounts/"+d.address+"/transactions/trc20?only_confirmed=true"+(i?"&&contract_address="+i:""))).data,i||(c=(yield s.fullNode.request("v1/accounts/"+d.address+"/transactions/?only_confirmed=true")).data);var p=a.map(function(){var e=l()((function*(e){var r=n.find((function(t){return t.decodedTx.txid===e.transaction_id}));if(r&&r.decodedTx.isFinal)return Promise.resolve(null);var o=yield t.engine.ensureTokenInDB(t.networkId,e.token_info.address);if(!o)return Promise.resolve(null);var i=yield s.trx.getTransactionInfo(e.transaction_id),a=new P.a(e.value),c={type:_.a.UNKNOWN};"Transfer"===e.type&&(c={type:_.a.TOKEN_TRANSFER,tokenTransfer:{tokenInfo:o,from:e.from,to:e.to,amount:a.shiftedBy(-o.decimals).toFixed(),amountValue:a.toFixed(),extraInfo:null}}),"Approval"===e.type&&(c={type:_.a.TOKEN_APPROVE,tokenApprove:{tokenInfo:o,owner:e.from,spender:e.to,isMax:"0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"===Object(B.i)(a),amount:a.shiftedBy(-o.decimals).toFixed(),amountValue:a.toFixed(),extraInfo:null}});try{var u,d,l={txid:e.transaction_id,owner:e.from,signer:e.from,totalFeeInNative:new P.a(null!=(u=i.fee)?u:0).shiftedBy(-f).toFixed(),actions:[c],accountId:t.accountId,networkId:t.networkId,status:_.c.Confirmed,updatedAt:e.block_timestamp,createdAt:null!=(d=null==r?void 0:r.decodedTx.createdAt)?d:e.block_timestamp,isFinal:!0,extraInfo:null,nonce:0};return yield t.buildHistoryTx({decodedTx:l,historyTxToMerge:r})}catch(p){S.a.common.error(p)}return Promise.resolve(null)}));return function(t){return e.apply(this,arguments)}}()),y=c.map(function(){var e=l()((function*(e){var r=n.find((function(t){return t.decodedTx.txid===e.txID}));if(r&&r.decodedTx.isFinal)return Promise.resolve(null);try{var o,i=e.block_timestamp,a=u()(e.ret,1)[0],c=a.contractRet,s=a.fee,d=G(G({},yield t.decodeTx(e)),{},{txid:e.txID,totalFeeInNative:new P.a(s).shiftedBy(-f).toFixed(),status:"SUCCESS"===c?_.c.Confirmed:_.c.Failed,updatedAt:i,createdAt:null!=(o=null==r?void 0:r.decodedTx.createdAt)?o:i,isFinal:!0});return yield t.buildHistoryTx({decodedTx:d,historyTxToMerge:r})}catch(l){S.a.common.error(l)}return Promise.resolve(null)}));return function(t){return e.apply(this,arguments)}}()),h=(yield Promise.all(p)).filter(Boolean),v=(yield Promise.all(y)).filter(Boolean);return[].concat(o()(h),o()(v))}));return function(t){return e.apply(this,arguments)}}(),i.proxyJsonRPCCall=function(){var e=l()((function*(e){try{var t=yield this.getClient();return yield t.fullNode.request("jsonrpc",e,"post")}catch(r){throw Object(H.c)(r)}}));return function(t){return e.apply(this,arguments)}}(),y()(n)}(F.a)}.call(this,r(22).Buffer)}}]);